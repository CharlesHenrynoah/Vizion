"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_action-browser_lib_db_ts";
exports.ids = ["_action-browser_lib_db_ts"];
exports.modules = {

/***/ "(action-browser)/./lib/db.ts":
/*!*******************!*\
  !*** ./lib/db.ts ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   db: () => (/* binding */ db),\n/* harmony export */   supabase: () => (/* binding */ supabase),\n/* harmony export */   supabaseAdmin: () => (/* binding */ supabaseAdmin)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/supabase-js */ \"(action-browser)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n/* harmony import */ var drizzle_orm_postgres_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! drizzle-orm/postgres-js */ \"(action-browser)/./node_modules/drizzle-orm/postgres-js/driver.js\");\n/* harmony import */ var postgres__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! postgres */ \"(action-browser)/./node_modules/postgres/src/index.js\");\n\n\n\n// Read Supabase credentials from environment variables\nconst supabaseUrl = \"https://ffwfdogonvgzudzsdcri.supabase.co\";\nconst supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZmd2Zkb2dvbnZnenVkenNkY3JpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMzMTg1MDQsImV4cCI6MjA1ODg5NDUwNH0.dfUnoBwD56sgNINPI-tLAuaMJ7PuGPuQanAJ_YrwOGI\";\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_KEY;\n// Basic check to ensure environment variables are set\nif (!supabaseUrl) {\n    throw new Error(\"Supabase URL not found. Make sure NEXT_PUBLIC_SUPABASE_URL is set in your .env file.\");\n}\nif (!supabaseAnonKey) {\n    throw new Error(\"Supabase Anon Key not found. Make sure NEXT_PUBLIC_SUPABASE_ANON_KEY is set in your .env file.\");\n}\n// Create and export the Supabase client instance with anonymous key (for client-side)\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__.createClient)(supabaseUrl, supabaseAnonKey);\n// Create a Supabase client with service role key for server-side operations that need elevated privileges\nconst supabaseAdmin = supabaseServiceKey ? (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__.createClient)(supabaseUrl, supabaseServiceKey) : supabase;\n// Configuration pour Drizzle ORM avec PostgreSQL\nlet db;\n// Fonction pour configurer Drizzle\nfunction setupDrizzle() {\n    const databaseUrl = process.env.DATABASE_URL;\n    if (!databaseUrl) {\n        console.error(\"DATABASE_URL is not defined in environment variables\");\n        throw new Error(\"DATABASE_URL is not defined in environment variables\");\n    }\n    try {\n        // Créer un client PostgreSQL avec des options de connexion robustes\n        const client = (0,postgres__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(databaseUrl, {\n            max: 10,\n            idle_timeout: 20,\n            connect_timeout: 30,\n            prepare: false\n        });\n        // Créer une instance Drizzle\n        return (0,drizzle_orm_postgres_js__WEBPACK_IMPORTED_MODULE_2__.drizzle)(client);\n    } catch (error) {\n        console.error(\"Erreur lors de la configuration de Drizzle:\", error);\n        throw error;\n    }\n}\n// Initialiser Drizzle en environnement serveur uniquement\nif (true) {\n    try {\n        db = setupDrizzle();\n    } catch (error) {\n        console.error(\"Erreur lors de l'initialisation de Drizzle:\", error);\n        // Fournir une instance factice pour éviter les erreurs côté serveur\n        db = {};\n    }\n} else {}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL2xpYi9kYi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBcUQ7QUFDSDtBQUNsQjtBQUVoQyx1REFBdUQ7QUFDdkQsTUFBTUcsY0FBY0MsMENBQW9DO0FBQ3hELE1BQU1HLGtCQUFrQkgsa05BQXlDO0FBQ2pFLE1BQU1LLHFCQUFxQkwsUUFBUUMsR0FBRyxDQUFDSyxvQkFBb0I7QUFFM0Qsc0RBQXNEO0FBQ3RELElBQUksQ0FBQ1AsYUFBYTtJQUNoQixNQUFNLElBQUlRLE1BQU07QUFDbEI7QUFDQSxJQUFJLENBQUNKLGlCQUFpQjtJQUNwQixNQUFNLElBQUlJLE1BQU07QUFDbEI7QUFFQSxzRkFBc0Y7QUFDL0UsTUFBTUMsV0FBV1osbUVBQVlBLENBQUNHLGFBQWFJLGlCQUFpQjtBQUVuRSwwR0FBMEc7QUFDbkcsTUFBTU0sZ0JBQWdCSixxQkFDekJULG1FQUFZQSxDQUFDRyxhQUFhTSxzQkFDMUJHLFNBQVM7QUFFYixpREFBaUQ7QUFDakQsSUFBSUU7QUFFSixtQ0FBbUM7QUFDbkMsU0FBU0M7SUFDUCxNQUFNQyxjQUFjWixRQUFRQyxHQUFHLENBQUNZLFlBQVk7SUFFNUMsSUFBSSxDQUFDRCxhQUFhO1FBQ2hCRSxRQUFRQyxLQUFLLENBQUM7UUFDZCxNQUFNLElBQUlSLE1BQU07SUFDbEI7SUFFQSxJQUFJO1FBQ0Ysb0VBQW9FO1FBQ3BFLE1BQU1TLFNBQVNsQixvREFBUUEsQ0FBQ2MsYUFBYTtZQUNuQ0ssS0FBSztZQUNMQyxjQUFjO1lBQ2RDLGlCQUFpQjtZQUNqQkMsU0FBUztRQUNYO1FBRUEsNkJBQTZCO1FBQzdCLE9BQU92QixnRUFBT0EsQ0FBQ21CO0lBQ2pCLEVBQUUsT0FBT0QsT0FBTztRQUNkRCxRQUFRQyxLQUFLLENBQUMsK0NBQStDQTtRQUM3RCxNQUFNQTtJQUNSO0FBQ0Y7QUFFQSwwREFBMEQ7QUFDMUQsSUFBSSxJQUE2QixFQUFFO0lBQ2pDLElBQUk7UUFDRkwsS0FBS0M7SUFDUCxFQUFFLE9BQU9JLE9BQU87UUFDZEQsUUFBUUMsS0FBSyxDQUFDLCtDQUErQ0E7UUFDN0Qsb0VBQW9FO1FBQ3BFTCxLQUFLLENBQUM7SUFDUjtBQUNGLE9BQU8sRUFHTjtBQUVhIiwic291cmNlcyI6WyIvVXNlcnMvY2hhcmxlcy1oZW5yeW5vYWgvRGVza3RvcC92aXppb24vVml6aW9uL2xpYi9kYi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnO1xuaW1wb3J0IHsgZHJpenpsZSB9IGZyb20gJ2RyaXp6bGUtb3JtL3Bvc3RncmVzLWpzJztcbmltcG9ydCBwb3N0Z3JlcyBmcm9tICdwb3N0Z3Jlcyc7XG5cbi8vIFJlYWQgU3VwYWJhc2UgY3JlZGVudGlhbHMgZnJvbSBlbnZpcm9ubWVudCB2YXJpYWJsZXNcbmNvbnN0IHN1cGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMO1xuY29uc3Qgc3VwYWJhc2VBbm9uS2V5ID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVk7XG5jb25zdCBzdXBhYmFzZVNlcnZpY2VLZXkgPSBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX0tFWTtcblxuLy8gQmFzaWMgY2hlY2sgdG8gZW5zdXJlIGVudmlyb25tZW50IHZhcmlhYmxlcyBhcmUgc2V0XG5pZiAoIXN1cGFiYXNlVXJsKSB7XG4gIHRocm93IG5ldyBFcnJvcihcIlN1cGFiYXNlIFVSTCBub3QgZm91bmQuIE1ha2Ugc3VyZSBORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwgaXMgc2V0IGluIHlvdXIgLmVudiBmaWxlLlwiKTtcbn1cbmlmICghc3VwYWJhc2VBbm9uS2V5KSB7XG4gIHRocm93IG5ldyBFcnJvcihcIlN1cGFiYXNlIEFub24gS2V5IG5vdCBmb3VuZC4gTWFrZSBzdXJlIE5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIGlzIHNldCBpbiB5b3VyIC5lbnYgZmlsZS5cIik7XG59XG5cbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSBTdXBhYmFzZSBjbGllbnQgaW5zdGFuY2Ugd2l0aCBhbm9ueW1vdXMga2V5IChmb3IgY2xpZW50LXNpZGUpXG5leHBvcnQgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlQW5vbktleSk7XG5cbi8vIENyZWF0ZSBhIFN1cGFiYXNlIGNsaWVudCB3aXRoIHNlcnZpY2Ugcm9sZSBrZXkgZm9yIHNlcnZlci1zaWRlIG9wZXJhdGlvbnMgdGhhdCBuZWVkIGVsZXZhdGVkIHByaXZpbGVnZXNcbmV4cG9ydCBjb25zdCBzdXBhYmFzZUFkbWluID0gc3VwYWJhc2VTZXJ2aWNlS2V5IFxuICA/IGNyZWF0ZUNsaWVudChzdXBhYmFzZVVybCwgc3VwYWJhc2VTZXJ2aWNlS2V5KVxuICA6IHN1cGFiYXNlO1xuXG4vLyBDb25maWd1cmF0aW9uIHBvdXIgRHJpenpsZSBPUk0gYXZlYyBQb3N0Z3JlU1FMXG5sZXQgZGI6IFJldHVyblR5cGU8dHlwZW9mIHNldHVwRHJpenpsZT47XG5cbi8vIEZvbmN0aW9uIHBvdXIgY29uZmlndXJlciBEcml6emxlXG5mdW5jdGlvbiBzZXR1cERyaXp6bGUoKSB7XG4gIGNvbnN0IGRhdGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuREFUQUJBU0VfVVJMO1xuICBcbiAgaWYgKCFkYXRhYmFzZVVybCkge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJEQVRBQkFTRV9VUkwgaXMgbm90IGRlZmluZWQgaW4gZW52aXJvbm1lbnQgdmFyaWFibGVzXCIpO1xuICAgIHRocm93IG5ldyBFcnJvcihcIkRBVEFCQVNFX1VSTCBpcyBub3QgZGVmaW5lZCBpbiBlbnZpcm9ubWVudCB2YXJpYWJsZXNcIik7XG4gIH1cbiAgXG4gIHRyeSB7XG4gICAgLy8gQ3LDqWVyIHVuIGNsaWVudCBQb3N0Z3JlU1FMIGF2ZWMgZGVzIG9wdGlvbnMgZGUgY29ubmV4aW9uIHJvYnVzdGVzXG4gICAgY29uc3QgY2xpZW50ID0gcG9zdGdyZXMoZGF0YWJhc2VVcmwsIHtcbiAgICAgIG1heDogMTAsIC8vIG5vbWJyZSBtYXhpbXVtIGRlIGNvbm5leGlvbnMgZGFucyBsZSBwb29sXG4gICAgICBpZGxlX3RpbWVvdXQ6IDIwLCAvLyB0ZW1wcyBkJ2luYWN0aXZpdMOpIGF2YW50IGRlIGZlcm1lciB1bmUgY29ubmV4aW9uIChlbiBzZWNvbmRlcylcbiAgICAgIGNvbm5lY3RfdGltZW91dDogMzAsIC8vIHRlbXBzIG1heGltdW0gcG91ciDDqXRhYmxpciB1bmUgY29ubmV4aW9uIChlbiBzZWNvbmRlcylcbiAgICAgIHByZXBhcmU6IGZhbHNlLCAvLyBkw6lzYWN0aXZlciBsYSBwcsOpcGFyYXRpb24gZGVzIHJlcXXDqnRlcyBwb3VyIHBsdXMgZGUgY29tcGF0aWJpbGl0w6lcbiAgICB9KTtcbiAgICBcbiAgICAvLyBDcsOpZXIgdW5lIGluc3RhbmNlIERyaXp6bGVcbiAgICByZXR1cm4gZHJpenpsZShjbGllbnQpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJldXIgbG9ycyBkZSBsYSBjb25maWd1cmF0aW9uIGRlIERyaXp6bGU6XCIsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG4vLyBJbml0aWFsaXNlciBEcml6emxlIGVuIGVudmlyb25uZW1lbnQgc2VydmV1ciB1bmlxdWVtZW50XG5pZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgdHJ5IHtcbiAgICBkYiA9IHNldHVwRHJpenpsZSgpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJldXIgbG9ycyBkZSBsJ2luaXRpYWxpc2F0aW9uIGRlIERyaXp6bGU6XCIsIGVycm9yKTtcbiAgICAvLyBGb3VybmlyIHVuZSBpbnN0YW5jZSBmYWN0aWNlIHBvdXIgw6l2aXRlciBsZXMgZXJyZXVycyBjw7R0w6kgc2VydmV1clxuICAgIGRiID0ge30gYXMgUmV0dXJuVHlwZTx0eXBlb2Ygc2V0dXBEcml6emxlPjtcbiAgfVxufSBlbHNlIHtcbiAgLy8gRm91cm5pciB1bmUgaW5zdGFuY2UgZmFjdGljZSBwb3VyIGxlIGPDtHTDqSBjbGllbnRcbiAgZGIgPSB7fSBhcyBSZXR1cm5UeXBlPHR5cGVvZiBzZXR1cERyaXp6bGU+O1xufVxuXG5leHBvcnQgeyBkYiB9O1xuIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsImRyaXp6bGUiLCJwb3N0Z3JlcyIsInN1cGFiYXNlVXJsIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsInN1cGFiYXNlQW5vbktleSIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwic3VwYWJhc2VTZXJ2aWNlS2V5IiwiU1VQQUJBU0VfU0VSVklDRV9LRVkiLCJFcnJvciIsInN1cGFiYXNlIiwic3VwYWJhc2VBZG1pbiIsImRiIiwic2V0dXBEcml6emxlIiwiZGF0YWJhc2VVcmwiLCJEQVRBQkFTRV9VUkwiLCJjb25zb2xlIiwiZXJyb3IiLCJjbGllbnQiLCJtYXgiLCJpZGxlX3RpbWVvdXQiLCJjb25uZWN0X3RpbWVvdXQiLCJwcmVwYXJlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./lib/db.ts\n");

/***/ })

};
;