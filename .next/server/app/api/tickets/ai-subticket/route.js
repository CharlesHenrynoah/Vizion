/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/tickets/ai-subticket/route";
exports.ids = ["app/api/tickets/ai-subticket/route"];
exports.modules = {

/***/ "bcrypt":
/*!*************************!*\
  !*** external "bcrypt" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("bcrypt");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("net");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("os");

/***/ }),

/***/ "perf_hooks":
/*!*****************************!*\
  !*** external "perf_hooks" ***!
  \*****************************/
/***/ ((module) => {

"use strict";
module.exports = require("perf_hooks");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

"use strict";
module.exports = require("punycode");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("querystring");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Ftickets%2Fai-subticket%2Froute&page=%2Fapi%2Ftickets%2Fai-subticket%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftickets%2Fai-subticket%2Froute.ts&appDir=%2FUsers%2Fcharles-henrynoah%2FDesktop%2Fvizion%2FVizion%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fcharles-henrynoah%2FDesktop%2Fvizion%2FVizion&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Ftickets%2Fai-subticket%2Froute&page=%2Fapi%2Ftickets%2Fai-subticket%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftickets%2Fai-subticket%2Froute.ts&appDir=%2FUsers%2Fcharles-henrynoah%2FDesktop%2Fvizion%2FVizion%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fcharles-henrynoah%2FDesktop%2Fvizion%2FVizion&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_charles_henrynoah_Desktop_vizion_Vizion_app_api_tickets_ai_subticket_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/tickets/ai-subticket/route.ts */ \"(rsc)/./app/api/tickets/ai-subticket/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/tickets/ai-subticket/route\",\n        pathname: \"/api/tickets/ai-subticket\",\n        filename: \"route\",\n        bundlePath: \"app/api/tickets/ai-subticket/route\"\n    },\n    resolvedPagePath: \"/Users/charles-henrynoah/Desktop/vizion/Vizion/app/api/tickets/ai-subticket/route.ts\",\n    nextConfigOutput,\n    userland: _Users_charles_henrynoah_Desktop_vizion_Vizion_app_api_tickets_ai_subticket_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZ0aWNrZXRzJTJGYWktc3VidGlja2V0JTJGcm91dGUmcGFnZT0lMkZhcGklMkZ0aWNrZXRzJTJGYWktc3VidGlja2V0JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGdGlja2V0cyUyRmFpLXN1YnRpY2tldCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmNoYXJsZXMtaGVucnlub2FoJTJGRGVza3RvcCUyRnZpemlvbiUyRlZpemlvbiUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZjaGFybGVzLWhlbnJ5bm9haCUyRkRlc2t0b3AlMkZ2aXppb24lMkZWaXppb24maXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQStGO0FBQ3ZDO0FBQ3FCO0FBQ29DO0FBQ2pIO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix5R0FBbUI7QUFDM0M7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsc0RBQXNEO0FBQzlEO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzBGOztBQUUxRiIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvY2hhcmxlcy1oZW5yeW5vYWgvRGVza3RvcC92aXppb24vVml6aW9uL2FwcC9hcGkvdGlja2V0cy9haS1zdWJ0aWNrZXQvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3RpY2tldHMvYWktc3VidGlja2V0L3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvdGlja2V0cy9haS1zdWJ0aWNrZXRcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3RpY2tldHMvYWktc3VidGlja2V0L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL2NoYXJsZXMtaGVucnlub2FoL0Rlc2t0b3Avdml6aW9uL1Zpemlvbi9hcHAvYXBpL3RpY2tldHMvYWktc3VidGlja2V0L3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgd29ya0FzeW5jU3RvcmFnZSxcbiAgICAgICAgd29ya1VuaXRBc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Ftickets%2Fai-subticket%2Froute&page=%2Fapi%2Ftickets%2Fai-subticket%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftickets%2Fai-subticket%2Froute.ts&appDir=%2FUsers%2Fcharles-henrynoah%2FDesktop%2Fvizion%2FVizion%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fcharles-henrynoah%2FDesktop%2Fvizion%2FVizion&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-action-entry-loader.js?actions=%5B%5B%22%2FUsers%2Fcharles-henrynoah%2FDesktop%2Fvizion%2FVizion%2Fapp%2Factions%2Fgemini-integration.ts%22%2C%5B%5B%2240ca63b7f481f0a4637d6703757ade11dbc432b33f%22%2C%22generateWithGemini%22%5D%2C%5B%2260348a3d22f5fdc032b6f0c5e9a206f41ba92c7613%22%2C%22generateProjectTicketsFormatted%22%5D%2C%5B%2260e43038304b949708f931d67e30ae56439d80a131%22%2C%22enhanceProjectDescription%22%5D%2C%5B%2260f5a7114ae525e767818b612bb897003e4c41d417%22%2C%22generateProjectTickets%22%5D%2C%5B%22702fa7f27033e51b684cce0d176a6f8525bec0b0d4%22%2C%22generateSubTicketWithAI%22%5D%2C%5B%22709c1ed9de5d27665d21214e67e5e216b62062f6e3%22%2C%22generateFeatureIdeas%22%5D%2C%5B%2270fe2b21fda754924c839b23a029c64c76a56780ef%22%2C%22createProjectTicketsInDB%22%5D%5D%5D%5D&__client_imported__=!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-action-entry-loader.js?actions=%5B%5B%22%2FUsers%2Fcharles-henrynoah%2FDesktop%2Fvizion%2FVizion%2Fapp%2Factions%2Fgemini-integration.ts%22%2C%5B%5B%2240ca63b7f481f0a4637d6703757ade11dbc432b33f%22%2C%22generateWithGemini%22%5D%2C%5B%2260348a3d22f5fdc032b6f0c5e9a206f41ba92c7613%22%2C%22generateProjectTicketsFormatted%22%5D%2C%5B%2260e43038304b949708f931d67e30ae56439d80a131%22%2C%22enhanceProjectDescription%22%5D%2C%5B%2260f5a7114ae525e767818b612bb897003e4c41d417%22%2C%22generateProjectTickets%22%5D%2C%5B%22702fa7f27033e51b684cce0d176a6f8525bec0b0d4%22%2C%22generateSubTicketWithAI%22%5D%2C%5B%22709c1ed9de5d27665d21214e67e5e216b62062f6e3%22%2C%22generateFeatureIdeas%22%5D%2C%5B%2270fe2b21fda754924c839b23a029c64c76a56780ef%22%2C%22createProjectTicketsInDB%22%5D%5D%5D%5D&__client_imported__=! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"40ca63b7f481f0a4637d6703757ade11dbc432b33f\": () => (/* reexport safe */ _Users_charles_henrynoah_Desktop_vizion_Vizion_app_actions_gemini_integration_ts__WEBPACK_IMPORTED_MODULE_0__.generateWithGemini),\n/* harmony export */   \"60348a3d22f5fdc032b6f0c5e9a206f41ba92c7613\": () => (/* reexport safe */ _Users_charles_henrynoah_Desktop_vizion_Vizion_app_actions_gemini_integration_ts__WEBPACK_IMPORTED_MODULE_0__.generateProjectTicketsFormatted),\n/* harmony export */   \"60e43038304b949708f931d67e30ae56439d80a131\": () => (/* reexport safe */ _Users_charles_henrynoah_Desktop_vizion_Vizion_app_actions_gemini_integration_ts__WEBPACK_IMPORTED_MODULE_0__.enhanceProjectDescription),\n/* harmony export */   \"60f5a7114ae525e767818b612bb897003e4c41d417\": () => (/* reexport safe */ _Users_charles_henrynoah_Desktop_vizion_Vizion_app_actions_gemini_integration_ts__WEBPACK_IMPORTED_MODULE_0__.generateProjectTickets),\n/* harmony export */   \"702fa7f27033e51b684cce0d176a6f8525bec0b0d4\": () => (/* reexport safe */ _Users_charles_henrynoah_Desktop_vizion_Vizion_app_actions_gemini_integration_ts__WEBPACK_IMPORTED_MODULE_0__.generateSubTicketWithAI),\n/* harmony export */   \"709c1ed9de5d27665d21214e67e5e216b62062f6e3\": () => (/* reexport safe */ _Users_charles_henrynoah_Desktop_vizion_Vizion_app_actions_gemini_integration_ts__WEBPACK_IMPORTED_MODULE_0__.generateFeatureIdeas),\n/* harmony export */   \"70fe2b21fda754924c839b23a029c64c76a56780ef\": () => (/* reexport safe */ _Users_charles_henrynoah_Desktop_vizion_Vizion_app_actions_gemini_integration_ts__WEBPACK_IMPORTED_MODULE_0__.createProjectTicketsInDB)\n/* harmony export */ });\n/* harmony import */ var _Users_charles_henrynoah_Desktop_vizion_Vizion_app_actions_gemini_integration_ts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./app/actions/gemini-integration.ts */ \"(rsc)/./app/actions/gemini-integration.ts\");\n\n\n\n\n\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWZsaWdodC1hY3Rpb24tZW50cnktbG9hZGVyLmpzP2FjdGlvbnM9JTVCJTVCJTIyJTJGVXNlcnMlMkZjaGFybGVzLWhlbnJ5bm9haCUyRkRlc2t0b3AlMkZ2aXppb24lMkZWaXppb24lMkZhcHAlMkZhY3Rpb25zJTJGZ2VtaW5pLWludGVncmF0aW9uLnRzJTIyJTJDJTVCJTVCJTIyNDBjYTYzYjdmNDgxZjBhNDYzN2Q2NzAzNzU3YWRlMTFkYmM0MzJiMzNmJTIyJTJDJTIyZ2VuZXJhdGVXaXRoR2VtaW5pJTIyJTVEJTJDJTVCJTIyNjAzNDhhM2QyMmY1ZmRjMDMyYjZmMGM1ZTlhMjA2ZjQxYmE5MmM3NjEzJTIyJTJDJTIyZ2VuZXJhdGVQcm9qZWN0VGlja2V0c0Zvcm1hdHRlZCUyMiU1RCUyQyU1QiUyMjYwZTQzMDM4MzA0Yjk0OTcwOGY5MzFkNjdlMzBhZTU2NDM5ZDgwYTEzMSUyMiUyQyUyMmVuaGFuY2VQcm9qZWN0RGVzY3JpcHRpb24lMjIlNUQlMkMlNUIlMjI2MGY1YTcxMTRhZTUyNWU3Njc4MThiNjEyYmI4OTcwMDNlNGM0MWQ0MTclMjIlMkMlMjJnZW5lcmF0ZVByb2plY3RUaWNrZXRzJTIyJTVEJTJDJTVCJTIyNzAyZmE3ZjI3MDMzZTUxYjY4NGNjZTBkMTc2YTZmODUyNWJlYzBiMGQ0JTIyJTJDJTIyZ2VuZXJhdGVTdWJUaWNrZXRXaXRoQUklMjIlNUQlMkMlNUIlMjI3MDljMWVkOWRlNWQyNzY2NWQyMTIxNGU2N2U1ZTIxNmI2MjA2MmY2ZTMlMjIlMkMlMjJnZW5lcmF0ZUZlYXR1cmVJZGVhcyUyMiU1RCUyQyU1QiUyMjcwZmUyYjIxZmRhNzU0OTI0YzgzOWIyM2EwMjljNjRjNzZhNTY3ODBlZiUyMiUyQyUyMmNyZWF0ZVByb2plY3RUaWNrZXRzSW5EQiUyMiU1RCU1RCU1RCU1RCZfX2NsaWVudF9pbXBvcnRlZF9fPSEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQ3FLO0FBQ2E7QUFDTjtBQUNIO0FBQ0M7QUFDSDtBQUNJIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiXG5leHBvcnQgeyBnZW5lcmF0ZVdpdGhHZW1pbmkgYXMgXCI0MGNhNjNiN2Y0ODFmMGE0NjM3ZDY3MDM3NTdhZGUxMWRiYzQzMmIzM2ZcIiB9IGZyb20gXCIvVXNlcnMvY2hhcmxlcy1oZW5yeW5vYWgvRGVza3RvcC92aXppb24vVml6aW9uL2FwcC9hY3Rpb25zL2dlbWluaS1pbnRlZ3JhdGlvbi50c1wiXG5leHBvcnQgeyBnZW5lcmF0ZVByb2plY3RUaWNrZXRzRm9ybWF0dGVkIGFzIFwiNjAzNDhhM2QyMmY1ZmRjMDMyYjZmMGM1ZTlhMjA2ZjQxYmE5MmM3NjEzXCIgfSBmcm9tIFwiL1VzZXJzL2NoYXJsZXMtaGVucnlub2FoL0Rlc2t0b3Avdml6aW9uL1Zpemlvbi9hcHAvYWN0aW9ucy9nZW1pbmktaW50ZWdyYXRpb24udHNcIlxuZXhwb3J0IHsgZW5oYW5jZVByb2plY3REZXNjcmlwdGlvbiBhcyBcIjYwZTQzMDM4MzA0Yjk0OTcwOGY5MzFkNjdlMzBhZTU2NDM5ZDgwYTEzMVwiIH0gZnJvbSBcIi9Vc2Vycy9jaGFybGVzLWhlbnJ5bm9haC9EZXNrdG9wL3Zpemlvbi9WaXppb24vYXBwL2FjdGlvbnMvZ2VtaW5pLWludGVncmF0aW9uLnRzXCJcbmV4cG9ydCB7IGdlbmVyYXRlUHJvamVjdFRpY2tldHMgYXMgXCI2MGY1YTcxMTRhZTUyNWU3Njc4MThiNjEyYmI4OTcwMDNlNGM0MWQ0MTdcIiB9IGZyb20gXCIvVXNlcnMvY2hhcmxlcy1oZW5yeW5vYWgvRGVza3RvcC92aXppb24vVml6aW9uL2FwcC9hY3Rpb25zL2dlbWluaS1pbnRlZ3JhdGlvbi50c1wiXG5leHBvcnQgeyBnZW5lcmF0ZVN1YlRpY2tldFdpdGhBSSBhcyBcIjcwMmZhN2YyNzAzM2U1MWI2ODRjY2UwZDE3NmE2Zjg1MjViZWMwYjBkNFwiIH0gZnJvbSBcIi9Vc2Vycy9jaGFybGVzLWhlbnJ5bm9haC9EZXNrdG9wL3Zpemlvbi9WaXppb24vYXBwL2FjdGlvbnMvZ2VtaW5pLWludGVncmF0aW9uLnRzXCJcbmV4cG9ydCB7IGdlbmVyYXRlRmVhdHVyZUlkZWFzIGFzIFwiNzA5YzFlZDlkZTVkMjc2NjVkMjEyMTRlNjdlNWUyMTZiNjIwNjJmNmUzXCIgfSBmcm9tIFwiL1VzZXJzL2NoYXJsZXMtaGVucnlub2FoL0Rlc2t0b3Avdml6aW9uL1Zpemlvbi9hcHAvYWN0aW9ucy9nZW1pbmktaW50ZWdyYXRpb24udHNcIlxuZXhwb3J0IHsgY3JlYXRlUHJvamVjdFRpY2tldHNJbkRCIGFzIFwiNzBmZTJiMjFmZGE3NTQ5MjRjODM5YjIzYTAyOWM2NGM3NmE1Njc4MGVmXCIgfSBmcm9tIFwiL1VzZXJzL2NoYXJsZXMtaGVucnlub2FoL0Rlc2t0b3Avdml6aW9uL1Zpemlvbi9hcHAvYWN0aW9ucy9nZW1pbmktaW50ZWdyYXRpb24udHNcIlxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-action-entry-loader.js?actions=%5B%5B%22%2FUsers%2Fcharles-henrynoah%2FDesktop%2Fvizion%2FVizion%2Fapp%2Factions%2Fgemini-integration.ts%22%2C%5B%5B%2240ca63b7f481f0a4637d6703757ade11dbc432b33f%22%2C%22generateWithGemini%22%5D%2C%5B%2260348a3d22f5fdc032b6f0c5e9a206f41ba92c7613%22%2C%22generateProjectTicketsFormatted%22%5D%2C%5B%2260e43038304b949708f931d67e30ae56439d80a131%22%2C%22enhanceProjectDescription%22%5D%2C%5B%2260f5a7114ae525e767818b612bb897003e4c41d417%22%2C%22generateProjectTickets%22%5D%2C%5B%22702fa7f27033e51b684cce0d176a6f8525bec0b0d4%22%2C%22generateSubTicketWithAI%22%5D%2C%5B%22709c1ed9de5d27665d21214e67e5e216b62062f6e3%22%2C%22generateFeatureIdeas%22%5D%2C%5B%2270fe2b21fda754924c839b23a029c64c76a56780ef%22%2C%22createProjectTicketsInDB%22%5D%5D%5D%5D&__client_imported__=!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./app/actions/gemini-integration.ts":
/*!*******************************************!*\
  !*** ./app/actions/gemini-integration.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createProjectTicketsInDB: () => (/* binding */ createProjectTicketsInDB),\n/* harmony export */   enhanceProjectDescription: () => (/* binding */ enhanceProjectDescription),\n/* harmony export */   generateFeatureIdeas: () => (/* binding */ generateFeatureIdeas),\n/* harmony export */   generateProjectTickets: () => (/* binding */ generateProjectTickets),\n/* harmony export */   generateProjectTicketsFormatted: () => (/* binding */ generateProjectTicketsFormatted),\n/* harmony export */   generateSubTicketWithAI: () => (/* binding */ generateSubTicketWithAI),\n/* harmony export */   generateWithGemini: () => (/* binding */ generateWithGemini)\n/* harmony export */ });\n/* harmony import */ var private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! private-next-rsc-server-reference */ \"(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-loader/server-reference.js\");\n/* harmony import */ var private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! private-next-rsc-action-encryption */ \"(rsc)/./node_modules/next/dist/server/app-render/encryption.js\");\n/* harmony import */ var private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _google_generative_ai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @google/generative-ai */ \"(rsc)/./node_modules/@google/generative-ai/dist/index.mjs\");\n/* harmony import */ var private_next_rsc_action_validate__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! private-next-rsc-action-validate */ \"(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-validate.js\");\n/* __next_internal_action_entry_do_not_use__ {\"40ca63b7f481f0a4637d6703757ade11dbc432b33f\":\"generateWithGemini\",\"60348a3d22f5fdc032b6f0c5e9a206f41ba92c7613\":\"generateProjectTicketsFormatted\",\"60e43038304b949708f931d67e30ae56439d80a131\":\"enhanceProjectDescription\",\"60f5a7114ae525e767818b612bb897003e4c41d417\":\"generateProjectTickets\",\"702fa7f27033e51b684cce0d176a6f8525bec0b0d4\":\"generateSubTicketWithAI\",\"709c1ed9de5d27665d21214e67e5e216b62062f6e3\":\"generateFeatureIdeas\",\"70fe2b21fda754924c839b23a029c64c76a56780ef\":\"createProjectTicketsInDB\"} */ \n\n\n// Cette fonction doit être exécutée uniquement côté serveur\nasync function /*#__TURBOPACK_DISABLE_EXPORT_MERGING__*/ generateWithGemini(prompt) {\n    try {\n        // Initialiser l'API Gemini avec la clé API\n        const genAI = new _google_generative_ai__WEBPACK_IMPORTED_MODULE_2__.GoogleGenerativeAI(process.env.GOOGLE_AI_API_KEY || \"\");\n        // Accéder au modèle Gemini 2.0 Flash\n        const model = genAI.getGenerativeModel({\n            model: \"gemini-2.0-flash\"\n        });\n        // Générer du contenu\n        const result = await model.generateContent(prompt);\n        const response = await result.response;\n        return response.text();\n    } catch (error) {\n        console.error(\"Erreur lors de la génération avec Gemini:\", error);\n        return \"Une erreur s'est produite lors de la génération de contenu.\";\n    }\n}\n// Fonction pour améliorer la description d'un projet\nasync function /*#__TURBOPACK_DISABLE_EXPORT_MERGING__*/ enhanceProjectDescription(projectName, inspirations) {\n    const prompt = `\n    Create a functional description for a project inspired by: \"${inspirations}\".\n    \n    Instructions:\n    1. Imagine this project as a hybrid that combines the best features from all the inspirations mentioned.\n    2. Describe 3-5 key innovative features that would make this project stand out.\n    3. Focus on functionality, user experience, and technical capabilities.\n    4. Keep the tone professional but engaging.\n    5. The description must be in English.\n    6. Limit your response to exactly 500 characters.\n    7. DO NOT include any prefixes, labels, or formatting - just output the pure description text.\n    8. DO NOT start with the project name or \"AI:\" or any other prefix.\n    9. DO NOT use bullet points or numbered lists.\n    \n    Output only the project description as a continuous paragraph with no additional commentary.\n  `;\n    return generateWithGemini(prompt);\n}\n// Fonction pour générer des idées de fonctionnalités\nasync function /*#__TURBOPACK_DISABLE_EXPORT_MERGING__*/ generateFeatureIdeas(projectName, projectDescription, count = 5) {\n    const prompt = `\n    Generate ${count} feature ideas for a project named \"${projectName}\" \n    with the description:\n    \n    \"${projectDescription}\"\n    \n    For each feature:\n    1. Provide a short, catchy title (3-5 words)\n    2. Write a concise description (15-20 words)\n    3. Focus on practical functionality that users would value\n    4. All content must be in English\n    \n    Format your response as a JSON array:\n    [\n      {\n        \"title\": \"Feature Title 1\",\n        \"description\": \"Concise description of feature 1\"\n      },\n      ...\n    ]\n  `;\n    try {\n        const response = await generateWithGemini(prompt);\n        const features = JSON.parse(response);\n        return features.map((feature)=>`${feature.title}: ${feature.description}`);\n    } catch (error) {\n        console.error(\"Erreur lors du parsing des idées de fonctionnalités:\", error);\n        return [\n            \"Error generating feature ideas.\"\n        ];\n    }\n}\n// Fonction pour générer des tickets de projet\nasync function /*#__TURBOPACK_DISABLE_EXPORT_MERGING__*/ generateProjectTickets(projectName, projectDescription) {\n    const prompt = `\n    Tu es un assistant expert en planification de projets logiciels, spécialisé dans la création de tâches pour des IA IDE qui génèrent du code React. Tu dois décomposer la description de projet fournie en une structure détaillée de tickets et sous-tickets.\n\n    **Projet à planifier :**\n    Nom: \"${projectName}\"\n    Description: \"${projectDescription}\"\n    \n    **Contraintes de Rédaction Essentielles :**\n\n    Format Strict et Obligatoire :\n    - Chaque ticket principal (epic) doit avoir un titre commençant par un emoji suivi de \"EPIC [Num] - [Titre]\"\n    - La description de chaque epic doit commencer par \"Objectif : \" suivi d'un texte explicatif\n    - Les sous-tickets doivent avoir un format \"Ticket [Num Epic].[Num Ticket] ([Type]) : [Titre]\"\n    - Privilégier les descriptions détaillées sous forme de liste à puces (-)\n\n    Types de Fonctionnalités à Couvrir :\n    1. **Core Features** : Fonctionnalités principales spécifiques au projet décrit\n    2. **Authentification** : Système de login/signup, gestion des sessions, profils utilisateurs\n    3. **Abonnements/Paiements** : Plans d'abonnement, intégration de paiement, gestion des factures \n    4. **Features Transversales** : Notifications, préférences utilisateur, thèmes, internationalisation\n\n    Focus Exclusif Frontend React :\n    - Décrire uniquement ce qui se passe dans le navigateur, côté client\n    - Se concentrer sur les composants React, leur état, les interactions utilisateur et la navigation\n    \n    API comme Boîte Noire Externe :\n    - Décrire les API uniquement du point de vue du frontend\n    - Inclure la méthode HTTP, l'URL, les données envoyées/reçues et comment l'interface réagit\n\n    Spécificité React :\n    - Mentionner explicitement les noms des composants React à utiliser\n    \n    Types de Tickets Restreints :\n    - Utiliser uniquement les types suivants : (React), (API Intégration), (React UI), (React Routing), (React State/Context), (Frontend Best Practices), (Auth), (Subscription), (UX/UI)\n    \n    **Structure à produire :**\n    \n    Prépare exactement 7-9 tickets principaux (EPIC), dont :\n    - 4-5 EPICs pour les Core Features du projet\n    - 1-2 EPICs pour l'authentification et profil utilisateur\n    - 1 EPIC pour les abonnements et paiements (si pertinent pour le projet)\n    - 1-2 EPICs pour les fonctionnalités transversales (notifications, préférences, etc.)\n    \n    Chaque EPIC devrait contenir 4-6 sous-tickets.\n    \n    TRÈS IMPORTANT: Tu dois générer AU MINIMUM 10 tickets au total (EPICs + sous-tickets).\n    \n    Pour chaque ticket principal (EPIC) :\n    - Un titre au format \"[Emoji] EPIC [Num] - [Titre]\"\n    - Une description débutant par \"Objectif : \" \n    - Un statut qui DOIT être \"To Do\"\n    - Une priorité (1 à 3, où 1 est la plus élevée)\n    \n    Pour chaque sous-ticket :\n    - Un titre spécifique au format \"Ticket [Num Epic].[Num Ticket] ([Type]) : [Titre]\"\n    - Une description détaillée incluant :\n      * Le composant React à créer/modifier\n      * Les props nécessaires et l'état géré\n      * Les interactions utilisateur\n      * L'appel API exact si pertinent\n      * Comment l'UI réagit\n      * Les éléments UI clés et bibliothèques suggérées\n    - Un statut qui DOIT être \"To Do\"\n    - Une priorité (1 à 3)\n    \n    **Format de sortie (JSON) :**\n    [\n      {\n        \"title\": \"[Emoji] EPIC 1 - [Fonctionnalité principale]\",\n        \"description\": \"Objectif : Description détaillée de cette fonctionnalité majeure...\",\n        \"status\": \"To Do\",\n        \"priority\": 1,\n        \"subTickets\": [\n          {\n            \"title\": \"Ticket 1.1 (React UI) : Développer [composant spécifique]\",\n            \"description\": \"- Crée le composant React \\`ComposantName\\`\\\\n- Utilise useState pour gérer l'état X\\\\n- Implemente les interactions utilisateur suivantes...\\\\n- Appelle l'API \\`GET /api/resource\\`\\\\n- Affiche les données avec une UI responsive\\\\n- Utilise la bibliothèque X pour Y\",\n            \"status\": \"To Do\",\n            \"priority\": 2\n          },\n          {\n            \"title\": \"Ticket 1.2 (API Intégration) : Intégrer [autre aspect]\",\n            \"description\": \"Description technique détaillée...\",\n            \"status\": \"To Do\",\n            \"priority\": 1\n          }\n        ]\n      }\n    ]\n    \n    IMPORTANT :\n    - Tous les tickets et sous-tickets DOIVENT avoir le statut \"To Do\"\n    - Les titres des tickets principaux DOIVENT commencer par un emoji puis \"EPIC [Num] - \"\n    - Les titres des sous-tickets DOIVENT suivre le format \"Ticket [Num Epic].[Num Ticket] ([Type]) : [Titre]\"\n    - Les descriptions DOIVENT être en français et inclure des puces (-)\n    - Les descriptions DOIVENT être suffisamment détaillées pour qu'une IA génératrice de code puisse implémenter la fonctionnalité\n    - N'inclus PAS d'autres informations que le JSON demandé dans ta réponse\n  `;\n    try {\n        const response = await generateWithGemini(prompt);\n        // Nettoyer la réponse de tout texte supplémentaire et garder uniquement le JSON\n        const jsonMatch = response.match(/\\[[\\s\\S]*\\]/);\n        if (!jsonMatch) {\n            console.error(\"Erreur: Impossible de trouver le JSON dans la réponse de Gemini\");\n            return [];\n        }\n        const cleanJson = jsonMatch[0];\n        const tickets = JSON.parse(cleanJson);\n        // S'assurer que tous les tickets sont en statut \"To Do\"\n        let processedTickets = tickets.map((ticket)=>{\n            // Forcer le statut \"To Do\" pour tous les tickets\n            ticket.status = \"To Do\";\n            // Assurer une priorité valide\n            if (!ticket.priority || ticket.priority < 1 || ticket.priority > 3) {\n                ticket.priority = Math.floor(Math.random() * 3) + 1;\n            }\n            // Traiter les sous-tickets\n            if (ticket.subTickets && Array.isArray(ticket.subTickets)) {\n                ticket.subTickets = ticket.subTickets.map((subTicket)=>{\n                    subTicket.status = \"To Do\";\n                    if (!subTicket.priority || subTicket.priority < 1 || subTicket.priority > 3) {\n                        subTicket.priority = Math.floor(Math.random() * 3) + 1;\n                    }\n                    return subTicket;\n                });\n            } else {\n                ticket.subTickets = [];\n            }\n            return ticket;\n        });\n        // Réorganiser les tickets pour que les épics d'authentification et profil utilisateur soient toujours en dernier\n        const authAndProfileEpics = [];\n        const otherEpics = [];\n        processedTickets.forEach((ticket)=>{\n            // Vérifier si le ticket est lié à l'authentification ou au profil utilisateur\n            if (ticket.title.toLowerCase().includes(\"auth\") || ticket.title.toLowerCase().includes(\"authentification\") || ticket.title.toLowerCase().includes(\"login\") || ticket.title.toLowerCase().includes(\"connexion\") || ticket.title.toLowerCase().includes(\"profil\") || ticket.title.toLowerCase().includes(\"profile\") || ticket.title.toLowerCase().includes(\"utilisateur\") || ticket.title.toLowerCase().includes(\"user\") || ticket.title.toLowerCase().includes(\"préférences\") || ticket.title.toLowerCase().includes(\"preferences\") || ticket.description.toLowerCase().includes(\"authentification\") || ticket.description.toLowerCase().includes(\"profil utilisateur\")) {\n                authAndProfileEpics.push(ticket);\n            } else {\n                otherEpics.push(ticket);\n            }\n        });\n        // Combiner les deux listes avec les épics d'authentification et profil en dernier\n        return [\n            ...otherEpics,\n            ...authAndProfileEpics\n        ];\n    } catch (error) {\n        console.error(\"Erreur lors du parsing des tickets de projet:\", error);\n        return [];\n    }\n}\n// Fonction pour générer des tickets de projet avec format strict\nasync function /*#__TURBOPACK_DISABLE_EXPORT_MERGING__*/ generateProjectTicketsFormatted(projectName, projectDescription) {\n    const prompt = `\n    Tu es un assistant expert en planification de projets React, spécialisé dans la création de tickets suivant un format strict. Tu dois décomposer la description de projet fournie en une structure détaillée d'epics et de tickets.\n\n    **Projet à planifier :**\n    Nom: \"${projectName}\"\n    Description: \"${projectDescription}\"\n    \n    **Contraintes de Rédaction Essentielles :**\n\n    Format Strict et Obligatoire :\n    - Utiliser exactement la structure : [Emoji] EPIC [Num] – [Titre] suivi de Objectif : [Description].\n    - Puis, pour chaque ticket : Ticket [Num Epic].[Num Ticket] ([Type]) : [Titre] suivi de descriptions détaillées sous forme de liste à puces (-).\n    - Aucune déviation de ce format (majuscules, tirets, parenthèses, emojis, retours à la ligne).\n\n    Focus Exclusif Frontend React :\n    - Décrire uniquement ce qui se passe dans le navigateur, côté client.\n    - Se concentrer sur les composants React, leur état, les interactions utilisateur (clics, formulaires), l'affichage des données et la navigation (React Router).\n\n    API comme Boîte Noire Externe :\n    - Ne JAMAIS décrire l'implémentation du backend, de la base de données ou de la logique interne de l'API.\n    - Décrire les appels API du point de vue du frontend :\n      * Quelle méthode HTTP et quelle URL (hypothétique mais cohérente, ex: GET /api/users/me/profile) sont appelées ?\n      * Quelles données clés sont envoyées (si POST/PUT) ?\n      * Quelles données clés sont attendues en retour ?\n      * Comment l'interface React réagit à la réponse (mise à jour de l'état, affichage, redirection) ?\n      * Inclure la gestion des états de chargement et d'erreur liés aux appels API.\n\n    Spécificité React :\n    - Mentionner explicitement les noms des composants React à créer ou modifier (ex: UserProfileCard).\n    - Décrire l'utilisation de hooks React si pertinent (useState, useEffect...).\n    - Indiquer si une gestion d'état globale (Context API, Zustand, Redux Toolkit) ou une navigation (React Router) est nécessaire.\n\n    Types de Tickets Restreints :\n    - Utiliser uniquement les types suivants entre parenthèses : (React), (API Intégration), (React UI), (React Routing), (React State/Context), (Frontend Best Practices).\n\n    Langage Clair et Actionnable :\n    - Utiliser des verbes d'action clairs (Créer, Afficher, Gérer, Appeler, Mettre à jour, Configurer...).\n    - Être précis et non ambigu.\n    - Décomposer suffisamment les tâches pour qu'un ticket représente une unité de travail logique.\n\n    Détails UI Pertinents :\n    - Mentionner les éléments d'interface utilisateur importants (boutons, formulaires, listes, graphiques, modales, toasts...).\n    - Suggérer des bibliothèques spécifiques (ex: Recharts pour les graphiques, react-toastify pour les notifications, Axios pour les appels API) si cela aide à la clarté.\n    \n    **Structure à produire :**\n    \n    - Créer 4-5 EPICS principaux\n    - Chaque EPIC doit avoir 4-5 tickets\n    - Chaque EPIC doit avoir un emoji thématique approprié\n    - Les tickets doivent aller des fonctionnalités core aux fonctionnalités plus générales\n    - Les tickets doivent couvrir: inscription, connexion, modification de compte, dashboard, présentation du projet, etc.\n    \n    **Ton output doit être EXACTEMENT dans ce format:**\n    \n    [Emoji] EPIC 1 – [Titre Epic 1]\n    Objectif : [Description Epic 1]\n    \n    Ticket 1.1 ([Type]) : [Titre Ticket 1.1]\n    - [Point détaillé 1]\n    - [Point détaillé 2]\n    - [Point détaillé 3]\n    - [Point détaillé 4]\n    - [Point détaillé 5]\n    \n    Ticket 1.2 ([Type]) : [Titre Ticket 1.2]\n    - [Point détaillé 1]\n    - [Point détaillé 2]\n    - [Point détaillé 3]\n    - [Point détaillé 4]\n    - [Point détaillé 5]\n    \n    [Emoji] EPIC 2 – [Titre Epic 2]\n    ...etc\n    \n    IMPORTANT:\n    - N'inclus RIEN d'autre dans ta réponse que le format demandé\n    - N'inclus PAS d'introduction ou de conclusion\n    - N'utilise PAS de numérotation (1., 2., etc.) mais uniquement des tirets (-)\n    - Respecte STRICTEMENT le format demandé sans aucune déviation\n    - Les descriptions doivent être en français\n  `;\n    try {\n        const response = await generateWithGemini(prompt);\n        return response;\n    } catch (error) {\n        console.error(\"Erreur lors de la génération des tickets formatés:\", error);\n        return \"Erreur lors de la génération des tickets formatés. Veuillez réessayer.\";\n    }\n}\n// Fonction pour créer les tickets dans la base de données\nasync function /*#__TURBOPACK_DISABLE_EXPORT_MERGING__*/ createProjectTicketsInDB(projectId, generatedTickets, userId) {\n    try {\n        // Importer supabaseAdmin directement\n        const { supabaseAdmin } = await Promise.all(/*! import() */[__webpack_require__.e(\"vendor-chunks/@supabase\"), __webpack_require__.e(\"vendor-chunks/tr46\"), __webpack_require__.e(\"vendor-chunks/whatwg-url\"), __webpack_require__.e(\"vendor-chunks/webidl-conversions\"), __webpack_require__.e(\"vendor-chunks/drizzle-orm\"), __webpack_require__.e(\"vendor-chunks/postgres\"), __webpack_require__.e(\"_rsc_lib_db_ts\")]).then(__webpack_require__.bind(__webpack_require__, /*! @/lib/db */ \"(rsc)/./lib/db.ts\"));\n        // Récupérer les statuts de tickets\n        const { data: statuses, error: statusError } = await supabaseAdmin.from('ticket_statuses').select('id, name');\n        if (statusError) {\n            console.error('Erreur lors de la récupération des statuts:', statusError);\n            return false;\n        }\n        // Vérifier si les statuts existent, sinon les créer\n        let statusMap = {};\n        if (!statuses || statuses.length === 0) {\n            console.log('Aucun statut trouvé, création des statuts par défaut...');\n            // Créer les statuts par défaut\n            const defaultStatuses = [\n                {\n                    name: 'To Do',\n                    color: '#4287f5',\n                    position: 0\n                },\n                {\n                    name: 'In Progress',\n                    color: '#f5a142',\n                    position: 1\n                },\n                {\n                    name: 'Done',\n                    color: '#42f545',\n                    position: 2\n                }\n            ];\n            for (const status of defaultStatuses){\n                const { data, error } = await supabaseAdmin.from('ticket_statuses').insert(status).select();\n                if (error) {\n                    console.error('Erreur lors de la création du statut:', error);\n                    return false;\n                }\n                if (data && data[0]) {\n                    statusMap[status.name] = data[0].id;\n                }\n            }\n        } else {\n            // Créer une map des status pour les retrouver facilement\n            for (const status of statuses){\n                statusMap[status.name] = status.id;\n            }\n        }\n        // Pour chaque ticket principal (epic)\n        for (const ticket of generatedTickets){\n            // Déterminer le statut\n            const statusId = statusMap[ticket.status] || statusMap['To Do'];\n            // Créer le ticket principal\n            const { data: epicData, error: epicError } = await supabaseAdmin.from('tickets').insert({\n                title: ticket.title,\n                description: ticket.description,\n                project_id: projectId,\n                status_id: statusId,\n                assigned_to: null,\n                created_by: userId,\n                priority: ticket.priority,\n                position: 0\n            }).select();\n            if (epicError) {\n                console.error('Erreur lors de la création du ticket principal:', epicError);\n                continue;\n            }\n            // Si le ticket principal a été créé et qu'il a des sous-tickets\n            if (epicData && epicData[0] && ticket.subTickets && ticket.subTickets.length > 0) {\n                const epicId = epicData[0].id;\n                // Pour chaque sous-ticket\n                for(let i = 0; i < ticket.subTickets.length; i++){\n                    const subTicket = ticket.subTickets[i];\n                    // Déterminer le statut du sous-ticket\n                    const subTicketStatusId = statusMap[subTicket.status] || statusMap['To Do'];\n                    // Créer le sous-ticket\n                    const { error: subTicketError } = await supabaseAdmin.from('tickets').insert({\n                        title: subTicket.title,\n                        description: subTicket.description,\n                        project_id: projectId,\n                        status_id: subTicketStatusId,\n                        assigned_to: null,\n                        created_by: userId,\n                        priority: subTicket.priority,\n                        position: i,\n                        parent_ticket_id: epicId,\n                        is_sub_ticket: true\n                    });\n                    if (subTicketError) {\n                        console.error('Erreur lors de la création du sous-ticket:', subTicketError);\n                    }\n                }\n            }\n        }\n        return true;\n    } catch (error) {\n        console.error(\"Erreur lors de la création des tickets dans la base de données:\", error);\n        return false;\n    }\n}\n// Fonction pour générer un sous-ticket avec IA\nasync function /*#__TURBOPACK_DISABLE_EXPORT_MERGING__*/ generateSubTicketWithAI(epicTitle, epicDescription, subTicketDescription) {\n    console.log(\"Génération de sous-ticket avec paramètres:\", {\n        epicTitle,\n        epicDescription: epicDescription ? `${epicDescription.substring(0, 30)}...` : \"(vide)\",\n        subTicketDescription: `${subTicketDescription.substring(0, 30)}...`\n    });\n    // Définir une longueur cible pour les descriptions de tickets\n    const TARGET_DESCRIPTION_LENGTH = 500;\n    // La limite maximale reste à 800 caractères\n    const MAX_DESCRIPTION_LENGTH = 800;\n    const prompt = `\n    Je suis un assistant de gestion de projet et j'ai besoin de générer un sous-ticket technique pertinent \n    pour l'epic suivant: \"${epicTitle}\". \n    ${epicDescription ? `Description de l'epic: \"${epicDescription}\"` : ''}\n    \n    Voici la description du sous-ticket que je veux créer: \"${subTicketDescription}\"\n    \n    Génère un sous-ticket technique approprié au format JSON avec les champs suivants:\n    - title: Le titre doit suivre ce format exact: \"Ticket Num.X (Domaine) Description concise\". \n      Par exemple \"Ticket 1.3 (Frontend) Implémenter la validation de formulaire\"\n    - description: Une description technique et actionnable avec des étapes précises\n    - priority: Un nombre entre 1 (basse) et 3 (haute) pour représenter la priorité du ticket\n    \n    IMPORTANT :\n    - Le titre DOIT respecter exactement le format spécifié, sans crochets et sans deux-points\n    - La description DOIT être technique, précise et actionnable\n    - La description DOIT faire environ ${TARGET_DESCRIPTION_LENGTH} caractères (entre 450 et 550)\n    - La description NE DOIT JAMAIS dépasser ${MAX_DESCRIPTION_LENGTH} caractères\n    - Fournis uniquement le JSON demandé, sans aucun texte supplémentaire\n  `;\n    try {\n        const response = await generateWithGemini(prompt);\n        if (!response || response.trim() === '') {\n            console.error(\"Erreur: Réponse vide de Gemini\");\n            return null;\n        }\n        console.log(\"Réponse brute de Gemini:\", response.substring(0, 100) + \"...\");\n        // Analyser la réponse JSON\n        let jsonStr = response;\n        // Si la réponse contient du texte avant ou après le JSON, tenter de l'extraire\n        const jsonMatch = response.match(/\\{[\\s\\S]*\\}/);\n        if (jsonMatch) {\n            jsonStr = jsonMatch[0];\n            console.log(\"JSON extrait:\", jsonStr.substring(0, 100) + \"...\");\n        }\n        // Tenter de parser le JSON\n        let ticketData;\n        try {\n            ticketData = JSON.parse(jsonStr);\n            console.log(\"Parsing JSON réussi\");\n        } catch (parseError) {\n            console.error(\"Erreur de parsing JSON:\", parseError);\n            // Tentative de correction du JSON\n            try {\n                // Remplacer les guillemets simples par des guillemets doubles\n                const correctedJson = jsonStr.replace(/'/g, '\"');\n                ticketData = JSON.parse(correctedJson);\n                console.log(\"Parsing JSON réussi après correction\");\n            } catch (secondParseError) {\n                console.error(\"Échec de la correction du JSON:\", secondParseError);\n                console.log(\"JSON incorrect:\", jsonStr);\n                // Créer un objet par défaut si le parsing échoue\n                ticketData = {\n                    title: `Ticket X.X (Backend) ${subTicketDescription.substring(0, 50)}...`,\n                    description: `Sous-ticket créé à partir de: ${subTicketDescription.substring(0, 400)}`,\n                    priority: 2\n                };\n                console.log(\"Utilisation d'un objet par défaut\");\n            }\n        }\n        // Vérifier les champs requis\n        if (!ticketData.title) {\n            console.warn(\"Titre manquant dans la réponse, création d'un titre par défaut\");\n            ticketData.title = `Ticket X.X (Backend) ${subTicketDescription.substring(0, 50)}...`;\n        }\n        if (!ticketData.description) {\n            console.warn(\"Description manquante dans la réponse, création d'une description par défaut\");\n            ticketData.description = `Sous-ticket créé à partir de: ${subTicketDescription.substring(0, 400)}`;\n        }\n        // Extraire le numéro d'epic du titre\n        const epicNumberMatch = epicTitle.match(/EPIC\\s+(\\d+)/i);\n        const epicNumber = epicNumberMatch ? epicNumberMatch[1] : \"X\";\n        // Formater correctement le titre\n        ticketData.title = ticketData.title.replace(/\\[\\d*\\]\\.X/i, `${epicNumber}.X`);\n        // S'assurer que le titre a un format correct\n        if (!ticketData.title.match(/Ticket\\s+\\d+\\.\\d+\\s+\\(\\w+\\)/i)) {\n            console.warn(\"Format de titre incorrect, correction\");\n            ticketData.title = `Ticket ${epicNumber}.X (Backend) ${ticketData.title.substring(0, 50)}`;\n        }\n        // Assurer les valeurs par défaut\n        ticketData.status = \"To Do\";\n        if (!ticketData.priority || ticketData.priority < 1 || ticketData.priority > 3) {\n            ticketData.priority = 2;\n        }\n        // Vérifier la longueur de la description\n        if (ticketData.description.length > MAX_DESCRIPTION_LENGTH) {\n            console.log(`Description trop longue (${ticketData.description.length} caractères), troncature à ${MAX_DESCRIPTION_LENGTH}`);\n            ticketData.description = ticketData.description.substring(0, MAX_DESCRIPTION_LENGTH);\n        }\n        // Ajouter une propriété de validation pour éviter les erreurs\n        ticketData.valid = true;\n        console.log(\"Sous-ticket généré avec succès:\", {\n            title: ticketData.title,\n            priority: ticketData.priority,\n            descriptionLength: ticketData.description.length\n        });\n        return ticketData;\n    } catch (error) {\n        console.error(\"Erreur lors de la génération du sous-ticket:\", error);\n        // Créer un sous-ticket par défaut en cas d'erreur générale\n        const fallbackTicket = {\n            title: `Ticket X.X (Backend) ${subTicketDescription.substring(0, 50)}...`,\n            description: `Sous-ticket créé à partir de: ${subTicketDescription.substring(0, 400)}`,\n            priority: 2,\n            status: \"To Do\",\n            valid: true\n        };\n        console.log(\"Utilisation d'un sous-ticket de secours suite à une erreur\");\n        return fallbackTicket;\n    }\n}\n\n(0,private_next_rsc_action_validate__WEBPACK_IMPORTED_MODULE_3__.ensureServerEntryExports)([\n    generateWithGemini,\n    enhanceProjectDescription,\n    generateFeatureIdeas,\n    generateProjectTickets,\n    generateProjectTicketsFormatted,\n    createProjectTicketsInDB,\n    generateSubTicketWithAI\n]);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(generateWithGemini, \"40ca63b7f481f0a4637d6703757ade11dbc432b33f\", null);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(enhanceProjectDescription, \"60e43038304b949708f931d67e30ae56439d80a131\", null);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(generateFeatureIdeas, \"709c1ed9de5d27665d21214e67e5e216b62062f6e3\", null);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(generateProjectTickets, \"60f5a7114ae525e767818b612bb897003e4c41d417\", null);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(generateProjectTicketsFormatted, \"60348a3d22f5fdc032b6f0c5e9a206f41ba92c7613\", null);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(createProjectTicketsInDB, \"70fe2b21fda754924c839b23a029c64c76a56780ef\", null);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(generateSubTicketWithAI, \"702fa7f27033e51b684cce0d176a6f8525bec0b0d4\", null);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYWN0aW9ucy9nZW1pbmktaW50ZWdyYXRpb24udHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFMEQ7QUFFMUQsNERBQTREO0FBQ3JELGVBQWVDLHVDQUFnQixHQUFoQkEsbUJBQW1CQyxNQUFjO0lBQ3JELElBQUk7UUFDRiwyQ0FBMkM7UUFDM0MsTUFBTUMsUUFBUSxJQUFJSCxxRUFBa0JBLENBQUNJLFFBQVFDLEdBQUcsQ0FBQ0MsaUJBQWlCLElBQUk7UUFFdEUscUNBQXFDO1FBQ3JDLE1BQU1DLFFBQVFKLE1BQU1LLGtCQUFrQixDQUFDO1lBQUVELE9BQU87UUFBbUI7UUFFbkUscUJBQXFCO1FBQ3JCLE1BQU1FLFNBQVMsTUFBTUYsTUFBTUcsZUFBZSxDQUFDUjtRQUMzQyxNQUFNUyxXQUFXLE1BQU1GLE9BQU9FLFFBQVE7UUFDdEMsT0FBT0EsU0FBU0MsSUFBSTtJQUN0QixFQUFFLE9BQU9DLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLDZDQUE2Q0E7UUFDM0QsT0FBTztJQUNUO0FBQ0Y7QUFFQSxxREFBcUQ7QUFDOUMsZUFBZUUsdUNBQXVCLEdBQXZCQSwwQkFBMEJDLFdBQW1CLEVBQUVDLFlBQW9CO0lBQ3ZGLE1BQU1mLFNBQVMsQ0FBQztnRUFDOEMsRUFBRWUsYUFBYTs7Ozs7Ozs7Ozs7Ozs7RUFjN0UsQ0FBQztJQUVELE9BQU9oQixtQkFBbUJDO0FBQzVCO0FBRUEscURBQXFEO0FBQzlDLGVBQWVnQix1Q0FBa0IsR0FBbEJBLHFCQUNwQkYsV0FBbUIsRUFDbkJHLGtCQUEwQixFQUMxQkMsUUFBUSxDQUFDO0lBRVQsTUFBTWxCLFNBQVMsQ0FBQzthQUNMLEVBQUVrQixNQUFNLG9DQUFvQyxFQUFFSixZQUFZOzs7S0FHbEUsRUFBRUcsbUJBQW1COzs7Ozs7Ozs7Ozs7Ozs7O0VBZ0J4QixDQUFDO0lBRUQsSUFBSTtRQUNGLE1BQU1SLFdBQVcsTUFBTVYsbUJBQW1CQztRQUMxQyxNQUFNbUIsV0FBV0MsS0FBS0MsS0FB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MkJBQTJCLEVBQUUyQix3QkFBd0I7WUFDM0hHLFdBQVdqRSxXQUFXLEdBQUdpRSxXQUFXakUsV0FBVyxDQUFDNEQsU0FBUyxDQUFDLEdBQUdFO1FBQy9EO1FBRUEsOERBQThEO1FBQzlERyxXQUFXUSxLQUFLLEdBQUc7UUFFbkJ0RixRQUFRaUQsR0FBRyxDQUFDLG1DQUFtQztZQUM3Q3JDLE9BQU9rRSxXQUFXbEUsS0FBSztZQUN2QlUsVUFBVXdELFdBQVd4RCxRQUFRO1lBQzdCaUUsbUJBQW1CVCxXQUFXakUsV0FBVyxDQUFDbUMsTUFBTTtRQUNsRDtRQUVBLE9BQU84QjtJQUNULEVBQUUsT0FBTy9FLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLGdEQUFnREE7UUFFOUQsMkRBQTJEO1FBQzNELE1BQU15RixpQkFBaUI7WUFDckI1RSxPQUFPLENBQUMscUJBQXFCLEVBQUU0RCxxQkFBcUJDLFNBQVMsQ0FBQyxHQUFHLElBQUksR0FBRyxDQUFDO1lBQ3pFNUQsYUFBYSxDQUFDLDhCQUE4QixFQUFFMkQscUJBQXFCQyxTQUFTLENBQUMsR0FBRyxNQUFNO1lBQ3RGbkQsVUFBVTtZQUNWRCxRQUFRO1lBQ1JpRSxPQUFPO1FBQ1Q7UUFFQXRGLFFBQVFpRCxHQUFHLENBQUM7UUFDWixPQUFPdUM7SUFDVDtBQUNGOzs7SUE1bUJzQnJHO0lBbUJBYztJQXNCQUc7SUFzQ0FVO0lBa0xBc0I7SUFnR0FDO0lBeUhBZ0M7O0FBMWRBbEYsMEZBQUFBLENBQUFBO0FBbUJBYywwRkFBQUEsQ0FBQUE7QUFzQkFHLDBGQUFBQSxDQUFBQTtBQXNDQVUsMEZBQUFBLENBQUFBO0FBa0xBc0IsMEZBQUFBLENBQUFBO0FBZ0dBQywwRkFBQUEsQ0FBQUE7QUF5SEFnQywwRkFBQUEsQ0FBQUEiLCJzb3VyY2VzIjpbIi9Vc2Vycy9jaGFybGVzLWhlbnJ5bm9haC9EZXNrdG9wL3Zpemlvbi9WaXppb24vYXBwL2FjdGlvbnMvZ2VtaW5pLWludGVncmF0aW9uLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHNlcnZlclwiXG5cbmltcG9ydCB7IEdvb2dsZUdlbmVyYXRpdmVBSSB9IGZyb20gXCJAZ29vZ2xlL2dlbmVyYXRpdmUtYWlcIlxuXG4vLyBDZXR0ZSBmb25jdGlvbiBkb2l0IMOqdHJlIGV4w6ljdXTDqWUgdW5pcXVlbWVudCBjw7R0w6kgc2VydmV1clxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlV2l0aEdlbWluaShwcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gIHRyeSB7XG4gICAgLy8gSW5pdGlhbGlzZXIgbCdBUEkgR2VtaW5pIGF2ZWMgbGEgY2zDqSBBUElcbiAgICBjb25zdCBnZW5BSSA9IG5ldyBHb29nbGVHZW5lcmF0aXZlQUkocHJvY2Vzcy5lbnYuR09PR0xFX0FJX0FQSV9LRVkgfHwgXCJcIilcblxuICAgIC8vIEFjY8OpZGVyIGF1IG1vZMOobGUgR2VtaW5pIDIuMCBGbGFzaFxuICAgIGNvbnN0IG1vZGVsID0gZ2VuQUkuZ2V0R2VuZXJhdGl2ZU1vZGVsKHsgbW9kZWw6IFwiZ2VtaW5pLTIuMC1mbGFzaFwiIH0pXG5cbiAgICAvLyBHw6luw6lyZXIgZHUgY29udGVudVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1vZGVsLmdlbmVyYXRlQ29udGVudChwcm9tcHQpXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXN1bHQucmVzcG9uc2VcbiAgICByZXR1cm4gcmVzcG9uc2UudGV4dCgpXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycmV1ciBsb3JzIGRlIGxhIGfDqW7DqXJhdGlvbiBhdmVjIEdlbWluaTpcIiwgZXJyb3IpXG4gICAgcmV0dXJuIFwiVW5lIGVycmV1ciBzJ2VzdCBwcm9kdWl0ZSBsb3JzIGRlIGxhIGfDqW7DqXJhdGlvbiBkZSBjb250ZW51LlwiXG4gIH1cbn1cblxuLy8gRm9uY3Rpb24gcG91ciBhbcOpbGlvcmVyIGxhIGRlc2NyaXB0aW9uIGQndW4gcHJvamV0XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW5oYW5jZVByb2plY3REZXNjcmlwdGlvbihwcm9qZWN0TmFtZTogc3RyaW5nLCBpbnNwaXJhdGlvbnM6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gIGNvbnN0IHByb21wdCA9IGBcbiAgICBDcmVhdGUgYSBmdW5jdGlvbmFsIGRlc2NyaXB0aW9uIGZvciBhIHByb2plY3QgaW5zcGlyZWQgYnk6IFwiJHtpbnNwaXJhdGlvbnN9XCIuXG4gICAgXG4gICAgSW5zdHJ1Y3Rpb25zOlxuICAgIDEuIEltYWdpbmUgdGhpcyBwcm9qZWN0IGFzIGEgaHlicmlkIHRoYXQgY29tYmluZXMgdGhlIGJlc3QgZmVhdHVyZXMgZnJvbSBhbGwgdGhlIGluc3BpcmF0aW9ucyBtZW50aW9uZWQuXG4gICAgMi4gRGVzY3JpYmUgMy01IGtleSBpbm5vdmF0aXZlIGZlYXR1cmVzIHRoYXQgd291bGQgbWFrZSB0aGlzIHByb2plY3Qgc3RhbmQgb3V0LlxuICAgIDMuIEZvY3VzIG9uIGZ1bmN0aW9uYWxpdHksIHVzZXIgZXhwZXJpZW5jZSwgYW5kIHRlY2huaWNhbCBjYXBhYmlsaXRpZXMuXG4gICAgNC4gS2VlcCB0aGUgdG9uZSBwcm9mZXNzaW9uYWwgYnV0IGVuZ2FnaW5nLlxuICAgIDUuIFRoZSBkZXNjcmlwdGlvbiBtdXN0IGJlIGluIEVuZ2xpc2guXG4gICAgNi4gTGltaXQgeW91ciByZXNwb25zZSB0byBleGFjdGx5IDUwMCBjaGFyYWN0ZXJzLlxuICAgIDcuIERPIE5PVCBpbmNsdWRlIGFueSBwcmVmaXhlcywgbGFiZWxzLCBvciBmb3JtYXR0aW5nIC0ganVzdCBvdXRwdXQgdGhlIHB1cmUgZGVzY3JpcHRpb24gdGV4dC5cbiAgICA4LiBETyBOT1Qgc3RhcnQgd2l0aCB0aGUgcHJvamVjdCBuYW1lIG9yIFwiQUk6XCIgb3IgYW55IG90aGVyIHByZWZpeC5cbiAgICA5LiBETyBOT1QgdXNlIGJ1bGxldCBwb2ludHMgb3IgbnVtYmVyZWQgbGlzdHMuXG4gICAgXG4gICAgT3V0cHV0IG9ubHkgdGhlIHByb2plY3QgZGVzY3JpcHRpb24gYXMgYSBjb250aW51b3VzIHBhcmFncmFwaCB3aXRoIG5vIGFkZGl0aW9uYWwgY29tbWVudGFyeS5cbiAgYFxuXG4gIHJldHVybiBnZW5lcmF0ZVdpdGhHZW1pbmkocHJvbXB0KVxufVxuXG4vLyBGb25jdGlvbiBwb3VyIGfDqW7DqXJlciBkZXMgaWTDqWVzIGRlIGZvbmN0aW9ubmFsaXTDqXNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZW5lcmF0ZUZlYXR1cmVJZGVhcyhcbiAgcHJvamVjdE5hbWU6IHN0cmluZyxcbiAgcHJvamVjdERlc2NyaXB0aW9uOiBzdHJpbmcsXG4gIGNvdW50ID0gNSxcbik6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgY29uc3QgcHJvbXB0ID0gYFxuICAgIEdlbmVyYXRlICR7Y291bnR9IGZlYXR1cmUgaWRlYXMgZm9yIGEgcHJvamVjdCBuYW1lZCBcIiR7cHJvamVjdE5hbWV9XCIgXG4gICAgd2l0aCB0aGUgZGVzY3JpcHRpb246XG4gICAgXG4gICAgXCIke3Byb2plY3REZXNjcmlwdGlvbn1cIlxuICAgIFxuICAgIEZvciBlYWNoIGZlYXR1cmU6XG4gICAgMS4gUHJvdmlkZSBhIHNob3J0LCBjYXRjaHkgdGl0bGUgKDMtNSB3b3JkcylcbiAgICAyLiBXcml0ZSBhIGNvbmNpc2UgZGVzY3JpcHRpb24gKDE1LTIwIHdvcmRzKVxuICAgIDMuIEZvY3VzIG9uIHByYWN0aWNhbCBmdW5jdGlvbmFsaXR5IHRoYXQgdXNlcnMgd291bGQgdmFsdWVcbiAgICA0LiBBbGwgY29udGVudCBtdXN0IGJlIGluIEVuZ2xpc2hcbiAgICBcbiAgICBGb3JtYXQgeW91ciByZXNwb25zZSBhcyBhIEpTT04gYXJyYXk6XG4gICAgW1xuICAgICAge1xuICAgICAgICBcInRpdGxlXCI6IFwiRmVhdHVyZSBUaXRsZSAxXCIsXG4gICAgICAgIFwiZGVzY3JpcHRpb25cIjogXCJDb25jaXNlIGRlc2NyaXB0aW9uIG9mIGZlYXR1cmUgMVwiXG4gICAgICB9LFxuICAgICAgLi4uXG4gICAgXVxuICBgXG5cbiAgdHJ5IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdlbmVyYXRlV2l0aEdlbWluaShwcm9tcHQpXG4gICAgY29uc3QgZmVhdHVyZXMgPSBKU09OLnBhcnNlKHJlc3BvbnNlKVxuICAgIHJldHVybiBmZWF0dXJlcy5tYXAoKGZlYXR1cmU6IGFueSkgPT4gYCR7ZmVhdHVyZS50aXRsZX06ICR7ZmVhdHVyZS5kZXNjcmlwdGlvbn1gKVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJldXIgbG9ycyBkdSBwYXJzaW5nIGRlcyBpZMOpZXMgZGUgZm9uY3Rpb25uYWxpdMOpczpcIiwgZXJyb3IpXG4gICAgcmV0dXJuIFtcIkVycm9yIGdlbmVyYXRpbmcgZmVhdHVyZSBpZGVhcy5cIl1cbiAgfVxufVxuXG4vLyBGb25jdGlvbiBwb3VyIGfDqW7DqXJlciBkZXMgdGlja2V0cyBkZSBwcm9qZXRcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZW5lcmF0ZVByb2plY3RUaWNrZXRzKFxuICBwcm9qZWN0TmFtZTogc3RyaW5nLFxuICBwcm9qZWN0RGVzY3JpcHRpb246IHN0cmluZ1xuKTogUHJvbWlzZTxhbnlbXT4ge1xuICBjb25zdCBwcm9tcHQgPSBgXG4gICAgVHUgZXMgdW4gYXNzaXN0YW50IGV4cGVydCBlbiBwbGFuaWZpY2F0aW9uIGRlIHByb2pldHMgbG9naWNpZWxzLCBzcMOpY2lhbGlzw6kgZGFucyBsYSBjcsOpYXRpb24gZGUgdMOiY2hlcyBwb3VyIGRlcyBJQSBJREUgcXVpIGfDqW7DqHJlbnQgZHUgY29kZSBSZWFjdC4gVHUgZG9pcyBkw6ljb21wb3NlciBsYSBkZXNjcmlwdGlvbiBkZSBwcm9qZXQgZm91cm5pZSBlbiB1bmUgc3RydWN0dXJlIGTDqXRhaWxsw6llIGRlIHRpY2tldHMgZXQgc291cy10aWNrZXRzLlxuXG4gICAgKipQcm9qZXQgw6AgcGxhbmlmaWVyIDoqKlxuICAgIE5vbTogXCIke3Byb2plY3ROYW1lfVwiXG4gICAgRGVzY3JpcHRpb246IFwiJHtwcm9qZWN0RGVzY3JpcHRpb259XCJcbiAgICBcbiAgICAqKkNvbnRyYWludGVzIGRlIFLDqWRhY3Rpb24gRXNzZW50aWVsbGVzIDoqKlxuXG4gICAgRm9ybWF0IFN0cmljdCBldCBPYmxpZ2F0b2lyZSA6XG4gICAgLSBDaGFxdWUgdGlja2V0IHByaW5jaXBhbCAoZXBpYykgZG9pdCBhdm9pciB1biB0aXRyZSBjb21tZW7Dp2FudCBwYXIgdW4gZW1vamkgc3VpdmkgZGUgXCJFUElDIFtOdW1dIC0gW1RpdHJlXVwiXG4gICAgLSBMYSBkZXNjcmlwdGlvbiBkZSBjaGFxdWUgZXBpYyBkb2l0IGNvbW1lbmNlciBwYXIgXCJPYmplY3RpZiA6IFwiIHN1aXZpIGQndW4gdGV4dGUgZXhwbGljYXRpZlxuICAgIC0gTGVzIHNvdXMtdGlja2V0cyBkb2l2ZW50IGF2b2lyIHVuIGZvcm1hdCBcIlRpY2tldCBbTnVtIEVwaWNdLltOdW0gVGlja2V0XSAoW1R5cGVdKSA6IFtUaXRyZV1cIlxuICAgIC0gUHJpdmlsw6lnaWVyIGxlcyBkZXNjcmlwdGlvbnMgZMOpdGFpbGzDqWVzIHNvdXMgZm9ybWUgZGUgbGlzdGUgw6AgcHVjZXMgKC0pXG5cbiAgICBUeXBlcyBkZSBGb25jdGlvbm5hbGl0w6lzIMOgIENvdXZyaXIgOlxuICAgIDEuICoqQ29yZSBGZWF0dXJlcyoqIDogRm9uY3Rpb25uYWxpdMOpcyBwcmluY2lwYWxlcyBzcMOpY2lmaXF1ZXMgYXUgcHJvamV0IGTDqWNyaXRcbiAgICAyLiAqKkF1dGhlbnRpZmljYXRpb24qKiA6IFN5c3TDqG1lIGRlIGxvZ2luL3NpZ251cCwgZ2VzdGlvbiBkZXMgc2Vzc2lvbnMsIHByb2ZpbHMgdXRpbGlzYXRldXJzXG4gICAgMy4gKipBYm9ubmVtZW50cy9QYWllbWVudHMqKiA6IFBsYW5zIGQnYWJvbm5lbWVudCwgaW50w6lncmF0aW9uIGRlIHBhaWVtZW50LCBnZXN0aW9uIGRlcyBmYWN0dXJlcyBcbiAgICA0LiAqKkZlYXR1cmVzIFRyYW5zdmVyc2FsZXMqKiA6IE5vdGlmaWNhdGlvbnMsIHByw6lmw6lyZW5jZXMgdXRpbGlzYXRldXIsIHRow6htZXMsIGludGVybmF0aW9uYWxpc2F0aW9uXG5cbiAgICBGb2N1cyBFeGNsdXNpZiBGcm9udGVuZCBSZWFjdCA6XG4gICAgLSBEw6ljcmlyZSB1bmlxdWVtZW50IGNlIHF1aSBzZSBwYXNzZSBkYW5zIGxlIG5hdmlnYXRldXIsIGPDtHTDqSBjbGllbnRcbiAgICAtIFNlIGNvbmNlbnRyZXIgc3VyIGxlcyBjb21wb3NhbnRzIFJlYWN0LCBsZXVyIMOpdGF0LCBsZXMgaW50ZXJhY3Rpb25zIHV0aWxpc2F0ZXVyIGV0IGxhIG5hdmlnYXRpb25cbiAgICBcbiAgICBBUEkgY29tbWUgQm/DrnRlIE5vaXJlIEV4dGVybmUgOlxuICAgIC0gRMOpY3JpcmUgbGVzIEFQSSB1bmlxdWVtZW50IGR1IHBvaW50IGRlIHZ1ZSBkdSBmcm9udGVuZFxuICAgIC0gSW5jbHVyZSBsYSBtw6l0aG9kZSBIVFRQLCBsJ1VSTCwgbGVzIGRvbm7DqWVzIGVudm95w6llcy9yZcOndWVzIGV0IGNvbW1lbnQgbCdpbnRlcmZhY2UgcsOpYWdpdFxuXG4gICAgU3DDqWNpZmljaXTDqSBSZWFjdCA6XG4gICAgLSBNZW50aW9ubmVyIGV4cGxpY2l0ZW1lbnQgbGVzIG5vbXMgZGVzIGNvbXBvc2FudHMgUmVhY3Qgw6AgdXRpbGlzZXJcbiAgICBcbiAgICBUeXBlcyBkZSBUaWNrZXRzIFJlc3RyZWludHMgOlxuICAgIC0gVXRpbGlzZXIgdW5pcXVlbWVudCBsZXMgdHlwZXMgc3VpdmFudHMgOiAoUmVhY3QpLCAoQVBJIEludMOpZ3JhdGlvbiksIChSZWFjdCBVSSksIChSZWFjdCBSb3V0aW5nKSwgKFJlYWN0IFN0YXRlL0NvbnRleHQpLCAoRnJvbnRlbmQgQmVzdCBQcmFjdGljZXMpLCAoQXV0aCksIChTdWJzY3JpcHRpb24pLCAoVVgvVUkpXG4gICAgXG4gICAgKipTdHJ1Y3R1cmUgw6AgcHJvZHVpcmUgOioqXG4gICAgXG4gICAgUHLDqXBhcmUgZXhhY3RlbWVudCA3LTkgdGlja2V0cyBwcmluY2lwYXV4IChFUElDKSwgZG9udCA6XG4gICAgLSA0LTUgRVBJQ3MgcG91ciBsZXMgQ29yZSBGZWF0dXJlcyBkdSBwcm9qZXRcbiAgICAtIDEtMiBFUElDcyBwb3VyIGwnYXV0aGVudGlmaWNhdGlvbiBldCBwcm9maWwgdXRpbGlzYXRldXJcbiAgICAtIDEgRVBJQyBwb3VyIGxlcyBhYm9ubmVtZW50cyBldCBwYWllbWVudHMgKHNpIHBlcnRpbmVudCBwb3VyIGxlIHByb2pldClcbiAgICAtIDEtMiBFUElDcyBwb3VyIGxlcyBmb25jdGlvbm5hbGl0w6lzIHRyYW5zdmVyc2FsZXMgKG5vdGlmaWNhdGlvbnMsIHByw6lmw6lyZW5jZXMsIGV0Yy4pXG4gICAgXG4gICAgQ2hhcXVlIEVQSUMgZGV2cmFpdCBjb250ZW5pciA0LTYgc291cy10aWNrZXRzLlxuICAgIFxuICAgIFRSw4hTIElNUE9SVEFOVDogVHUgZG9pcyBnw6luw6lyZXIgQVUgTUlOSU1VTSAxMCB0aWNrZXRzIGF1IHRvdGFsIChFUElDcyArIHNvdXMtdGlja2V0cykuXG4gICAgXG4gICAgUG91ciBjaGFxdWUgdGlja2V0IHByaW5jaXBhbCAoRVBJQykgOlxuICAgIC0gVW4gdGl0cmUgYXUgZm9ybWF0IFwiW0Vtb2ppXSBFUElDIFtOdW1dIC0gW1RpdHJlXVwiXG4gICAgLSBVbmUgZGVzY3JpcHRpb24gZMOpYnV0YW50IHBhciBcIk9iamVjdGlmIDogXCIgXG4gICAgLSBVbiBzdGF0dXQgcXVpIERPSVQgw6p0cmUgXCJUbyBEb1wiXG4gICAgLSBVbmUgcHJpb3JpdMOpICgxIMOgIDMsIG/DuSAxIGVzdCBsYSBwbHVzIMOpbGV2w6llKVxuICAgIFxuICAgIFBvdXIgY2hhcXVlIHNvdXMtdGlja2V0IDpcbiAgICAtIFVuIHRpdHJlIHNww6ljaWZpcXVlIGF1IGZvcm1hdCBcIlRpY2tldCBbTnVtIEVwaWNdLltOdW0gVGlja2V0XSAoW1R5cGVdKSA6IFtUaXRyZV1cIlxuICAgIC0gVW5lIGRlc2NyaXB0aW9uIGTDqXRhaWxsw6llIGluY2x1YW50IDpcbiAgICAgICogTGUgY29tcG9zYW50IFJlYWN0IMOgIGNyw6llci9tb2RpZmllclxuICAgICAgKiBMZXMgcHJvcHMgbsOpY2Vzc2FpcmVzIGV0IGwnw6l0YXQgZ8OpcsOpXG4gICAgICAqIExlcyBpbnRlcmFjdGlvbnMgdXRpbGlzYXRldXJcbiAgICAgICogTCdhcHBlbCBBUEkgZXhhY3Qgc2kgcGVydGluZW50XG4gICAgICAqIENvbW1lbnQgbCdVSSByw6lhZ2l0XG4gICAgICAqIExlcyDDqWzDqW1lbnRzIFVJIGNsw6lzIGV0IGJpYmxpb3Row6hxdWVzIHN1Z2fDqXLDqWVzXG4gICAgLSBVbiBzdGF0dXQgcXVpIERPSVQgw6p0cmUgXCJUbyBEb1wiXG4gICAgLSBVbmUgcHJpb3JpdMOpICgxIMOgIDMpXG4gICAgXG4gICAgKipGb3JtYXQgZGUgc29ydGllIChKU09OKSA6KipcbiAgICBbXG4gICAgICB7XG4gICAgICAgIFwidGl0bGVcIjogXCJbRW1vamldIEVQSUMgMSAtIFtGb25jdGlvbm5hbGl0w6kgcHJpbmNpcGFsZV1cIixcbiAgICAgICAgXCJkZXNjcmlwdGlvblwiOiBcIk9iamVjdGlmIDogRGVzY3JpcHRpb24gZMOpdGFpbGzDqWUgZGUgY2V0dGUgZm9uY3Rpb25uYWxpdMOpIG1hamV1cmUuLi5cIixcbiAgICAgICAgXCJzdGF0dXNcIjogXCJUbyBEb1wiLFxuICAgICAgICBcInByaW9yaXR5XCI6IDEsXG4gICAgICAgIFwic3ViVGlja2V0c1wiOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgXCJ0aXRsZVwiOiBcIlRpY2tldCAxLjEgKFJlYWN0IFVJKSA6IETDqXZlbG9wcGVyIFtjb21wb3NhbnQgc3DDqWNpZmlxdWVdXCIsXG4gICAgICAgICAgICBcImRlc2NyaXB0aW9uXCI6IFwiLSBDcsOpZSBsZSBjb21wb3NhbnQgUmVhY3QgXFxgQ29tcG9zYW50TmFtZVxcYFxcXFxuLSBVdGlsaXNlIHVzZVN0YXRlIHBvdXIgZ8OpcmVyIGwnw6l0YXQgWFxcXFxuLSBJbXBsZW1lbnRlIGxlcyBpbnRlcmFjdGlvbnMgdXRpbGlzYXRldXIgc3VpdmFudGVzLi4uXFxcXG4tIEFwcGVsbGUgbCdBUEkgXFxgR0VUIC9hcGkvcmVzb3VyY2VcXGBcXFxcbi0gQWZmaWNoZSBsZXMgZG9ubsOpZXMgYXZlYyB1bmUgVUkgcmVzcG9uc2l2ZVxcXFxuLSBVdGlsaXNlIGxhIGJpYmxpb3Row6hxdWUgWCBwb3VyIFlcIixcbiAgICAgICAgICAgIFwic3RhdHVzXCI6IFwiVG8gRG9cIixcbiAgICAgICAgICAgIFwicHJpb3JpdHlcIjogMlxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgXCJ0aXRsZVwiOiBcIlRpY2tldCAxLjIgKEFQSSBJbnTDqWdyYXRpb24pIDogSW50w6lncmVyIFthdXRyZSBhc3BlY3RdXCIsXG4gICAgICAgICAgICBcImRlc2NyaXB0aW9uXCI6IFwiRGVzY3JpcHRpb24gdGVjaG5pcXVlIGTDqXRhaWxsw6llLi4uXCIsXG4gICAgICAgICAgICBcInN0YXR1c1wiOiBcIlRvIERvXCIsXG4gICAgICAgICAgICBcInByaW9yaXR5XCI6IDFcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH1cbiAgICBdXG4gICAgXG4gICAgSU1QT1JUQU5UIDpcbiAgICAtIFRvdXMgbGVzIHRpY2tldHMgZXQgc291cy10aWNrZXRzIERPSVZFTlQgYXZvaXIgbGUgc3RhdHV0IFwiVG8gRG9cIlxuICAgIC0gTGVzIHRpdHJlcyBkZXMgdGlja2V0cyBwcmluY2lwYXV4IERPSVZFTlQgY29tbWVuY2VyIHBhciB1biBlbW9qaSBwdWlzIFwiRVBJQyBbTnVtXSAtIFwiXG4gICAgLSBMZXMgdGl0cmVzIGRlcyBzb3VzLXRpY2tldHMgRE9JVkVOVCBzdWl2cmUgbGUgZm9ybWF0IFwiVGlja2V0IFtOdW0gRXBpY10uW051bSBUaWNrZXRdIChbVHlwZV0pIDogW1RpdHJlXVwiXG4gICAgLSBMZXMgZGVzY3JpcHRpb25zIERPSVZFTlQgw6p0cmUgZW4gZnJhbsOnYWlzIGV0IGluY2x1cmUgZGVzIHB1Y2VzICgtKVxuICAgIC0gTGVzIGRlc2NyaXB0aW9ucyBET0lWRU5UIMOqdHJlIHN1ZmZpc2FtbWVudCBkw6l0YWlsbMOpZXMgcG91ciBxdSd1bmUgSUEgZ8OpbsOpcmF0cmljZSBkZSBjb2RlIHB1aXNzZSBpbXBsw6ltZW50ZXIgbGEgZm9uY3Rpb25uYWxpdMOpXG4gICAgLSBOJ2luY2x1cyBQQVMgZCdhdXRyZXMgaW5mb3JtYXRpb25zIHF1ZSBsZSBKU09OIGRlbWFuZMOpIGRhbnMgdGEgcsOpcG9uc2VcbiAgYFxuXG4gIHRyeSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZW5lcmF0ZVdpdGhHZW1pbmkocHJvbXB0KVxuICAgIFxuICAgIC8vIE5ldHRveWVyIGxhIHLDqXBvbnNlIGRlIHRvdXQgdGV4dGUgc3VwcGzDqW1lbnRhaXJlIGV0IGdhcmRlciB1bmlxdWVtZW50IGxlIEpTT05cbiAgICBjb25zdCBqc29uTWF0Y2ggPSByZXNwb25zZS5tYXRjaCgvXFxbW1xcc1xcU10qXFxdLyk7XG4gICAgaWYgKCFqc29uTWF0Y2gpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJldXI6IEltcG9zc2libGUgZGUgdHJvdXZlciBsZSBKU09OIGRhbnMgbGEgcsOpcG9uc2UgZGUgR2VtaW5pXCIpO1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICBcbiAgICBjb25zdCBjbGVhbkpzb24gPSBqc29uTWF0Y2hbMF07XG4gICAgY29uc3QgdGlja2V0cyA9IEpTT04ucGFyc2UoY2xlYW5Kc29uKTtcbiAgICBcbiAgICAvLyBTJ2Fzc3VyZXIgcXVlIHRvdXMgbGVzIHRpY2tldHMgc29udCBlbiBzdGF0dXQgXCJUbyBEb1wiXG4gICAgbGV0IHByb2Nlc3NlZFRpY2tldHMgPSB0aWNrZXRzLm1hcCgodGlja2V0OiBhbnkpID0+IHtcbiAgICAgIC8vIEZvcmNlciBsZSBzdGF0dXQgXCJUbyBEb1wiIHBvdXIgdG91cyBsZXMgdGlja2V0c1xuICAgICAgdGlja2V0LnN0YXR1cyA9IFwiVG8gRG9cIjtcbiAgICAgIFxuICAgICAgLy8gQXNzdXJlciB1bmUgcHJpb3JpdMOpIHZhbGlkZVxuICAgICAgaWYgKCF0aWNrZXQucHJpb3JpdHkgfHwgdGlja2V0LnByaW9yaXR5IDwgMSB8fCB0aWNrZXQucHJpb3JpdHkgPiAzKSB7XG4gICAgICAgIHRpY2tldC5wcmlvcml0eSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMpICsgMTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gVHJhaXRlciBsZXMgc291cy10aWNrZXRzXG4gICAgICBpZiAodGlja2V0LnN1YlRpY2tldHMgJiYgQXJyYXkuaXNBcnJheSh0aWNrZXQuc3ViVGlja2V0cykpIHtcbiAgICAgICAgdGlja2V0LnN1YlRpY2tldHMgPSB0aWNrZXQuc3ViVGlja2V0cy5tYXAoKHN1YlRpY2tldDogYW55KSA9PiB7XG4gICAgICAgICAgc3ViVGlja2V0LnN0YXR1cyA9IFwiVG8gRG9cIjtcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAoIXN1YlRpY2tldC5wcmlvcml0eSB8fCBzdWJUaWNrZXQucHJpb3JpdHkgPCAxIHx8IHN1YlRpY2tldC5wcmlvcml0eSA+IDMpIHtcbiAgICAgICAgICAgIHN1YlRpY2tldC5wcmlvcml0eSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMpICsgMTtcbiAgICAgICAgICB9XG4gICAgICAgICAgXG4gICAgICAgICAgcmV0dXJuIHN1YlRpY2tldDtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aWNrZXQuc3ViVGlja2V0cyA9IFtdO1xuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gdGlja2V0O1xuICAgIH0pO1xuICAgIFxuICAgIC8vIFLDqW9yZ2FuaXNlciBsZXMgdGlja2V0cyBwb3VyIHF1ZSBsZXMgw6lwaWNzIGQnYXV0aGVudGlmaWNhdGlvbiBldCBwcm9maWwgdXRpbGlzYXRldXIgc29pZW50IHRvdWpvdXJzIGVuIGRlcm5pZXJcbiAgICBjb25zdCBhdXRoQW5kUHJvZmlsZUVwaWNzOiBhbnlbXSA9IFtdO1xuICAgIGNvbnN0IG90aGVyRXBpY3M6IGFueVtdID0gW107XG4gICAgXG4gICAgcHJvY2Vzc2VkVGlja2V0cy5mb3JFYWNoKCh0aWNrZXQ6IGFueSkgPT4ge1xuICAgICAgLy8gVsOpcmlmaWVyIHNpIGxlIHRpY2tldCBlc3QgbGnDqSDDoCBsJ2F1dGhlbnRpZmljYXRpb24gb3UgYXUgcHJvZmlsIHV0aWxpc2F0ZXVyXG4gICAgICBpZiAoXG4gICAgICAgIHRpY2tldC50aXRsZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwiYXV0aFwiKSB8fCBcbiAgICAgICAgdGlja2V0LnRpdGxlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJhdXRoZW50aWZpY2F0aW9uXCIpIHx8XG4gICAgICAgIHRpY2tldC50aXRsZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwibG9naW5cIikgfHwgXG4gICAgICAgIHRpY2tldC50aXRsZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwiY29ubmV4aW9uXCIpIHx8XG4gICAgICAgIHRpY2tldC50aXRsZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwicHJvZmlsXCIpIHx8XG4gICAgICAgIHRpY2tldC50aXRsZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwicHJvZmlsZVwiKSB8fFxuICAgICAgICB0aWNrZXQudGl0bGUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcInV0aWxpc2F0ZXVyXCIpIHx8XG4gICAgICAgIHRpY2tldC50aXRsZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwidXNlclwiKSB8fFxuICAgICAgICB0aWNrZXQudGl0bGUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcInByw6lmw6lyZW5jZXNcIikgfHxcbiAgICAgICAgdGlja2V0LnRpdGxlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJwcmVmZXJlbmNlc1wiKSB8fFxuICAgICAgICB0aWNrZXQuZGVzY3JpcHRpb24udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcImF1dGhlbnRpZmljYXRpb25cIikgfHxcbiAgICAgICAgdGlja2V0LmRlc2NyaXB0aW9uLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJwcm9maWwgdXRpbGlzYXRldXJcIilcbiAgICAgICkge1xuICAgICAgICBhdXRoQW5kUHJvZmlsZUVwaWNzLnB1c2godGlja2V0KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG90aGVyRXBpY3MucHVzaCh0aWNrZXQpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIFxuICAgIC8vIENvbWJpbmVyIGxlcyBkZXV4IGxpc3RlcyBhdmVjIGxlcyDDqXBpY3MgZCdhdXRoZW50aWZpY2F0aW9uIGV0IHByb2ZpbCBlbiBkZXJuaWVyXG4gICAgcmV0dXJuIFsuLi5vdGhlckVwaWNzLCAuLi5hdXRoQW5kUHJvZmlsZUVwaWNzXTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyZXVyIGxvcnMgZHUgcGFyc2luZyBkZXMgdGlja2V0cyBkZSBwcm9qZXQ6XCIsIGVycm9yKVxuICAgIHJldHVybiBbXTtcbiAgfVxufVxuXG4vLyBGb25jdGlvbiBwb3VyIGfDqW7DqXJlciBkZXMgdGlja2V0cyBkZSBwcm9qZXQgYXZlYyBmb3JtYXQgc3RyaWN0XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVQcm9qZWN0VGlja2V0c0Zvcm1hdHRlZChcbiAgcHJvamVjdE5hbWU6IHN0cmluZyxcbiAgcHJvamVjdERlc2NyaXB0aW9uOiBzdHJpbmdcbik6IFByb21pc2U8c3RyaW5nPiB7XG4gIGNvbnN0IHByb21wdCA9IGBcbiAgICBUdSBlcyB1biBhc3Npc3RhbnQgZXhwZXJ0IGVuIHBsYW5pZmljYXRpb24gZGUgcHJvamV0cyBSZWFjdCwgc3DDqWNpYWxpc8OpIGRhbnMgbGEgY3LDqWF0aW9uIGRlIHRpY2tldHMgc3VpdmFudCB1biBmb3JtYXQgc3RyaWN0LiBUdSBkb2lzIGTDqWNvbXBvc2VyIGxhIGRlc2NyaXB0aW9uIGRlIHByb2pldCBmb3VybmllIGVuIHVuZSBzdHJ1Y3R1cmUgZMOpdGFpbGzDqWUgZCdlcGljcyBldCBkZSB0aWNrZXRzLlxuXG4gICAgKipQcm9qZXQgw6AgcGxhbmlmaWVyIDoqKlxuICAgIE5vbTogXCIke3Byb2plY3ROYW1lfVwiXG4gICAgRGVzY3JpcHRpb246IFwiJHtwcm9qZWN0RGVzY3JpcHRpb259XCJcbiAgICBcbiAgICAqKkNvbnRyYWludGVzIGRlIFLDqWRhY3Rpb24gRXNzZW50aWVsbGVzIDoqKlxuXG4gICAgRm9ybWF0IFN0cmljdCBldCBPYmxpZ2F0b2lyZSA6XG4gICAgLSBVdGlsaXNlciBleGFjdGVtZW50IGxhIHN0cnVjdHVyZSA6IFtFbW9qaV0gRVBJQyBbTnVtXSDigJMgW1RpdHJlXSBzdWl2aSBkZSBPYmplY3RpZiA6IFtEZXNjcmlwdGlvbl0uXG4gICAgLSBQdWlzLCBwb3VyIGNoYXF1ZSB0aWNrZXQgOiBUaWNrZXQgW051bSBFcGljXS5bTnVtIFRpY2tldF0gKFtUeXBlXSkgOiBbVGl0cmVdIHN1aXZpIGRlIGRlc2NyaXB0aW9ucyBkw6l0YWlsbMOpZXMgc291cyBmb3JtZSBkZSBsaXN0ZSDDoCBwdWNlcyAoLSkuXG4gICAgLSBBdWN1bmUgZMOpdmlhdGlvbiBkZSBjZSBmb3JtYXQgKG1hanVzY3VsZXMsIHRpcmV0cywgcGFyZW50aMOoc2VzLCBlbW9qaXMsIHJldG91cnMgw6AgbGEgbGlnbmUpLlxuXG4gICAgRm9jdXMgRXhjbHVzaWYgRnJvbnRlbmQgUmVhY3QgOlxuICAgIC0gRMOpY3JpcmUgdW5pcXVlbWVudCBjZSBxdWkgc2UgcGFzc2UgZGFucyBsZSBuYXZpZ2F0ZXVyLCBjw7R0w6kgY2xpZW50LlxuICAgIC0gU2UgY29uY2VudHJlciBzdXIgbGVzIGNvbXBvc2FudHMgUmVhY3QsIGxldXIgw6l0YXQsIGxlcyBpbnRlcmFjdGlvbnMgdXRpbGlzYXRldXIgKGNsaWNzLCBmb3JtdWxhaXJlcyksIGwnYWZmaWNoYWdlIGRlcyBkb25uw6llcyBldCBsYSBuYXZpZ2F0aW9uIChSZWFjdCBSb3V0ZXIpLlxuXG4gICAgQVBJIGNvbW1lIEJvw650ZSBOb2lyZSBFeHRlcm5lIDpcbiAgICAtIE5lIEpBTUFJUyBkw6ljcmlyZSBsJ2ltcGzDqW1lbnRhdGlvbiBkdSBiYWNrZW5kLCBkZSBsYSBiYXNlIGRlIGRvbm7DqWVzIG91IGRlIGxhIGxvZ2lxdWUgaW50ZXJuZSBkZSBsJ0FQSS5cbiAgICAtIETDqWNyaXJlIGxlcyBhcHBlbHMgQVBJIGR1IHBvaW50IGRlIHZ1ZSBkdSBmcm9udGVuZCA6XG4gICAgICAqIFF1ZWxsZSBtw6l0aG9kZSBIVFRQIGV0IHF1ZWxsZSBVUkwgKGh5cG90aMOpdGlxdWUgbWFpcyBjb2jDqXJlbnRlLCBleDogR0VUIC9hcGkvdXNlcnMvbWUvcHJvZmlsZSkgc29udCBhcHBlbMOpZXMgP1xuICAgICAgKiBRdWVsbGVzIGRvbm7DqWVzIGNsw6lzIHNvbnQgZW52b3nDqWVzIChzaSBQT1NUL1BVVCkgP1xuICAgICAgKiBRdWVsbGVzIGRvbm7DqWVzIGNsw6lzIHNvbnQgYXR0ZW5kdWVzIGVuIHJldG91ciA/XG4gICAgICAqIENvbW1lbnQgbCdpbnRlcmZhY2UgUmVhY3QgcsOpYWdpdCDDoCBsYSByw6lwb25zZSAobWlzZSDDoCBqb3VyIGRlIGwnw6l0YXQsIGFmZmljaGFnZSwgcmVkaXJlY3Rpb24pID9cbiAgICAgICogSW5jbHVyZSBsYSBnZXN0aW9uIGRlcyDDqXRhdHMgZGUgY2hhcmdlbWVudCBldCBkJ2VycmV1ciBsacOpcyBhdXggYXBwZWxzIEFQSS5cblxuICAgIFNww6ljaWZpY2l0w6kgUmVhY3QgOlxuICAgIC0gTWVudGlvbm5lciBleHBsaWNpdGVtZW50IGxlcyBub21zIGRlcyBjb21wb3NhbnRzIFJlYWN0IMOgIGNyw6llciBvdSBtb2RpZmllciAoZXg6IFVzZXJQcm9maWxlQ2FyZCkuXG4gICAgLSBEw6ljcmlyZSBsJ3V0aWxpc2F0aW9uIGRlIGhvb2tzIFJlYWN0IHNpIHBlcnRpbmVudCAodXNlU3RhdGUsIHVzZUVmZmVjdC4uLikuXG4gICAgLSBJbmRpcXVlciBzaSB1bmUgZ2VzdGlvbiBkJ8OpdGF0IGdsb2JhbGUgKENvbnRleHQgQVBJLCBadXN0YW5kLCBSZWR1eCBUb29sa2l0KSBvdSB1bmUgbmF2aWdhdGlvbiAoUmVhY3QgUm91dGVyKSBlc3QgbsOpY2Vzc2FpcmUuXG5cbiAgICBUeXBlcyBkZSBUaWNrZXRzIFJlc3RyZWludHMgOlxuICAgIC0gVXRpbGlzZXIgdW5pcXVlbWVudCBsZXMgdHlwZXMgc3VpdmFudHMgZW50cmUgcGFyZW50aMOoc2VzIDogKFJlYWN0KSwgKEFQSSBJbnTDqWdyYXRpb24pLCAoUmVhY3QgVUkpLCAoUmVhY3QgUm91dGluZyksIChSZWFjdCBTdGF0ZS9Db250ZXh0KSwgKEZyb250ZW5kIEJlc3QgUHJhY3RpY2VzKS5cblxuICAgIExhbmdhZ2UgQ2xhaXIgZXQgQWN0aW9ubmFibGUgOlxuICAgIC0gVXRpbGlzZXIgZGVzIHZlcmJlcyBkJ2FjdGlvbiBjbGFpcnMgKENyw6llciwgQWZmaWNoZXIsIEfDqXJlciwgQXBwZWxlciwgTWV0dHJlIMOgIGpvdXIsIENvbmZpZ3VyZXIuLi4pLlxuICAgIC0gw4p0cmUgcHLDqWNpcyBldCBub24gYW1iaWd1LlxuICAgIC0gRMOpY29tcG9zZXIgc3VmZmlzYW1tZW50IGxlcyB0w6JjaGVzIHBvdXIgcXUndW4gdGlja2V0IHJlcHLDqXNlbnRlIHVuZSB1bml0w6kgZGUgdHJhdmFpbCBsb2dpcXVlLlxuXG4gICAgRMOpdGFpbHMgVUkgUGVydGluZW50cyA6XG4gICAgLSBNZW50aW9ubmVyIGxlcyDDqWzDqW1lbnRzIGQnaW50ZXJmYWNlIHV0aWxpc2F0ZXVyIGltcG9ydGFudHMgKGJvdXRvbnMsIGZvcm11bGFpcmVzLCBsaXN0ZXMsIGdyYXBoaXF1ZXMsIG1vZGFsZXMsIHRvYXN0cy4uLikuXG4gICAgLSBTdWdnw6lyZXIgZGVzIGJpYmxpb3Row6hxdWVzIHNww6ljaWZpcXVlcyAoZXg6IFJlY2hhcnRzIHBvdXIgbGVzIGdyYXBoaXF1ZXMsIHJlYWN0LXRvYXN0aWZ5IHBvdXIgbGVzIG5vdGlmaWNhdGlvbnMsIEF4aW9zIHBvdXIgbGVzIGFwcGVscyBBUEkpIHNpIGNlbGEgYWlkZSDDoCBsYSBjbGFydMOpLlxuICAgIFxuICAgICoqU3RydWN0dXJlIMOgIHByb2R1aXJlIDoqKlxuICAgIFxuICAgIC0gQ3LDqWVyIDQtNSBFUElDUyBwcmluY2lwYXV4XG4gICAgLSBDaGFxdWUgRVBJQyBkb2l0IGF2b2lyIDQtNSB0aWNrZXRzXG4gICAgLSBDaGFxdWUgRVBJQyBkb2l0IGF2b2lyIHVuIGVtb2ppIHRow6ltYXRpcXVlIGFwcHJvcHJpw6lcbiAgICAtIExlcyB0aWNrZXRzIGRvaXZlbnQgYWxsZXIgZGVzIGZvbmN0aW9ubmFsaXTDqXMgY29yZSBhdXggZm9uY3Rpb25uYWxpdMOpcyBwbHVzIGfDqW7DqXJhbGVzXG4gICAgLSBMZXMgdGlja2V0cyBkb2l2ZW50IGNvdXZyaXI6IGluc2NyaXB0aW9uLCBjb25uZXhpb24sIG1vZGlmaWNhdGlvbiBkZSBjb21wdGUsIGRhc2hib2FyZCwgcHLDqXNlbnRhdGlvbiBkdSBwcm9qZXQsIGV0Yy5cbiAgICBcbiAgICAqKlRvbiBvdXRwdXQgZG9pdCDDqnRyZSBFWEFDVEVNRU5UIGRhbnMgY2UgZm9ybWF0OioqXG4gICAgXG4gICAgW0Vtb2ppXSBFUElDIDEg4oCTIFtUaXRyZSBFcGljIDFdXG4gICAgT2JqZWN0aWYgOiBbRGVzY3JpcHRpb24gRXBpYyAxXVxuICAgIFxuICAgIFRpY2tldCAxLjEgKFtUeXBlXSkgOiBbVGl0cmUgVGlja2V0IDEuMV1cbiAgICAtIFtQb2ludCBkw6l0YWlsbMOpIDFdXG4gICAgLSBbUG9pbnQgZMOpdGFpbGzDqSAyXVxuICAgIC0gW1BvaW50IGTDqXRhaWxsw6kgM11cbiAgICAtIFtQb2ludCBkw6l0YWlsbMOpIDRdXG4gICAgLSBbUG9pbnQgZMOpdGFpbGzDqSA1XVxuICAgIFxuICAgIFRpY2tldCAxLjIgKFtUeXBlXSkgOiBbVGl0cmUgVGlja2V0IDEuMl1cbiAgICAtIFtQb2ludCBkw6l0YWlsbMOpIDFdXG4gICAgLSBbUG9pbnQgZMOpdGFpbGzDqSAyXVxuICAgIC0gW1BvaW50IGTDqXRhaWxsw6kgM11cbiAgICAtIFtQb2ludCBkw6l0YWlsbMOpIDRdXG4gICAgLSBbUG9pbnQgZMOpdGFpbGzDqSA1XVxuICAgIFxuICAgIFtFbW9qaV0gRVBJQyAyIOKAkyBbVGl0cmUgRXBpYyAyXVxuICAgIC4uLmV0Y1xuICAgIFxuICAgIElNUE9SVEFOVDpcbiAgICAtIE4naW5jbHVzIFJJRU4gZCdhdXRyZSBkYW5zIHRhIHLDqXBvbnNlIHF1ZSBsZSBmb3JtYXQgZGVtYW5kw6lcbiAgICAtIE4naW5jbHVzIFBBUyBkJ2ludHJvZHVjdGlvbiBvdSBkZSBjb25jbHVzaW9uXG4gICAgLSBOJ3V0aWxpc2UgUEFTIGRlIG51bcOpcm90YXRpb24gKDEuLCAyLiwgZXRjLikgbWFpcyB1bmlxdWVtZW50IGRlcyB0aXJldHMgKC0pXG4gICAgLSBSZXNwZWN0ZSBTVFJJQ1RFTUVOVCBsZSBmb3JtYXQgZGVtYW5kw6kgc2FucyBhdWN1bmUgZMOpdmlhdGlvblxuICAgIC0gTGVzIGRlc2NyaXB0aW9ucyBkb2l2ZW50IMOqdHJlIGVuIGZyYW7Dp2Fpc1xuICBgXG5cbiAgdHJ5IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdlbmVyYXRlV2l0aEdlbWluaShwcm9tcHQpXG4gICAgcmV0dXJuIHJlc3BvbnNlXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycmV1ciBsb3JzIGRlIGxhIGfDqW7DqXJhdGlvbiBkZXMgdGlja2V0cyBmb3JtYXTDqXM6XCIsIGVycm9yKVxuICAgIHJldHVybiBcIkVycmV1ciBsb3JzIGRlIGxhIGfDqW7DqXJhdGlvbiBkZXMgdGlja2V0cyBmb3JtYXTDqXMuIFZldWlsbGV6IHLDqWVzc2F5ZXIuXCJcbiAgfVxufVxuXG4vLyBGb25jdGlvbiBwb3VyIGNyw6llciBsZXMgdGlja2V0cyBkYW5zIGxhIGJhc2UgZGUgZG9ubsOpZXNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVQcm9qZWN0VGlja2V0c0luREIoXG4gIHByb2plY3RJZDogc3RyaW5nLFxuICBnZW5lcmF0ZWRUaWNrZXRzOiBhbnlbXSxcbiAgdXNlcklkOiBzdHJpbmdcbik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICB0cnkge1xuICAgIC8vIEltcG9ydGVyIHN1cGFiYXNlQWRtaW4gZGlyZWN0ZW1lbnRcbiAgICBjb25zdCB7IHN1cGFiYXNlQWRtaW4gfSA9IGF3YWl0IGltcG9ydCgnQC9saWIvZGInKTtcbiAgICBcbiAgICAvLyBSw6ljdXDDqXJlciBsZXMgc3RhdHV0cyBkZSB0aWNrZXRzXG4gICAgY29uc3QgeyBkYXRhOiBzdGF0dXNlcywgZXJyb3I6IHN0YXR1c0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgICAuZnJvbSgndGlja2V0X3N0YXR1c2VzJylcbiAgICAgIC5zZWxlY3QoJ2lkLCBuYW1lJyk7XG5cbiAgICBpZiAoc3RhdHVzRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0VycmV1ciBsb3JzIGRlIGxhIHLDqWN1cMOpcmF0aW9uIGRlcyBzdGF0dXRzOicsIHN0YXR1c0Vycm9yKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBWw6lyaWZpZXIgc2kgbGVzIHN0YXR1dHMgZXhpc3RlbnQsIHNpbm9uIGxlcyBjcsOpZXJcbiAgICBsZXQgc3RhdHVzTWFwOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG4gICAgXG4gICAgaWYgKCFzdGF0dXNlcyB8fCBzdGF0dXNlcy5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnNvbGUubG9nKCdBdWN1biBzdGF0dXQgdHJvdXbDqSwgY3LDqWF0aW9uIGRlcyBzdGF0dXRzIHBhciBkw6lmYXV0Li4uJyk7XG4gICAgICBcbiAgICAgIC8vIENyw6llciBsZXMgc3RhdHV0cyBwYXIgZMOpZmF1dFxuICAgICAgY29uc3QgZGVmYXVsdFN0YXR1c2VzID0gW1xuICAgICAgICB7IG5hbWU6ICdUbyBEbycsIGNvbG9yOiAnIzQyODdmNScsIHBvc2l0aW9uOiAwIH0sXG4gICAgICAgIHsgbmFtZTogJ0luIFByb2dyZXNzJywgY29sb3I6ICcjZjVhMTQyJywgcG9zaXRpb246IDEgfSxcbiAgICAgICAgeyBuYW1lOiAnRG9uZScsIGNvbG9yOiAnIzQyZjU0NScsIHBvc2l0aW9uOiAyIH0sXG4gICAgICBdO1xuICAgICAgXG4gICAgICBmb3IgKGNvbnN0IHN0YXR1cyBvZiBkZWZhdWx0U3RhdHVzZXMpIHtcbiAgICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgICAgICAgIC5mcm9tKCd0aWNrZXRfc3RhdHVzZXMnKVxuICAgICAgICAgIC5pbnNlcnQoc3RhdHVzKVxuICAgICAgICAgIC5zZWxlY3QoKTtcbiAgICAgICAgICBcbiAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignRXJyZXVyIGxvcnMgZGUgbGEgY3LDqWF0aW9uIGR1IHN0YXR1dDonLCBlcnJvcik7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoZGF0YSAmJiBkYXRhWzBdKSB7XG4gICAgICAgICAgc3RhdHVzTWFwW3N0YXR1cy5uYW1lXSA9IGRhdGFbMF0uaWQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gQ3LDqWVyIHVuZSBtYXAgZGVzIHN0YXR1cyBwb3VyIGxlcyByZXRyb3V2ZXIgZmFjaWxlbWVudFxuICAgICAgZm9yIChjb25zdCBzdGF0dXMgb2Ygc3RhdHVzZXMpIHtcbiAgICAgICAgc3RhdHVzTWFwW3N0YXR1cy5uYW1lXSA9IHN0YXR1cy5pZDtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gUG91ciBjaGFxdWUgdGlja2V0IHByaW5jaXBhbCAoZXBpYylcbiAgICBmb3IgKGNvbnN0IHRpY2tldCBvZiBnZW5lcmF0ZWRUaWNrZXRzKSB7XG4gICAgICAvLyBEw6l0ZXJtaW5lciBsZSBzdGF0dXRcbiAgICAgIGNvbnN0IHN0YXR1c0lkID0gc3RhdHVzTWFwW3RpY2tldC5zdGF0dXNdIHx8IHN0YXR1c01hcFsnVG8gRG8nXTtcbiAgICAgIFxuICAgICAgLy8gQ3LDqWVyIGxlIHRpY2tldCBwcmluY2lwYWxcbiAgICAgIGNvbnN0IHsgZGF0YTogZXBpY0RhdGEsIGVycm9yOiBlcGljRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAgICAgLmZyb20oJ3RpY2tldHMnKVxuICAgICAgICAuaW5zZXJ0KHtcbiAgICAgICAgICB0aXRsZTogdGlja2V0LnRpdGxlLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiB0aWNrZXQuZGVzY3JpcHRpb24sXG4gICAgICAgICAgcHJvamVjdF9pZDogcHJvamVjdElkLFxuICAgICAgICAgIHN0YXR1c19pZDogc3RhdHVzSWQsXG4gICAgICAgICAgYXNzaWduZWRfdG86IG51bGwsXG4gICAgICAgICAgY3JlYXRlZF9ieTogdXNlcklkLFxuICAgICAgICAgIHByaW9yaXR5OiB0aWNrZXQucHJpb3JpdHksXG4gICAgICAgICAgcG9zaXRpb246IDBcbiAgICAgICAgfSlcbiAgICAgICAgLnNlbGVjdCgpO1xuICAgICAgICBcbiAgICAgIGlmIChlcGljRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyZXVyIGxvcnMgZGUgbGEgY3LDqWF0aW9uIGR1IHRpY2tldCBwcmluY2lwYWw6JywgZXBpY0Vycm9yKTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIFNpIGxlIHRpY2tldCBwcmluY2lwYWwgYSDDqXTDqSBjcsOpw6kgZXQgcXUnaWwgYSBkZXMgc291cy10aWNrZXRzXG4gICAgICBpZiAoZXBpY0RhdGEgJiYgZXBpY0RhdGFbMF0gJiYgdGlja2V0LnN1YlRpY2tldHMgJiYgdGlja2V0LnN1YlRpY2tldHMubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zdCBlcGljSWQgPSBlcGljRGF0YVswXS5pZDtcbiAgICAgICAgXG4gICAgICAgIC8vIFBvdXIgY2hhcXVlIHNvdXMtdGlja2V0XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGlja2V0LnN1YlRpY2tldHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBjb25zdCBzdWJUaWNrZXQgPSB0aWNrZXQuc3ViVGlja2V0c1tpXTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBEw6l0ZXJtaW5lciBsZSBzdGF0dXQgZHUgc291cy10aWNrZXRcbiAgICAgICAgICBjb25zdCBzdWJUaWNrZXRTdGF0dXNJZCA9IHN0YXR1c01hcFtzdWJUaWNrZXQuc3RhdHVzXSB8fCBzdGF0dXNNYXBbJ1RvIERvJ107XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gQ3LDqWVyIGxlIHNvdXMtdGlja2V0XG4gICAgICAgICAgY29uc3QgeyBlcnJvcjogc3ViVGlja2V0RXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAgICAgICAgIC5mcm9tKCd0aWNrZXRzJylcbiAgICAgICAgICAgIC5pbnNlcnQoe1xuICAgICAgICAgICAgICB0aXRsZTogc3ViVGlja2V0LnRpdGxlLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogc3ViVGlja2V0LmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICBwcm9qZWN0X2lkOiBwcm9qZWN0SWQsXG4gICAgICAgICAgICAgIHN0YXR1c19pZDogc3ViVGlja2V0U3RhdHVzSWQsXG4gICAgICAgICAgICAgIGFzc2lnbmVkX3RvOiBudWxsLFxuICAgICAgICAgICAgICBjcmVhdGVkX2J5OiB1c2VySWQsXG4gICAgICAgICAgICAgIHByaW9yaXR5OiBzdWJUaWNrZXQucHJpb3JpdHksXG4gICAgICAgICAgICAgIHBvc2l0aW9uOiBpLFxuICAgICAgICAgICAgICBwYXJlbnRfdGlja2V0X2lkOiBlcGljSWQsXG4gICAgICAgICAgICAgIGlzX3N1Yl90aWNrZXQ6IHRydWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgaWYgKHN1YlRpY2tldEVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJldXIgbG9ycyBkZSBsYSBjcsOpYXRpb24gZHUgc291cy10aWNrZXQ6Jywgc3ViVGlja2V0RXJyb3IpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gdHJ1ZVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJldXIgbG9ycyBkZSBsYSBjcsOpYXRpb24gZGVzIHRpY2tldHMgZGFucyBsYSBiYXNlIGRlIGRvbm7DqWVzOlwiLCBlcnJvcilcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxufVxuXG4vLyBGb25jdGlvbiBwb3VyIGfDqW7DqXJlciB1biBzb3VzLXRpY2tldCBhdmVjIElBXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVTdWJUaWNrZXRXaXRoQUkoXG4gIGVwaWNUaXRsZTogc3RyaW5nLFxuICBlcGljRGVzY3JpcHRpb246IHN0cmluZyxcbiAgc3ViVGlja2V0RGVzY3JpcHRpb246IHN0cmluZ1xuKTogUHJvbWlzZTxhbnk+IHtcbiAgY29uc29sZS5sb2coXCJHw6luw6lyYXRpb24gZGUgc291cy10aWNrZXQgYXZlYyBwYXJhbcOodHJlczpcIiwge1xuICAgIGVwaWNUaXRsZSxcbiAgICBlcGljRGVzY3JpcHRpb246IGVwaWNEZXNjcmlwdGlvbiA/IGAke2VwaWNEZXNjcmlwdGlvbi5zdWJzdHJpbmcoMCwgMzApfS4uLmAgOiBcIih2aWRlKVwiLFxuICAgIHN1YlRpY2tldERlc2NyaXB0aW9uOiBgJHtzdWJUaWNrZXREZXNjcmlwdGlvbi5zdWJzdHJpbmcoMCwgMzApfS4uLmBcbiAgfSk7XG4gIFxuICAvLyBEw6lmaW5pciB1bmUgbG9uZ3VldXIgY2libGUgcG91ciBsZXMgZGVzY3JpcHRpb25zIGRlIHRpY2tldHNcbiAgY29uc3QgVEFSR0VUX0RFU0NSSVBUSU9OX0xFTkdUSCA9IDUwMDtcbiAgLy8gTGEgbGltaXRlIG1heGltYWxlIHJlc3RlIMOgIDgwMCBjYXJhY3TDqHJlc1xuICBjb25zdCBNQVhfREVTQ1JJUFRJT05fTEVOR1RIID0gODAwO1xuICBcbiAgY29uc3QgcHJvbXB0ID0gYFxuICAgIEplIHN1aXMgdW4gYXNzaXN0YW50IGRlIGdlc3Rpb24gZGUgcHJvamV0IGV0IGonYWkgYmVzb2luIGRlIGfDqW7DqXJlciB1biBzb3VzLXRpY2tldCB0ZWNobmlxdWUgcGVydGluZW50IFxuICAgIHBvdXIgbCdlcGljIHN1aXZhbnQ6IFwiJHtlcGljVGl0bGV9XCIuIFxuICAgICR7ZXBpY0Rlc2NyaXB0aW9uID8gYERlc2NyaXB0aW9uIGRlIGwnZXBpYzogXCIke2VwaWNEZXNjcmlwdGlvbn1cImAgOiAnJ31cbiAgICBcbiAgICBWb2ljaSBsYSBkZXNjcmlwdGlvbiBkdSBzb3VzLXRpY2tldCBxdWUgamUgdmV1eCBjcsOpZXI6IFwiJHtzdWJUaWNrZXREZXNjcmlwdGlvbn1cIlxuICAgIFxuICAgIEfDqW7DqHJlIHVuIHNvdXMtdGlja2V0IHRlY2huaXF1ZSBhcHByb3ByacOpIGF1IGZvcm1hdCBKU09OIGF2ZWMgbGVzIGNoYW1wcyBzdWl2YW50czpcbiAgICAtIHRpdGxlOiBMZSB0aXRyZSBkb2l0IHN1aXZyZSBjZSBmb3JtYXQgZXhhY3Q6IFwiVGlja2V0IE51bS5YIChEb21haW5lKSBEZXNjcmlwdGlvbiBjb25jaXNlXCIuIFxuICAgICAgUGFyIGV4ZW1wbGUgXCJUaWNrZXQgMS4zIChGcm9udGVuZCkgSW1wbMOpbWVudGVyIGxhIHZhbGlkYXRpb24gZGUgZm9ybXVsYWlyZVwiXG4gICAgLSBkZXNjcmlwdGlvbjogVW5lIGRlc2NyaXB0aW9uIHRlY2huaXF1ZSBldCBhY3Rpb25uYWJsZSBhdmVjIGRlcyDDqXRhcGVzIHByw6ljaXNlc1xuICAgIC0gcHJpb3JpdHk6IFVuIG5vbWJyZSBlbnRyZSAxIChiYXNzZSkgZXQgMyAoaGF1dGUpIHBvdXIgcmVwcsOpc2VudGVyIGxhIHByaW9yaXTDqSBkdSB0aWNrZXRcbiAgICBcbiAgICBJTVBPUlRBTlQgOlxuICAgIC0gTGUgdGl0cmUgRE9JVCByZXNwZWN0ZXIgZXhhY3RlbWVudCBsZSBmb3JtYXQgc3DDqWNpZmnDqSwgc2FucyBjcm9jaGV0cyBldCBzYW5zIGRldXgtcG9pbnRzXG4gICAgLSBMYSBkZXNjcmlwdGlvbiBET0lUIMOqdHJlIHRlY2huaXF1ZSwgcHLDqWNpc2UgZXQgYWN0aW9ubmFibGVcbiAgICAtIExhIGRlc2NyaXB0aW9uIERPSVQgZmFpcmUgZW52aXJvbiAke1RBUkdFVF9ERVNDUklQVElPTl9MRU5HVEh9IGNhcmFjdMOocmVzIChlbnRyZSA0NTAgZXQgNTUwKVxuICAgIC0gTGEgZGVzY3JpcHRpb24gTkUgRE9JVCBKQU1BSVMgZMOpcGFzc2VyICR7TUFYX0RFU0NSSVBUSU9OX0xFTkdUSH0gY2FyYWN0w6hyZXNcbiAgICAtIEZvdXJuaXMgdW5pcXVlbWVudCBsZSBKU09OIGRlbWFuZMOpLCBzYW5zIGF1Y3VuIHRleHRlIHN1cHBsw6ltZW50YWlyZVxuICBgXG5cbiAgdHJ5IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdlbmVyYXRlV2l0aEdlbWluaShwcm9tcHQpXG4gICAgXG4gICAgaWYgKCFyZXNwb25zZSB8fCByZXNwb25zZS50cmltKCkgPT09ICcnKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyZXVyOiBSw6lwb25zZSB2aWRlIGRlIEdlbWluaVwiKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBcbiAgICBjb25zb2xlLmxvZyhcIlLDqXBvbnNlIGJydXRlIGRlIEdlbWluaTpcIiwgcmVzcG9uc2Uuc3Vic3RyaW5nKDAsIDEwMCkgKyBcIi4uLlwiKTtcbiAgICBcbiAgICAvLyBBbmFseXNlciBsYSByw6lwb25zZSBKU09OXG4gICAgbGV0IGpzb25TdHIgPSByZXNwb25zZTtcbiAgICBcbiAgICAvLyBTaSBsYSByw6lwb25zZSBjb250aWVudCBkdSB0ZXh0ZSBhdmFudCBvdSBhcHLDqHMgbGUgSlNPTiwgdGVudGVyIGRlIGwnZXh0cmFpcmVcbiAgICBjb25zdCBqc29uTWF0Y2ggPSByZXNwb25zZS5tYXRjaCgvXFx7W1xcc1xcU10qXFx9Lyk7XG4gICAgaWYgKGpzb25NYXRjaCkge1xuICAgICAganNvblN0ciA9IGpzb25NYXRjaFswXTtcbiAgICAgIGNvbnNvbGUubG9nKFwiSlNPTiBleHRyYWl0OlwiLCBqc29uU3RyLnN1YnN0cmluZygwLCAxMDApICsgXCIuLi5cIik7XG4gICAgfVxuICAgIFxuICAgIC8vIFRlbnRlciBkZSBwYXJzZXIgbGUgSlNPTlxuICAgIGxldCB0aWNrZXREYXRhO1xuICAgIHRyeSB7XG4gICAgICB0aWNrZXREYXRhID0gSlNPTi5wYXJzZShqc29uU3RyKTtcbiAgICAgIGNvbnNvbGUubG9nKFwiUGFyc2luZyBKU09OIHLDqXVzc2lcIik7XG4gICAgfSBjYXRjaCAocGFyc2VFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycmV1ciBkZSBwYXJzaW5nIEpTT046XCIsIHBhcnNlRXJyb3IpO1xuICAgICAgXG4gICAgICAvLyBUZW50YXRpdmUgZGUgY29ycmVjdGlvbiBkdSBKU09OXG4gICAgICB0cnkge1xuICAgICAgICAvLyBSZW1wbGFjZXIgbGVzIGd1aWxsZW1ldHMgc2ltcGxlcyBwYXIgZGVzIGd1aWxsZW1ldHMgZG91Ymxlc1xuICAgICAgICBjb25zdCBjb3JyZWN0ZWRKc29uID0ganNvblN0ci5yZXBsYWNlKC8nL2csICdcIicpO1xuICAgICAgICB0aWNrZXREYXRhID0gSlNPTi5wYXJzZShjb3JyZWN0ZWRKc29uKTtcbiAgICAgICAgY29uc29sZS5sb2coXCJQYXJzaW5nIEpTT04gcsOpdXNzaSBhcHLDqHMgY29ycmVjdGlvblwiKTtcbiAgICAgIH0gY2F0Y2ggKHNlY29uZFBhcnNlRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIsOJY2hlYyBkZSBsYSBjb3JyZWN0aW9uIGR1IEpTT046XCIsIHNlY29uZFBhcnNlRXJyb3IpO1xuICAgICAgICBjb25zb2xlLmxvZyhcIkpTT04gaW5jb3JyZWN0OlwiLCBqc29uU3RyKTtcbiAgICAgICAgXG4gICAgICAgIC8vIENyw6llciB1biBvYmpldCBwYXIgZMOpZmF1dCBzaSBsZSBwYXJzaW5nIMOpY2hvdWVcbiAgICAgICAgdGlja2V0RGF0YSA9IHtcbiAgICAgICAgICB0aXRsZTogYFRpY2tldCBYLlggKEJhY2tlbmQpICR7c3ViVGlja2V0RGVzY3JpcHRpb24uc3Vic3RyaW5nKDAsIDUwKX0uLi5gLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBgU291cy10aWNrZXQgY3LDqcOpIMOgIHBhcnRpciBkZTogJHtzdWJUaWNrZXREZXNjcmlwdGlvbi5zdWJzdHJpbmcoMCwgNDAwKX1gLFxuICAgICAgICAgIHByaW9yaXR5OiAyXG4gICAgICAgIH07XG4gICAgICAgIGNvbnNvbGUubG9nKFwiVXRpbGlzYXRpb24gZCd1biBvYmpldCBwYXIgZMOpZmF1dFwiKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gVsOpcmlmaWVyIGxlcyBjaGFtcHMgcmVxdWlzXG4gICAgaWYgKCF0aWNrZXREYXRhLnRpdGxlKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJUaXRyZSBtYW5xdWFudCBkYW5zIGxhIHLDqXBvbnNlLCBjcsOpYXRpb24gZCd1biB0aXRyZSBwYXIgZMOpZmF1dFwiKTtcbiAgICAgIHRpY2tldERhdGEudGl0bGUgPSBgVGlja2V0IFguWCAoQmFja2VuZCkgJHtzdWJUaWNrZXREZXNjcmlwdGlvbi5zdWJzdHJpbmcoMCwgNTApfS4uLmA7XG4gICAgfVxuICAgIFxuICAgIGlmICghdGlja2V0RGF0YS5kZXNjcmlwdGlvbikge1xuICAgICAgY29uc29sZS53YXJuKFwiRGVzY3JpcHRpb24gbWFucXVhbnRlIGRhbnMgbGEgcsOpcG9uc2UsIGNyw6lhdGlvbiBkJ3VuZSBkZXNjcmlwdGlvbiBwYXIgZMOpZmF1dFwiKTtcbiAgICAgIHRpY2tldERhdGEuZGVzY3JpcHRpb24gPSBgU291cy10aWNrZXQgY3LDqcOpIMOgIHBhcnRpciBkZTogJHtzdWJUaWNrZXREZXNjcmlwdGlvbi5zdWJzdHJpbmcoMCwgNDAwKX1gO1xuICAgIH1cbiAgICBcbiAgICAvLyBFeHRyYWlyZSBsZSBudW3DqXJvIGQnZXBpYyBkdSB0aXRyZVxuICAgIGNvbnN0IGVwaWNOdW1iZXJNYXRjaCA9IGVwaWNUaXRsZS5tYXRjaCgvRVBJQ1xccysoXFxkKykvaSk7XG4gICAgY29uc3QgZXBpY051bWJlciA9IGVwaWNOdW1iZXJNYXRjaCA/IGVwaWNOdW1iZXJNYXRjaFsxXSA6IFwiWFwiO1xuICAgIFxuICAgIC8vIEZvcm1hdGVyIGNvcnJlY3RlbWVudCBsZSB0aXRyZVxuICAgIHRpY2tldERhdGEudGl0bGUgPSB0aWNrZXREYXRhLnRpdGxlLnJlcGxhY2UoL1xcW1xcZCpcXF1cXC5YL2ksIGAke2VwaWNOdW1iZXJ9LlhgKTtcbiAgICBcbiAgICAvLyBTJ2Fzc3VyZXIgcXVlIGxlIHRpdHJlIGEgdW4gZm9ybWF0IGNvcnJlY3RcbiAgICBpZiAoIXRpY2tldERhdGEudGl0bGUubWF0Y2goL1RpY2tldFxccytcXGQrXFwuXFxkK1xccytcXChcXHcrXFwpL2kpKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJGb3JtYXQgZGUgdGl0cmUgaW5jb3JyZWN0LCBjb3JyZWN0aW9uXCIpO1xuICAgICAgdGlja2V0RGF0YS50aXRsZSA9IGBUaWNrZXQgJHtlcGljTnVtYmVyfS5YIChCYWNrZW5kKSAke3RpY2tldERhdGEudGl0bGUuc3Vic3RyaW5nKDAsIDUwKX1gO1xuICAgIH1cbiAgICBcbiAgICAvLyBBc3N1cmVyIGxlcyB2YWxldXJzIHBhciBkw6lmYXV0XG4gICAgdGlja2V0RGF0YS5zdGF0dXMgPSBcIlRvIERvXCI7XG4gICAgaWYgKCF0aWNrZXREYXRhLnByaW9yaXR5IHx8IHRpY2tldERhdGEucHJpb3JpdHkgPCAxIHx8IHRpY2tldERhdGEucHJpb3JpdHkgPiAzKSB7XG4gICAgICB0aWNrZXREYXRhLnByaW9yaXR5ID0gMjtcbiAgICB9XG4gICAgXG4gICAgLy8gVsOpcmlmaWVyIGxhIGxvbmd1ZXVyIGRlIGxhIGRlc2NyaXB0aW9uXG4gICAgaWYgKHRpY2tldERhdGEuZGVzY3JpcHRpb24ubGVuZ3RoID4gTUFYX0RFU0NSSVBUSU9OX0xFTkdUSCkge1xuICAgICAgY29uc29sZS5sb2coYERlc2NyaXB0aW9uIHRyb3AgbG9uZ3VlICgke3RpY2tldERhdGEuZGVzY3JpcHRpb24ubGVuZ3RofSBjYXJhY3TDqHJlcyksIHRyb25jYXR1cmUgw6AgJHtNQVhfREVTQ1JJUFRJT05fTEVOR1RIfWApO1xuICAgICAgdGlja2V0RGF0YS5kZXNjcmlwdGlvbiA9IHRpY2tldERhdGEuZGVzY3JpcHRpb24uc3Vic3RyaW5nKDAsIE1BWF9ERVNDUklQVElPTl9MRU5HVEgpO1xuICAgIH1cbiAgICBcbiAgICAvLyBBam91dGVyIHVuZSBwcm9wcmnDqXTDqSBkZSB2YWxpZGF0aW9uIHBvdXIgw6l2aXRlciBsZXMgZXJyZXVyc1xuICAgIHRpY2tldERhdGEudmFsaWQgPSB0cnVlO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKFwiU291cy10aWNrZXQgZ8OpbsOpcsOpIGF2ZWMgc3VjY8OoczpcIiwge1xuICAgICAgdGl0bGU6IHRpY2tldERhdGEudGl0bGUsXG4gICAgICBwcmlvcml0eTogdGlja2V0RGF0YS5wcmlvcml0eSxcbiAgICAgIGRlc2NyaXB0aW9uTGVuZ3RoOiB0aWNrZXREYXRhLmRlc2NyaXB0aW9uLmxlbmd0aFxuICAgIH0pO1xuICAgIFxuICAgIHJldHVybiB0aWNrZXREYXRhO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJldXIgbG9ycyBkZSBsYSBnw6luw6lyYXRpb24gZHUgc291cy10aWNrZXQ6XCIsIGVycm9yKTtcbiAgICBcbiAgICAvLyBDcsOpZXIgdW4gc291cy10aWNrZXQgcGFyIGTDqWZhdXQgZW4gY2FzIGQnZXJyZXVyIGfDqW7DqXJhbGVcbiAgICBjb25zdCBmYWxsYmFja1RpY2tldCA9IHtcbiAgICAgIHRpdGxlOiBgVGlja2V0IFguWCAoQmFja2VuZCkgJHtzdWJUaWNrZXREZXNjcmlwdGlvbi5zdWJzdHJpbmcoMCwgNTApfS4uLmAsXG4gICAgICBkZXNjcmlwdGlvbjogYFNvdXMtdGlja2V0IGNyw6nDqSDDoCBwYXJ0aXIgZGU6ICR7c3ViVGlja2V0RGVzY3JpcHRpb24uc3Vic3RyaW5nKDAsIDQwMCl9YCxcbiAgICAgIHByaW9yaXR5OiAyLFxuICAgICAgc3RhdHVzOiBcIlRvIERvXCIsXG4gICAgICB2YWxpZDogdHJ1ZVxuICAgIH07XG4gICAgXG4gICAgY29uc29sZS5sb2coXCJVdGlsaXNhdGlvbiBkJ3VuIHNvdXMtdGlja2V0IGRlIHNlY291cnMgc3VpdGUgw6AgdW5lIGVycmV1clwiKTtcbiAgICByZXR1cm4gZmFsbGJhY2tUaWNrZXQ7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJHb29nbGVHZW5lcmF0aXZlQUkiLCJnZW5lcmF0ZVdpdGhHZW1pbmkiLCJwcm9tcHQiLCJnZW5BSSIsInByb2Nlc3MiLCJlbnYiLCJHT09HTEVfQUlfQVBJX0tFWSIsIm1vZGVsIiwiZ2V0R2VuZXJhdGl2ZU1vZGVsIiwicmVzdWx0IiwiZ2VuZXJhdGVDb250ZW50IiwicmVzcG9uc2UiLCJ0ZXh0IiwiZXJyb3IiLCJjb25zb2xlIiwiZW5oYW5jZVByb2plY3REZXNjcmlwdGlvbiIsInByb2plY3ROYW1lIiwiaW5zcGlyYXRpb25zIiwiZ2VuZXJhdGVGZWF0dXJlSWRlYXMiLCJwcm9qZWN0RGVzY3JpcHRpb24iLCJjb3VudCIsImZlYXR1cmVzIiwiSlNPTiIsInBhcnNlIiwibWFwIiwiZmVhdHVyZSIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJnZW5lcmF0ZVByb2plY3RUaWNrZXRzIiwianNvbk1hdGNoIiwibWF0Y2giLCJjbGVhbkpzb24iLCJ0aWNrZXRzIiwicHJvY2Vzc2VkVGlja2V0cyIsInRpY2tldCIsInN0YXR1cyIsInByaW9yaXR5IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwic3ViVGlja2V0cyIsIkFycmF5IiwiaXNBcnJheSIsInN1YlRpY2tldCIsImF1dGhBbmRQcm9maWxlRXBpY3MiLCJvdGhlckVwaWNzIiwiZm9yRWFjaCIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJwdXNoIiwiZ2VuZXJhdGVQcm9qZWN0VGlja2V0c0Zvcm1hdHRlZCIsImNyZWF0ZVByb2plY3RUaWNrZXRzSW5EQiIsInByb2plY3RJZCIsImdlbmVyYXRlZFRpY2tldHMiLCJ1c2VySWQiLCJzdXBhYmFzZUFkbWluIiwiZGF0YSIsInN0YXR1c2VzIiwic3RhdHVzRXJyb3IiLCJmcm9tIiwic2VsZWN0Iiwic3RhdHVzTWFwIiwibGVuZ3RoIiwibG9nIiwiZGVmYXVsdFN0YXR1c2VzIiwibmFtZSIsImNvbG9yIiwicG9zaXRpb24iLCJpbnNlcnQiLCJpZCIsInN0YXR1c0lkIiwiZXBpY0RhdGEiLCJlcGljRXJyb3IiLCJwcm9qZWN0X2lkIiwic3RhdHVzX2lkIiwiYXNzaWduZWRfdG8iLCJjcmVhdGVkX2J5IiwiZXBpY0lkIiwiaSIsInN1YlRpY2tldFN0YXR1c0lkIiwic3ViVGlja2V0RXJyb3IiLCJwYXJlbnRfdGlja2V0X2lkIiwiaXNfc3ViX3RpY2tldCIsImdlbmVyYXRlU3ViVGlja2V0V2l0aEFJIiwiZXBpY1RpdGxlIiwiZXBpY0Rlc2NyaXB0aW9uIiwic3ViVGlja2V0RGVzY3JpcHRpb24iLCJzdWJzdHJpbmciLCJUQVJHRVRfREVTQ1JJUFRJT05fTEVOR1RIIiwiTUFYX0RFU0NSSVBUSU9OX0xFTkdUSCIsInRyaW0iLCJqc29uU3RyIiwidGlja2V0RGF0YSIsInBhcnNlRXJyb3IiLCJjb3JyZWN0ZWRKc29uIiwicmVwbGFjZSIsInNlY29uZFBhcnNlRXJyb3IiLCJ3YXJuIiwiZXBpY051bWJlck1hdGNoIiwiZXBpY051bWJlciIsInZhbGlkIiwiZGVzY3JpcHRpb25MZW5ndGgiLCJmYWxsYmFja1RpY2tldCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/actions/gemini-integration.ts\n");

/***/ }),

/***/ "(rsc)/./app/api/auth/[...nextauth]/route.ts":
/*!*********************************************!*\
  !*** ./app/api/auth/[...nextauth]/route.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ handler),\n/* harmony export */   POST: () => (/* binding */ handler),\n/* harmony export */   authOptions: () => (/* binding */ authOptions)\n/* harmony export */ });\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth */ \"(rsc)/./node_modules/next-auth/index.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth/providers/credentials */ \"(rsc)/./node_modules/next-auth/providers/credentials.js\");\n/* harmony import */ var next_auth_providers_github__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next-auth/providers/github */ \"(rsc)/./node_modules/next-auth/providers/github.js\");\n/* harmony import */ var next_auth_providers_google__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next-auth/providers/google */ \"(rsc)/./node_modules/next-auth/providers/google.js\");\n/* harmony import */ var _lib_auth_db_queries__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/auth/db-queries */ \"(rsc)/./lib/auth/db-queries.ts\");\n\n\n\n\n\nconst authOptions = {\n    providers: [\n        (0,next_auth_providers_github__WEBPACK_IMPORTED_MODULE_2__[\"default\"])({\n            clientId: process.env.GITHUB_CLIENT_ID,\n            clientSecret: process.env.GITHUB_CLIENT_SECRET,\n            authorization: {\n                params: {\n                    redirect_uri: process.env.GITHUB_CALLBACK_URL || \"http://localhost:3000/api/auth/callback/github\"\n                }\n            }\n        }),\n        (0,next_auth_providers_google__WEBPACK_IMPORTED_MODULE_3__[\"default\"])({\n            clientId: process.env.GOOGLE_CLIENT_ID,\n            clientSecret: process.env.GOOGLE_CLIENT_SECRET,\n            authorization: {\n                params: {\n                    redirect_uri: process.env.GOOGLE_CALLBACK_URL || \"http://localhost:3000/api/auth/callback/google\"\n                }\n            }\n        }),\n        (0,next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n            name: \"Credentials\",\n            credentials: {\n                email: {\n                    label: \"Email\",\n                    type: \"email\"\n                },\n                password: {\n                    label: \"Password\",\n                    type: \"password\"\n                }\n            },\n            async authorize (credentials) {\n                if (!credentials?.email || !credentials?.password) {\n                    throw new Error(\"Email and password are required\");\n                }\n                try {\n                    const user = await (0,_lib_auth_db_queries__WEBPACK_IMPORTED_MODULE_4__.verifyUserCredentials)(credentials.email, credentials.password);\n                    return {\n                        id: user.id,\n                        email: user.email,\n                        name: user.name,\n                        image: user.image\n                    };\n                } catch (error) {\n                    // Propager l'erreur avec le message spécifique\n                    if (error instanceof Error) {\n                        throw new Error(error.message);\n                    }\n                    throw new Error(\"Authentication failed\");\n                }\n            }\n        })\n    ],\n    session: {\n        strategy: \"jwt\",\n        maxAge: 30 * 24 * 60 * 60\n    },\n    callbacks: {\n        async signIn ({ user, account, profile }) {\n            // Si l'authentification se fait via GitHub, créer ou mettre à jour l'utilisateur\n            if (account && account.provider === 'github' && profile) {\n                try {\n                    await (0,_lib_auth_db_queries__WEBPACK_IMPORTED_MODULE_4__.findOrCreateOAuthUser)(profile, 'github');\n                    return true;\n                } catch (error) {\n                    console.error('Erreur lors de la création/mise à jour de l\\'utilisateur GitHub:', error);\n                    return false;\n                }\n            }\n            // Si l'authentification se fait via Google, créer ou mettre à jour l'utilisateur\n            if (account && account.provider === 'google' && profile) {\n                try {\n                    await (0,_lib_auth_db_queries__WEBPACK_IMPORTED_MODULE_4__.findOrCreateOAuthUser)(profile, 'google');\n                    return true;\n                } catch (error) {\n                    console.error('Erreur lors de la création/mise à jour de l\\'utilisateur Google:', error);\n                    return false;\n                }\n            }\n            return true;\n        },\n        async jwt ({ token, user, account }) {\n            // Ajouter les informations utilisateur au token JWT à la connexion\n            if (user) {\n                token.id = user.id;\n                token.email = user.email;\n                token.name = user.name;\n                token.picture = user.image;\n            }\n            return token;\n        },\n        async session ({ session, token }) {\n            if (token && session.user) {\n                session.user.id = token.id;\n                session.user.email = token.email;\n                session.user.name = token.name;\n                session.user.image = token.picture;\n            }\n            return session;\n        }\n    },\n    pages: {\n        signIn: \"/login\",\n        signOut: \"/\",\n        error: \"/error\"\n    },\n    secret: process.env.NEXTAUTH_SECRET\n};\nconst handler = next_auth__WEBPACK_IMPORTED_MODULE_0___default()(authOptions);\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBaUM7QUFDaUM7QUFDVjtBQUNBO0FBQzZCO0FBSzlFLE1BQU1NLGNBQStCO0lBQzFDQyxXQUFXO1FBQ1RMLHNFQUFjQSxDQUFDO1lBQ2JNLFVBQVVDLFFBQVFDLEdBQUcsQ0FBQ0MsZ0JBQWdCO1lBQ3RDQyxjQUFjSCxRQUFRQyxHQUFHLENBQUNHLG9CQUFvQjtZQUM5Q0MsZUFBZTtnQkFDYkMsUUFBUTtvQkFDTkMsY0FBY1AsUUFBUUMsR0FBRyxDQUFDTyxtQkFBbUIsSUFBSTtnQkFDbkQ7WUFDRjtRQUNGO1FBQ0FkLHNFQUFjQSxDQUFDO1lBQ2JLLFVBQVVDLFFBQVFDLEdBQUcsQ0FBQ1EsZ0JBQWdCO1lBQ3RDTixjQUFjSCxRQUFRQyxHQUFHLENBQUNTLG9CQUFvQjtZQUM5Q0wsZUFBZTtnQkFDYkMsUUFBUTtvQkFDTkMsY0FBY1AsUUFBUUMsR0FBRyxDQUFDVSxtQkFBbUIsSUFBSTtnQkFDbkQ7WUFDRjtRQUNGO1FBQ0FuQiwyRUFBbUJBLENBQUM7WUFDbEJvQixNQUFNO1lBQ05DLGFBQWE7Z0JBQ1hDLE9BQU87b0JBQUVDLE9BQU87b0JBQVNDLE1BQU07Z0JBQVE7Z0JBQ3ZDQyxVQUFVO29CQUFFRixPQUFPO29CQUFZQyxNQUFNO2dCQUFXO1lBQ2xEO1lBQ0EsTUFBTUUsV0FBVUwsV0FBVztnQkFDekIsSUFBSSxDQUFDQSxhQUFhQyxTQUFTLENBQUNELGFBQWFJLFVBQVU7b0JBQ2pELE1BQU0sSUFBSUUsTUFBTTtnQkFDbEI7Z0JBRUEsSUFBSTtvQkFDRixNQUFNQyxPQUFPLE1BQU16QiwyRUFBcUJBLENBQ3RDa0IsWUFBWUMsS0FBSyxFQUNqQkQsWUFBWUksUUFBUTtvQkFHdEIsT0FBTzt3QkFDTEksSUFBSUQsS0FBS0MsRUFBRTt3QkFDWFAsT0FBT00sS0FBS04sS0FBSzt3QkFDakJGLE1BQU1RLEtBQUtSLElBQUk7d0JBQ2ZVLE9BQU9GLEtBQUtFLEtBQUs7b0JBQ25CO2dCQUNGLEVBQUUsT0FBT0MsT0FBTztvQkFDZCwrQ0FBK0M7b0JBQy9DLElBQUlBLGlCQUFpQkosT0FBTzt3QkFDMUIsTUFBTSxJQUFJQSxNQUFNSSxNQUFNQyxPQUFPO29CQUMvQjtvQkFDQSxNQUFNLElBQUlMLE1BQU07Z0JBQ2xCO1lBQ0Y7UUFDRjtLQUNEO0lBQ0RNLFNBQVM7UUFDUEMsVUFBVTtRQUNWQyxRQUFRLEtBQUssS0FBSyxLQUFLO0lBQ3pCO0lBQ0FDLFdBQVc7UUFDVCxNQUFNQyxRQUFPLEVBQUVULElBQUksRUFBRVUsT0FBTyxFQUFFQyxPQUFPLEVBQUU7WUFDckMsaUZBQWlGO1lBQ2pGLElBQUlELFdBQVdBLFFBQVFFLFFBQVEsS0FBSyxZQUFZRCxTQUFTO2dCQUN2RCxJQUFJO29CQUNGLE1BQU1uQywyRUFBcUJBLENBQUNtQyxTQUFTO29CQUNyQyxPQUFPO2dCQUNULEVBQUUsT0FBT1IsT0FBTztvQkFDZFUsUUFBUVYsS0FBSyxDQUFDLG9FQUFvRUE7b0JBQ2xGLE9BQU87Z0JBQ1Q7WUFDRjtZQUNBLGlGQUFpRjtZQUNqRixJQUFJTyxXQUFXQSxRQUFRRSxRQUFRLEtBQUssWUFBWUQsU0FBUztnQkFDdkQsSUFBSTtvQkFDRixNQUFNbkMsMkVBQXFCQSxDQUFDbUMsU0FBUztvQkFDckMsT0FBTztnQkFDVCxFQUFFLE9BQU9SLE9BQU87b0JBQ2RVLFFBQVFWLEtBQUssQ0FBQyxvRUFBb0VBO29CQUNsRixPQUFPO2dCQUNUO1lBQ0Y7WUFDQSxPQUFPO1FBQ1Q7UUFDQSxNQUFNVyxLQUFJLEVBQUVDLEtBQUssRUFBRWYsSUFBSSxFQUFFVSxPQUFPLEVBQUU7WUFDaEMsbUVBQW1FO1lBQ25FLElBQUlWLE1BQU07Z0JBQ1JlLE1BQU1kLEVBQUUsR0FBR0QsS0FBS0MsRUFBRTtnQkFDbEJjLE1BQU1yQixLQUFLLEdBQUdNLEtBQUtOLEtBQUs7Z0JBQ3hCcUIsTUFBTXZCLElBQUksR0FBR1EsS0FBS1IsSUFBSTtnQkFDdEJ1QixNQUFNQyxPQUFPLEdBQUdoQixLQUFLRSxLQUFLO1lBQzVCO1lBRUEsT0FBT2E7UUFDVDtRQUNBLE1BQU1WLFNBQVEsRUFBRUEsT0FBTyxFQUFFVSxLQUFLLEVBQW9DO1lBQ2hFLElBQUlBLFNBQVNWLFFBQVFMLElBQUksRUFBRTtnQkFDekJLLFFBQVFMLElBQUksQ0FBQ0MsRUFBRSxHQUFHYyxNQUFNZCxFQUFFO2dCQUMxQkksUUFBUUwsSUFBSSxDQUFDTixLQUFLLEdBQUdxQixNQUFNckIsS0FBSztnQkFDaENXLFFBQVFMLElBQUksQ0FBQ1IsSUFBSSxHQUFHdUIsTUFBTXZCLElBQUk7Z0JBQzlCYSxRQUFRTCxJQUFJLENBQUNFLEtBQUssR0FBR2EsTUFBTUMsT0FBTztZQUNwQztZQUNBLE9BQU9YO1FBQ1Q7SUFDRjtJQUNBWSxPQUFPO1FBQ0xSLFFBQVE7UUFDUlMsU0FBUztRQUNUZixPQUFPO0lBQ1Q7SUFDQWdCLFFBQVF2QyxRQUFRQyxHQUFHLENBQUN1QyxlQUFlO0FBQ3JDLEVBQUU7QUFFRixNQUFNQyxVQUFVbEQsZ0RBQVFBLENBQUNNO0FBRWtCIiwic291cmNlcyI6WyIvVXNlcnMvY2hhcmxlcy1oZW5yeW5vYWgvRGVza3RvcC92aXppb24vVml6aW9uL2FwcC9hcGkvYXV0aC9bLi4ubmV4dGF1dGhdL3JvdXRlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBOZXh0QXV0aCBmcm9tIFwibmV4dC1hdXRoXCI7XG5pbXBvcnQgQ3JlZGVudGlhbHNQcm92aWRlciBmcm9tIFwibmV4dC1hdXRoL3Byb3ZpZGVycy9jcmVkZW50aWFsc1wiO1xuaW1wb3J0IEdpdEh1YlByb3ZpZGVyIGZyb20gXCJuZXh0LWF1dGgvcHJvdmlkZXJzL2dpdGh1YlwiO1xuaW1wb3J0IEdvb2dsZVByb3ZpZGVyIGZyb20gXCJuZXh0LWF1dGgvcHJvdmlkZXJzL2dvb2dsZVwiO1xuaW1wb3J0IHsgdmVyaWZ5VXNlckNyZWRlbnRpYWxzLCBmaW5kT3JDcmVhdGVPQXV0aFVzZXIgfSBmcm9tIFwiQC9saWIvYXV0aC9kYi1xdWVyaWVzXCI7XG5pbXBvcnQgdHlwZSB7IE5leHRBdXRoT3B0aW9ucyB9IGZyb20gXCJuZXh0LWF1dGhcIjtcbmltcG9ydCB0eXBlIHsgSldUIH0gZnJvbSBcIm5leHQtYXV0aC9qd3RcIjtcbmltcG9ydCB0eXBlIHsgU2Vzc2lvbiB9IGZyb20gXCJuZXh0LWF1dGhcIjtcblxuZXhwb3J0IGNvbnN0IGF1dGhPcHRpb25zOiBOZXh0QXV0aE9wdGlvbnMgPSB7XG4gIHByb3ZpZGVyczogW1xuICAgIEdpdEh1YlByb3ZpZGVyKHtcbiAgICAgIGNsaWVudElkOiBwcm9jZXNzLmVudi5HSVRIVUJfQ0xJRU5UX0lEISxcbiAgICAgIGNsaWVudFNlY3JldDogcHJvY2Vzcy5lbnYuR0lUSFVCX0NMSUVOVF9TRUNSRVQhLFxuICAgICAgYXV0aG9yaXphdGlvbjoge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICByZWRpcmVjdF91cmk6IHByb2Nlc3MuZW52LkdJVEhVQl9DQUxMQkFDS19VUkwgfHwgXCJodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL2F1dGgvY2FsbGJhY2svZ2l0aHViXCJcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pLFxuICAgIEdvb2dsZVByb3ZpZGVyKHtcbiAgICAgIGNsaWVudElkOiBwcm9jZXNzLmVudi5HT09HTEVfQ0xJRU5UX0lEISxcbiAgICAgIGNsaWVudFNlY3JldDogcHJvY2Vzcy5lbnYuR09PR0xFX0NMSUVOVF9TRUNSRVQhLFxuICAgICAgYXV0aG9yaXphdGlvbjoge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICByZWRpcmVjdF91cmk6IHByb2Nlc3MuZW52LkdPT0dMRV9DQUxMQkFDS19VUkwgfHwgXCJodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL2F1dGgvY2FsbGJhY2svZ29vZ2xlXCJcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pLFxuICAgIENyZWRlbnRpYWxzUHJvdmlkZXIoe1xuICAgICAgbmFtZTogXCJDcmVkZW50aWFsc1wiLFxuICAgICAgY3JlZGVudGlhbHM6IHtcbiAgICAgICAgZW1haWw6IHsgbGFiZWw6IFwiRW1haWxcIiwgdHlwZTogXCJlbWFpbFwiIH0sXG4gICAgICAgIHBhc3N3b3JkOiB7IGxhYmVsOiBcIlBhc3N3b3JkXCIsIHR5cGU6IFwicGFzc3dvcmRcIiB9XG4gICAgICB9LFxuICAgICAgYXN5bmMgYXV0aG9yaXplKGNyZWRlbnRpYWxzKSB7XG4gICAgICAgIGlmICghY3JlZGVudGlhbHM/LmVtYWlsIHx8ICFjcmVkZW50aWFscz8ucGFzc3dvcmQpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFbWFpbCBhbmQgcGFzc3dvcmQgYXJlIHJlcXVpcmVkXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgdmVyaWZ5VXNlckNyZWRlbnRpYWxzKFxuICAgICAgICAgICAgY3JlZGVudGlhbHMuZW1haWwsXG4gICAgICAgICAgICBjcmVkZW50aWFscy5wYXNzd29yZFxuICAgICAgICAgICk7XG5cbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaWQ6IHVzZXIuaWQsXG4gICAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgICAgIG5hbWU6IHVzZXIubmFtZSxcbiAgICAgICAgICAgIGltYWdlOiB1c2VyLmltYWdlLFxuICAgICAgICAgIH07XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgLy8gUHJvcGFnZXIgbCdlcnJldXIgYXZlYyBsZSBtZXNzYWdlIHNww6ljaWZpcXVlXG4gICAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXV0aGVudGljYXRpb24gZmFpbGVkXCIpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcbiAgXSxcbiAgc2Vzc2lvbjoge1xuICAgIHN0cmF0ZWd5OiBcImp3dFwiIGFzIGNvbnN0LFxuICAgIG1heEFnZTogMzAgKiAyNCAqIDYwICogNjAsIC8vIDMwIGpvdXJzXG4gIH0sXG4gIGNhbGxiYWNrczoge1xuICAgIGFzeW5jIHNpZ25Jbih7IHVzZXIsIGFjY291bnQsIHByb2ZpbGUgfSkge1xuICAgICAgLy8gU2kgbCdhdXRoZW50aWZpY2F0aW9uIHNlIGZhaXQgdmlhIEdpdEh1YiwgY3LDqWVyIG91IG1ldHRyZSDDoCBqb3VyIGwndXRpbGlzYXRldXJcbiAgICAgIGlmIChhY2NvdW50ICYmIGFjY291bnQucHJvdmlkZXIgPT09ICdnaXRodWInICYmIHByb2ZpbGUpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCBmaW5kT3JDcmVhdGVPQXV0aFVzZXIocHJvZmlsZSwgJ2dpdGh1YicpO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0VycmV1ciBsb3JzIGRlIGxhIGNyw6lhdGlvbi9taXNlIMOgIGpvdXIgZGUgbFxcJ3V0aWxpc2F0ZXVyIEdpdEh1YjonLCBlcnJvcik7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvLyBTaSBsJ2F1dGhlbnRpZmljYXRpb24gc2UgZmFpdCB2aWEgR29vZ2xlLCBjcsOpZXIgb3UgbWV0dHJlIMOgIGpvdXIgbCd1dGlsaXNhdGV1clxuICAgICAgaWYgKGFjY291bnQgJiYgYWNjb3VudC5wcm92aWRlciA9PT0gJ2dvb2dsZScgJiYgcHJvZmlsZSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IGZpbmRPckNyZWF0ZU9BdXRoVXNlcihwcm9maWxlLCAnZ29vZ2xlJyk7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignRXJyZXVyIGxvcnMgZGUgbGEgY3LDqWF0aW9uL21pc2Ugw6Agam91ciBkZSBsXFwndXRpbGlzYXRldXIgR29vZ2xlOicsIGVycm9yKTtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0sXG4gICAgYXN5bmMgand0KHsgdG9rZW4sIHVzZXIsIGFjY291bnQgfSkge1xuICAgICAgLy8gQWpvdXRlciBsZXMgaW5mb3JtYXRpb25zIHV0aWxpc2F0ZXVyIGF1IHRva2VuIEpXVCDDoCBsYSBjb25uZXhpb25cbiAgICAgIGlmICh1c2VyKSB7XG4gICAgICAgIHRva2VuLmlkID0gdXNlci5pZDtcbiAgICAgICAgdG9rZW4uZW1haWwgPSB1c2VyLmVtYWlsO1xuICAgICAgICB0b2tlbi5uYW1lID0gdXNlci5uYW1lO1xuICAgICAgICB0b2tlbi5waWN0dXJlID0gdXNlci5pbWFnZTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHRva2VuO1xuICAgIH0sXG4gICAgYXN5bmMgc2Vzc2lvbih7IHNlc3Npb24sIHRva2VuIH06IHsgc2Vzc2lvbjogU2Vzc2lvbjsgdG9rZW46IEpXVCB9KSB7XG4gICAgICBpZiAodG9rZW4gJiYgc2Vzc2lvbi51c2VyKSB7XG4gICAgICAgIHNlc3Npb24udXNlci5pZCA9IHRva2VuLmlkIGFzIHN0cmluZztcbiAgICAgICAgc2Vzc2lvbi51c2VyLmVtYWlsID0gdG9rZW4uZW1haWwgYXMgc3RyaW5nO1xuICAgICAgICBzZXNzaW9uLnVzZXIubmFtZSA9IHRva2VuLm5hbWUgYXMgc3RyaW5nO1xuICAgICAgICBzZXNzaW9uLnVzZXIuaW1hZ2UgPSB0b2tlbi5waWN0dXJlIGFzIHN0cmluZztcbiAgICAgIH1cbiAgICAgIHJldHVybiBzZXNzaW9uO1xuICAgIH1cbiAgfSxcbiAgcGFnZXM6IHtcbiAgICBzaWduSW46IFwiL2xvZ2luXCIsXG4gICAgc2lnbk91dDogXCIvXCIsXG4gICAgZXJyb3I6IFwiL2Vycm9yXCIsXG4gIH0sXG4gIHNlY3JldDogcHJvY2Vzcy5lbnYuTkVYVEFVVEhfU0VDUkVULFxufTtcblxuY29uc3QgaGFuZGxlciA9IE5leHRBdXRoKGF1dGhPcHRpb25zKTtcblxuZXhwb3J0IHsgaGFuZGxlciBhcyBHRVQsIGhhbmRsZXIgYXMgUE9TVCB9O1xuIl0sIm5hbWVzIjpbIk5leHRBdXRoIiwiQ3JlZGVudGlhbHNQcm92aWRlciIsIkdpdEh1YlByb3ZpZGVyIiwiR29vZ2xlUHJvdmlkZXIiLCJ2ZXJpZnlVc2VyQ3JlZGVudGlhbHMiLCJmaW5kT3JDcmVhdGVPQXV0aFVzZXIiLCJhdXRoT3B0aW9ucyIsInByb3ZpZGVycyIsImNsaWVudElkIiwicHJvY2VzcyIsImVudiIsIkdJVEhVQl9DTElFTlRfSUQiLCJjbGllbnRTZWNyZXQiLCJHSVRIVUJfQ0xJRU5UX1NFQ1JFVCIsImF1dGhvcml6YXRpb24iLCJwYXJhbXMiLCJyZWRpcmVjdF91cmkiLCJHSVRIVUJfQ0FMTEJBQ0tfVVJMIiwiR09PR0xFX0NMSUVOVF9JRCIsIkdPT0dMRV9DTElFTlRfU0VDUkVUIiwiR09PR0xFX0NBTExCQUNLX1VSTCIsIm5hbWUiLCJjcmVkZW50aWFscyIsImVtYWlsIiwibGFiZWwiLCJ0eXBlIiwicGFzc3dvcmQiLCJhdXRob3JpemUiLCJFcnJvciIsInVzZXIiLCJpZCIsImltYWdlIiwiZXJyb3IiLCJtZXNzYWdlIiwic2Vzc2lvbiIsInN0cmF0ZWd5IiwibWF4QWdlIiwiY2FsbGJhY2tzIiwic2lnbkluIiwiYWNjb3VudCIsInByb2ZpbGUiLCJwcm92aWRlciIsImNvbnNvbGUiLCJqd3QiLCJ0b2tlbiIsInBpY3R1cmUiLCJwYWdlcyIsInNpZ25PdXQiLCJzZWNyZXQiLCJORVhUQVVUSF9TRUNSRVQiLCJoYW5kbGVyIiwiR0VUIiwiUE9TVCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/auth/[...nextauth]/route.ts\n");

/***/ }),

/***/ "(rsc)/./app/api/tickets/ai-subticket/route.ts":
/*!***********************************************!*\
  !*** ./app/api/tickets/ai-subticket/route.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _app_actions_gemini_integration__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/app/actions/gemini-integration */ \"(rsc)/./app/actions/gemini-integration.ts\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next-auth */ \"(rsc)/./node_modules/next-auth/index.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./lib/db.ts\");\n/* harmony import */ var _app_api_auth_nextauth_route__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/app/api/auth/[...nextauth]/route */ \"(rsc)/./app/api/auth/[...nextauth]/route.ts\");\n\n\n\n\n\n// Route pour générer un sous-ticket avec IA\nasync function POST(req) {\n    try {\n        console.log(\"Début du traitement de la requête API de création de sous-ticket\");\n        // Vérifier l'authentification\n        const session = await (0,next_auth__WEBPACK_IMPORTED_MODULE_2__.getServerSession)(_app_api_auth_nextauth_route__WEBPACK_IMPORTED_MODULE_4__.authOptions);\n        if (!session?.user) {\n            console.error(\"Erreur d'authentification: Utilisateur non authentifié\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Non autorisé\"\n            }, {\n                status: 401\n            });\n        }\n        console.log(\"Utilisateur authentifié:\", session.user.email);\n        // Récupérer les données de la requête\n        const requestData = await req.json();\n        console.log(\"Données reçues dans l'API de création:\", {\n            epicId: requestData.epicId,\n            epicTitle: requestData.epicTitle,\n            generatedSubTicket: requestData.generatedSubTicket ? \"présent\" : \"absent\"\n        });\n        const { epicId, epicTitle, epicDescription, subTicketDescription, generatedSubTicket } = requestData;\n        if (!epicId || !epicTitle || !subTicketDescription) {\n            console.error(\"Données manquantes:\", {\n                epicId,\n                epicTitle,\n                subTicketDescription\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"epicId, epicTitle et subTicketDescription sont requis\"\n            }, {\n                status: 400\n            });\n        }\n        // Utiliser le sous-ticket déjà généré ou en générer un nouveau\n        let ticketToCreate;\n        if (generatedSubTicket) {\n            console.log(\"Utilisation d'un sous-ticket déjà généré\");\n            ticketToCreate = generatedSubTicket;\n        } else {\n            console.log(\"Génération d'un nouveau sous-ticket avec l'IA\");\n            // Générer le sous-ticket avec l'IA\n            ticketToCreate = await (0,_app_actions_gemini_integration__WEBPACK_IMPORTED_MODULE_1__.generateSubTicketWithAI)(epicTitle, epicDescription || \"\", subTicketDescription);\n            if (!ticketToCreate) {\n                console.error(\"Échec de la génération du sous-ticket avec l'IA\");\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Erreur lors de la génération du sous-ticket\"\n                }, {\n                    status: 500\n                });\n            }\n        }\n        console.log(\"Sous-ticket à créer:\", {\n            title: ticketToCreate.title,\n            priority: ticketToCreate.priority,\n            descriptionLength: ticketToCreate.description?.length || 0\n        });\n        // Récupérer les détails du ticket parent (epic)\n        console.log(\"Récupération des détails du ticket parent (epic):\", epicId);\n        const { data: parentTicket, error: parentTicketError } = await _lib_db__WEBPACK_IMPORTED_MODULE_3__.supabaseAdmin.from(\"tickets\").select(\"id, status_id, project_id, sub_tickets_count\").eq(\"id\", epicId).single();\n        if (parentTicketError || !parentTicket) {\n            console.error(\"Ticket parent non trouvé:\", parentTicketError);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Ticket parent non trouvé\"\n            }, {\n                status: 404\n            });\n        }\n        console.log(\"Ticket parent trouvé:\", {\n            id: parentTicket.id,\n            project_id: parentTicket.project_id,\n            sub_tickets_count: parentTicket.sub_tickets_count || 0\n        });\n        // Déterminer l'index du nouveau sous-ticket\n        const subTicketsCount = parentTicket.sub_tickets_count || 0;\n        const newSubTicketIndex = subTicketsCount + 1;\n        // Ajuster le titre avec le bon numéro de sous-ticket\n        const titleWithCorrectIndex = ticketToCreate.title.replace(/\\.X\\s/i, `.${newSubTicketIndex} `);\n        console.log(\"Titre ajusté:\", titleWithCorrectIndex);\n        // Créer le sous-ticket dans la base de données\n        console.log(\"Création du sous-ticket dans la base de données\");\n        const insertData = {\n            title: titleWithCorrectIndex,\n            description: ticketToCreate.description,\n            project_id: parentTicket.project_id,\n            status_id: parentTicket.status_id,\n            priority: ticketToCreate.priority || 2,\n            position: subTicketsCount,\n            parent_ticket_id: epicId,\n            is_sub_ticket: true,\n            created_by: session.user.id\n        };\n        console.log(\"Données d'insertion:\", insertData);\n        try {\n            const { data: createdSubTicket, error } = await _lib_db__WEBPACK_IMPORTED_MODULE_3__.supabaseAdmin.from(\"tickets\").insert(insertData).select().single();\n            if (error) {\n                console.error(\"Erreur lors de la création du sous-ticket dans Supabase:\", error);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: `Erreur lors de la création du sous-ticket: ${error.message}`\n                }, {\n                    status: 500\n                });\n            }\n            if (!createdSubTicket) {\n                console.error(\"Aucun sous-ticket créé mais pas d'erreur retournée\");\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Échec de la création du sous-ticket\"\n                }, {\n                    status: 500\n                });\n            }\n            console.log(\"Sous-ticket créé avec succès:\", createdSubTicket.id);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(createdSubTicket);\n        } catch (insertError) {\n            console.error(\"Exception lors de l'insertion du sous-ticket:\", insertError);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Exception lors de la création du sous-ticket\"\n            }, {\n                status: 500\n            });\n        }\n    } catch (error) {\n        console.error(\"Exception générale dans l'API de génération de sous-ticket:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Erreur serveur\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3RpY2tldHMvYWktc3VidGlja2V0L3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBd0Q7QUFDbUI7QUFFOUI7QUFDSjtBQUN3QjtBQUVqRSw0Q0FBNEM7QUFDckMsZUFBZUssS0FBS0MsR0FBZ0I7SUFDekMsSUFBSTtRQUNGQyxRQUFRQyxHQUFHLENBQUM7UUFFWiw4QkFBOEI7UUFDOUIsTUFBTUMsVUFBVSxNQUFNUCwyREFBZ0JBLENBQUNFLHFFQUFXQTtRQUNsRCxJQUFJLENBQUNLLFNBQVNDLE1BQU07WUFDbEJILFFBQVFJLEtBQUssQ0FBQztZQUNkLE9BQU9YLHFEQUFZQSxDQUFDWSxJQUFJLENBQUM7Z0JBQUVELE9BQU87WUFBZSxHQUFHO2dCQUFFRSxRQUFRO1lBQUk7UUFDcEU7UUFFQU4sUUFBUUMsR0FBRyxDQUFDLDRCQUE0QkMsUUFBUUMsSUFBSSxDQUFDSSxLQUFLO1FBRTFELHNDQUFzQztRQUN0QyxNQUFNQyxjQUFjLE1BQU1ULElBQUlNLElBQUk7UUFDbENMLFFBQVFDLEdBQUcsQ0FBQywwQ0FBMEM7WUFDcERRLFFBQVFELFlBQVlDLE1BQU07WUFDMUJDLFdBQVdGLFlBQVlFLFNBQVM7WUFDaENDLG9CQUFvQkgsWUFBWUcsa0JBQWtCLEdBQUcsWUFBWTtRQUNuRTtRQUVBLE1BQU0sRUFBRUYsTUFBTSxFQUFFQyxTQUFTLEVBQUVFLGVBQWUsRUFBRUMsb0JBQW9CLEVBQUVGLGtCQUFrQixFQUFFLEdBQUdIO1FBRXpGLElBQUksQ0FBQ0MsVUFBVSxDQUFDQyxhQUFhLENBQUNHLHNCQUFzQjtZQUNsRGIsUUFBUUksS0FBSyxDQUFDLHVCQUF1QjtnQkFBRUs7Z0JBQVFDO2dCQUFXRztZQUFxQjtZQUMvRSxPQUFPcEIscURBQVlBLENBQUNZLElBQUksQ0FDdEI7Z0JBQUVELE9BQU87WUFBd0QsR0FDakU7Z0JBQUVFLFFBQVE7WUFBSTtRQUVsQjtRQUVBLCtEQUErRDtRQUMvRCxJQUFJUTtRQUNKLElBQUlILG9C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RyxDQUFDLGlDQUFpQ3VDLGlCQUFpQmIsRUFBRTtZQUNoRSxPQUFPbEMscURBQVlBLENBQUNZLElBQUksQ0FBQ21DO1FBQzNCLEVBQUUsT0FBT0csYUFBYTtZQUNwQjNDLFFBQVFJLEtBQUssQ0FBQyxpREFBaUR1QztZQUMvRCxPQUFPbEQscURBQVlBLENBQUNZLElBQUksQ0FDdEI7Z0JBQUVELE9BQU87WUFBK0MsR0FDeEQ7Z0JBQUVFLFFBQVE7WUFBSTtRQUVsQjtJQUNGLEVBQUUsT0FBT0YsT0FBTztRQUNkSixRQUFRSSxLQUFLLENBQUMsK0RBQStEQTtRQUM3RSxPQUFPWCxxREFBWUEsQ0FBQ1ksSUFBSSxDQUN0QjtZQUFFRCxPQUFPO1FBQWlCLEdBQzFCO1lBQUVFLFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvY2hhcmxlcy1oZW5yeW5vYWgvRGVza3RvcC92aXppb24vVml6aW9uL2FwcC9hcGkvdGlja2V0cy9haS1zdWJ0aWNrZXQvcm91dGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xuaW1wb3J0IHsgZ2VuZXJhdGVTdWJUaWNrZXRXaXRoQUkgfSBmcm9tIFwiQC9hcHAvYWN0aW9ucy9nZW1pbmktaW50ZWdyYXRpb25cIjtcbmltcG9ydCB7IGNvb2tpZXMgfSBmcm9tIFwibmV4dC9oZWFkZXJzXCI7XG5pbXBvcnQgeyBnZXRTZXJ2ZXJTZXNzaW9uIH0gZnJvbSBcIm5leHQtYXV0aFwiO1xuaW1wb3J0IHsgc3VwYWJhc2VBZG1pbiB9IGZyb20gXCJAL2xpYi9kYlwiO1xuaW1wb3J0IHsgYXV0aE9wdGlvbnMgfSBmcm9tIFwiQC9hcHAvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS9yb3V0ZVwiO1xuXG4vLyBSb3V0ZSBwb3VyIGfDqW7DqXJlciB1biBzb3VzLXRpY2tldCBhdmVjIElBXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXE6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coXCJEw6lidXQgZHUgdHJhaXRlbWVudCBkZSBsYSByZXF1w6p0ZSBBUEkgZGUgY3LDqWF0aW9uIGRlIHNvdXMtdGlja2V0XCIpO1xuICAgIFxuICAgIC8vIFbDqXJpZmllciBsJ2F1dGhlbnRpZmljYXRpb25cbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2VydmVyU2Vzc2lvbihhdXRoT3B0aW9ucyk7XG4gICAgaWYgKCFzZXNzaW9uPy51c2VyKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyZXVyIGQnYXV0aGVudGlmaWNhdGlvbjogVXRpbGlzYXRldXIgbm9uIGF1dGhlbnRpZmnDqVwiKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIk5vbiBhdXRvcmlzw6lcIiB9LCB7IHN0YXR1czogNDAxIH0pO1xuICAgIH1cbiAgICBcbiAgICBjb25zb2xlLmxvZyhcIlV0aWxpc2F0ZXVyIGF1dGhlbnRpZmnDqTpcIiwgc2Vzc2lvbi51c2VyLmVtYWlsKTtcblxuICAgIC8vIFLDqWN1cMOpcmVyIGxlcyBkb25uw6llcyBkZSBsYSByZXF1w6p0ZVxuICAgIGNvbnN0IHJlcXVlc3REYXRhID0gYXdhaXQgcmVxLmpzb24oKTtcbiAgICBjb25zb2xlLmxvZyhcIkRvbm7DqWVzIHJlw6d1ZXMgZGFucyBsJ0FQSSBkZSBjcsOpYXRpb246XCIsIHtcbiAgICAgIGVwaWNJZDogcmVxdWVzdERhdGEuZXBpY0lkLFxuICAgICAgZXBpY1RpdGxlOiByZXF1ZXN0RGF0YS5lcGljVGl0bGUsXG4gICAgICBnZW5lcmF0ZWRTdWJUaWNrZXQ6IHJlcXVlc3REYXRhLmdlbmVyYXRlZFN1YlRpY2tldCA/IFwicHLDqXNlbnRcIiA6IFwiYWJzZW50XCJcbiAgICB9KTtcbiAgICBcbiAgICBjb25zdCB7IGVwaWNJZCwgZXBpY1RpdGxlLCBlcGljRGVzY3JpcHRpb24sIHN1YlRpY2tldERlc2NyaXB0aW9uLCBnZW5lcmF0ZWRTdWJUaWNrZXQgfSA9IHJlcXVlc3REYXRhO1xuXG4gICAgaWYgKCFlcGljSWQgfHwgIWVwaWNUaXRsZSB8fCAhc3ViVGlja2V0RGVzY3JpcHRpb24pIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJEb25uw6llcyBtYW5xdWFudGVzOlwiLCB7IGVwaWNJZCwgZXBpY1RpdGxlLCBzdWJUaWNrZXREZXNjcmlwdGlvbiB9KTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogXCJlcGljSWQsIGVwaWNUaXRsZSBldCBzdWJUaWNrZXREZXNjcmlwdGlvbiBzb250IHJlcXVpc1wiIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBVdGlsaXNlciBsZSBzb3VzLXRpY2tldCBkw6lqw6AgZ8OpbsOpcsOpIG91IGVuIGfDqW7DqXJlciB1biBub3V2ZWF1XG4gICAgbGV0IHRpY2tldFRvQ3JlYXRlO1xuICAgIGlmIChnZW5lcmF0ZWRTdWJUaWNrZXQpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiVXRpbGlzYXRpb24gZCd1biBzb3VzLXRpY2tldCBkw6lqw6AgZ8OpbsOpcsOpXCIpO1xuICAgICAgdGlja2V0VG9DcmVhdGUgPSBnZW5lcmF0ZWRTdWJUaWNrZXQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiR8OpbsOpcmF0aW9uIGQndW4gbm91dmVhdSBzb3VzLXRpY2tldCBhdmVjIGwnSUFcIik7XG4gICAgICAvLyBHw6luw6lyZXIgbGUgc291cy10aWNrZXQgYXZlYyBsJ0lBXG4gICAgICB0aWNrZXRUb0NyZWF0ZSA9IGF3YWl0IGdlbmVyYXRlU3ViVGlja2V0V2l0aEFJKFxuICAgICAgICBlcGljVGl0bGUsXG4gICAgICAgIGVwaWNEZXNjcmlwdGlvbiB8fCBcIlwiLFxuICAgICAgICBzdWJUaWNrZXREZXNjcmlwdGlvblxuICAgICAgKTtcblxuICAgICAgaWYgKCF0aWNrZXRUb0NyZWF0ZSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiw4ljaGVjIGRlIGxhIGfDqW7DqXJhdGlvbiBkdSBzb3VzLXRpY2tldCBhdmVjIGwnSUFcIik7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICB7IGVycm9yOiBcIkVycmV1ciBsb3JzIGRlIGxhIGfDqW7DqXJhdGlvbiBkdSBzb3VzLXRpY2tldFwiIH0sXG4gICAgICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKFwiU291cy10aWNrZXQgw6AgY3LDqWVyOlwiLCB7XG4gICAgICB0aXRsZTogdGlja2V0VG9DcmVhdGUudGl0bGUsXG4gICAgICBwcmlvcml0eTogdGlja2V0VG9DcmVhdGUucHJpb3JpdHksXG4gICAgICBkZXNjcmlwdGlvbkxlbmd0aDogdGlja2V0VG9DcmVhdGUuZGVzY3JpcHRpb24/Lmxlbmd0aCB8fCAwXG4gICAgfSk7XG5cbiAgICAvLyBSw6ljdXDDqXJlciBsZXMgZMOpdGFpbHMgZHUgdGlja2V0IHBhcmVudCAoZXBpYylcbiAgICBjb25zb2xlLmxvZyhcIlLDqWN1cMOpcmF0aW9uIGRlcyBkw6l0YWlscyBkdSB0aWNrZXQgcGFyZW50IChlcGljKTpcIiwgZXBpY0lkKTtcbiAgICBjb25zdCB7IGRhdGE6IHBhcmVudFRpY2tldCwgZXJyb3I6IHBhcmVudFRpY2tldEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgICAuZnJvbShcInRpY2tldHNcIilcbiAgICAgIC5zZWxlY3QoXCJpZCwgc3RhdHVzX2lkLCBwcm9qZWN0X2lkLCBzdWJfdGlja2V0c19jb3VudFwiKVxuICAgICAgLmVxKFwiaWRcIiwgZXBpY0lkKVxuICAgICAgLnNpbmdsZSgpO1xuXG4gICAgaWYgKHBhcmVudFRpY2tldEVycm9yIHx8ICFwYXJlbnRUaWNrZXQpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJUaWNrZXQgcGFyZW50IG5vbiB0cm91dsOpOlwiLCBwYXJlbnRUaWNrZXRFcnJvcik7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6IFwiVGlja2V0IHBhcmVudCBub24gdHJvdXbDqVwiIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDQgfVxuICAgICAgKTtcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coXCJUaWNrZXQgcGFyZW50IHRyb3V2w6k6XCIsIHtcbiAgICAgIGlkOiBwYXJlbnRUaWNrZXQuaWQsXG4gICAgICBwcm9qZWN0X2lkOiBwYXJlbnRUaWNrZXQucHJvamVjdF9pZCxcbiAgICAgIHN1Yl90aWNrZXRzX2NvdW50OiBwYXJlbnRUaWNrZXQuc3ViX3RpY2tldHNfY291bnQgfHwgMFxuICAgIH0pO1xuXG4gICAgLy8gRMOpdGVybWluZXIgbCdpbmRleCBkdSBub3V2ZWF1IHNvdXMtdGlja2V0XG4gICAgY29uc3Qgc3ViVGlja2V0c0NvdW50ID0gcGFyZW50VGlja2V0LnN1Yl90aWNrZXRzX2NvdW50IHx8IDA7XG4gICAgY29uc3QgbmV3U3ViVGlja2V0SW5kZXggPSBzdWJUaWNrZXRzQ291bnQgKyAxO1xuXG4gICAgLy8gQWp1c3RlciBsZSB0aXRyZSBhdmVjIGxlIGJvbiBudW3DqXJvIGRlIHNvdXMtdGlja2V0XG4gICAgY29uc3QgdGl0bGVXaXRoQ29ycmVjdEluZGV4ID0gdGlja2V0VG9DcmVhdGUudGl0bGUucmVwbGFjZShcbiAgICAgIC9cXC5YXFxzL2ksXG4gICAgICBgLiR7bmV3U3ViVGlja2V0SW5kZXh9IGBcbiAgICApO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKFwiVGl0cmUgYWp1c3TDqTpcIiwgdGl0bGVXaXRoQ29ycmVjdEluZGV4KTtcblxuICAgIC8vIENyw6llciBsZSBzb3VzLXRpY2tldCBkYW5zIGxhIGJhc2UgZGUgZG9ubsOpZXNcbiAgICBjb25zb2xlLmxvZyhcIkNyw6lhdGlvbiBkdSBzb3VzLXRpY2tldCBkYW5zIGxhIGJhc2UgZGUgZG9ubsOpZXNcIik7XG4gICAgY29uc3QgaW5zZXJ0RGF0YSA9IHtcbiAgICAgIHRpdGxlOiB0aXRsZVdpdGhDb3JyZWN0SW5kZXgsXG4gICAgICBkZXNjcmlwdGlvbjogdGlja2V0VG9DcmVhdGUuZGVzY3JpcHRpb24sXG4gICAgICBwcm9qZWN0X2lkOiBwYXJlbnRUaWNrZXQucHJvamVjdF9pZCxcbiAgICAgIHN0YXR1c19pZDogcGFyZW50VGlja2V0LnN0YXR1c19pZCxcbiAgICAgIHByaW9yaXR5OiB0aWNrZXRUb0NyZWF0ZS5wcmlvcml0eSB8fCAyLFxuICAgICAgcG9zaXRpb246IHN1YlRpY2tldHNDb3VudCxcbiAgICAgIHBhcmVudF90aWNrZXRfaWQ6IGVwaWNJZCxcbiAgICAgIGlzX3N1Yl90aWNrZXQ6IHRydWUsXG4gICAgICBjcmVhdGVkX2J5OiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgfTtcbiAgICBcbiAgICBjb25zb2xlLmxvZyhcIkRvbm7DqWVzIGQnaW5zZXJ0aW9uOlwiLCBpbnNlcnREYXRhKTtcbiAgICBcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBkYXRhOiBjcmVhdGVkU3ViVGlja2V0LCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgICAgICAuZnJvbShcInRpY2tldHNcIilcbiAgICAgICAgLmluc2VydChpbnNlcnREYXRhKVxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLnNpbmdsZSgpO1xuXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycmV1ciBsb3JzIGRlIGxhIGNyw6lhdGlvbiBkdSBzb3VzLXRpY2tldCBkYW5zIFN1cGFiYXNlOlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICB7IGVycm9yOiBgRXJyZXVyIGxvcnMgZGUgbGEgY3LDqWF0aW9uIGR1IHNvdXMtdGlja2V0OiAke2Vycm9yLm1lc3NhZ2V9YCB9LFxuICAgICAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWNyZWF0ZWRTdWJUaWNrZXQpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkF1Y3VuIHNvdXMtdGlja2V0IGNyw6nDqSBtYWlzIHBhcyBkJ2VycmV1ciByZXRvdXJuw6llXCIpO1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgeyBlcnJvcjogXCLDiWNoZWMgZGUgbGEgY3LDqWF0aW9uIGR1IHNvdXMtdGlja2V0XCIgfSxcbiAgICAgICAgICB7IHN0YXR1czogNTAwIH1cbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coXCJTb3VzLXRpY2tldCBjcsOpw6kgYXZlYyBzdWNjw6hzOlwiLCBjcmVhdGVkU3ViVGlja2V0LmlkKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihjcmVhdGVkU3ViVGlja2V0KTtcbiAgICB9IGNhdGNoIChpbnNlcnRFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkV4Y2VwdGlvbiBsb3JzIGRlIGwnaW5zZXJ0aW9uIGR1IHNvdXMtdGlja2V0OlwiLCBpbnNlcnRFcnJvcik7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6IFwiRXhjZXB0aW9uIGxvcnMgZGUgbGEgY3LDqWF0aW9uIGR1IHNvdXMtdGlja2V0XCIgfSxcbiAgICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgICApO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXhjZXB0aW9uIGfDqW7DqXJhbGUgZGFucyBsJ0FQSSBkZSBnw6luw6lyYXRpb24gZGUgc291cy10aWNrZXQ6XCIsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiBcIkVycmV1ciBzZXJ2ZXVyXCIgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJnZW5lcmF0ZVN1YlRpY2tldFdpdGhBSSIsImdldFNlcnZlclNlc3Npb24iLCJzdXBhYmFzZUFkbWluIiwiYXV0aE9wdGlvbnMiLCJQT1NUIiwicmVxIiwiY29uc29sZSIsImxvZyIsInNlc3Npb24iLCJ1c2VyIiwiZXJyb3IiLCJqc29uIiwic3RhdHVzIiwiZW1haWwiLCJyZXF1ZXN0RGF0YSIsImVwaWNJZCIsImVwaWNUaXRsZSIsImdlbmVyYXRlZFN1YlRpY2tldCIsImVwaWNEZXNjcmlwdGlvbiIsInN1YlRpY2tldERlc2NyaXB0aW9uIiwidGlja2V0VG9DcmVhdGUiLCJ0aXRsZSIsInByaW9yaXR5IiwiZGVzY3JpcHRpb25MZW5ndGgiLCJkZXNjcmlwdGlvbiIsImxlbmd0aCIsImRhdGEiLCJwYXJlbnRUaWNrZXQiLCJwYXJlbnRUaWNrZXRFcnJvciIsImZyb20iLCJzZWxlY3QiLCJlcSIsInNpbmdsZSIsImlkIiwicHJvamVjdF9pZCIsInN1Yl90aWNrZXRzX2NvdW50Iiwic3ViVGlja2V0c0NvdW50IiwibmV3U3ViVGlja2V0SW5kZXgiLCJ0aXRsZVdpdGhDb3JyZWN0SW5kZXgiLCJyZXBsYWNlIiwiaW5zZXJ0RGF0YSIsInN0YXR1c19pZCIsInBvc2l0aW9uIiwicGFyZW50X3RpY2tldF9pZCIsImlzX3N1Yl90aWNrZXQiLCJjcmVhdGVkX2J5IiwiY3JlYXRlZFN1YlRpY2tldCIsImluc2VydCIsIm1lc3NhZ2UiLCJpbnNlcnRFcnJvciJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/tickets/ai-subticket/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth/db-queries.ts":
/*!********************************!*\
  !*** ./lib/auth/db-queries.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   findOrCreateOAuthUser: () => (/* binding */ findOrCreateOAuthUser),\n/* harmony export */   verifyUserCredentials: () => (/* binding */ verifyUserCredentials)\n/* harmony export */ });\n/* harmony import */ var bcrypt__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! bcrypt */ \"bcrypt\");\n/* harmony import */ var bcrypt__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(bcrypt__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\n\n// Créer le client Supabase\nconst supabaseUrl = \"https://ffwfdogonvgzudzsdcri.supabase.co\" || 0;\nconst supabaseKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZmd2Zkb2dvbnZnenVkenNkY3JpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMzMTg1MDQsImV4cCI6MjA1ODg5NDUwNH0.dfUnoBwD56sgNINPI-tLAuaMJ7PuGPuQanAJ_YrwOGI\" || 0;\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__.createClient)(supabaseUrl, supabaseKey);\n/**\n * Vérifie les identifiants de l'utilisateur pour l'authentification\n */ async function verifyUserCredentials(email, password) {\n    try {\n        console.log(`Attempting to verify credentials for email: ${email}`);\n        // Rechercher l'utilisateur par email\n        const { data, error } = await supabase.from('users').select('id, email, name, password, avatar').eq('email', email).maybeSingle(); // Using maybeSingle instead of single to avoid errors when no user is found\n        console.log('Database query result:', {\n            data,\n            error\n        });\n        if (error) {\n            console.error('Error querying user:', error);\n            throw new Error('Database error during authentication');\n        }\n        if (!data) {\n            console.log('No user found with this email');\n            throw new Error('No user found with this email');\n        }\n        // Vérifier le mot de passe\n        console.log('Comparing passwords...');\n        const passwordMatch = await (0,bcrypt__WEBPACK_IMPORTED_MODULE_0__.compare)(password, data.password);\n        console.log('Password match result:', passwordMatch);\n        if (!passwordMatch) {\n            throw new Error('Invalid credentials');\n        }\n        // Retourner les informations de l'utilisateur sans le mot de passe\n        console.log('Authentication successful for user:', data.email);\n        return {\n            id: data.id,\n            email: data.email,\n            name: data.name,\n            image: data.avatar\n        };\n    } catch (error) {\n        console.error('Authentication error:', error);\n        if (error instanceof Error) {\n            throw error; // Propager l'erreur avec le message spécifique\n        }\n        throw new Error('Authentication failed');\n    }\n}\n/**\n * Trouve ou crée un utilisateur à partir d'un profil OAuth (GitHub, Google, etc.)\n */ async function findOrCreateOAuthUser(profile, provider) {\n    try {\n        console.log('Profil OAuth reçu:', JSON.stringify(profile, null, 2));\n        console.log('Fournisseur:', provider);\n        // Vérifier que le profil contient un email\n        if (!profile.email) {\n            console.error('Profil OAuth sans email:', JSON.stringify(profile, null, 2));\n            throw new Error('Le profil OAuth ne contient pas d\\'email');\n        }\n        // Extraire les informations du profil en fonction du fournisseur\n        let userId = profile.id || profile.sub;\n        let userName = profile.name;\n        let userImage = profile.image || profile.picture || profile.avatar_url;\n        // Traitement spécifique pour Google\n        if (provider === 'google') {\n            // Pour Google, l'ID est généralement dans profile.sub\n            userId = profile.sub || userId;\n            // Google fournit souvent le nom dans des propriétés séparées\n            if (profile.given_name && profile.family_name) {\n                userName = `${profile.given_name} ${profile.family_name}`;\n            }\n            // Google fournit l'image dans profile.picture\n            userImage = profile.picture || userImage;\n            console.log('Informations extraites pour Google:', {\n                userId,\n                userName,\n                userImage,\n                email: profile.email\n            });\n        }\n        // Traitement spécifique pour GitHub\n        if (provider === 'github') {\n            // GitHub fournit l'ID dans profile.id\n            userId = profile.id || userId;\n            // GitHub fournit l'image dans profile.avatar_url\n            userImage = profile.avatar_url || userImage;\n            console.log('Informations extraites pour GitHub:', {\n                userId,\n                userName,\n                userImage,\n                email: profile.email\n            });\n        }\n        if (!userId) {\n            console.error('Aucun ID utilisateur trouvé dans le profil OAuth');\n            throw new Error('Aucun ID utilisateur trouvé dans le profil OAuth');\n        }\n        // D'abord, essayons de trouver l'utilisateur par ID\n        const { data: existingUserById, error: idSearchError } = await supabase.from('users').select('id, email, name, avatar').eq('id', userId).maybeSingle();\n        if (idSearchError) {\n            console.error('Erreur lors de la recherche de l\\'utilisateur par ID:', idSearchError);\n        }\n        // Si l'utilisateur existe par ID, le retourner immédiatement\n        if (existingUserById) {\n            console.log('Utilisateur existant trouvé par ID:', existingUserById);\n            return {\n                id: existingUserById.id,\n                email: existingUserById.email,\n                name: existingUserById.name,\n                image: existingUserById.avatar\n            };\n        }\n        // Ensuite, essayons de trouver l'utilisateur par email\n        const { data: existingUserByEmail, error: emailSearchError } = await supabase.from('users').select('id, email, name, avatar').eq('email', profile.email).maybeSingle();\n        if (emailSearchError) {\n            console.error('Erreur lors de la recherche de l\\'utilisateur par email:', emailSearchError);\n        }\n        // Si l'utilisateur existe par email, mettons à jour son ID pour correspondre à l'ID OAuth\n        if (existingUserByEmail) {\n            console.log('Utilisateur existant trouvé par email:', existingUserByEmail);\n            console.log('Mise à jour de l\\'ID utilisateur pour correspondre à l\\'ID OAuth:', userId);\n            const { data: updatedUser, error: updateError } = await supabase.from('users').update({\n                id: userId,\n                name: userName || existingUserByEmail.name,\n                avatar: userImage || existingUserByEmail.avatar\n            }).eq('id', existingUserByEmail.id).select('id, email, name, avatar').single();\n            if (updateError) {\n                console.error('Erreur lors de la mise à jour de l\\'ID utilisateur:', updateError);\n                // Si l'erreur est liée à une contrainte de clé unique, cela signifie probablement\n                // qu'un autre utilisateur avec cet ID existe déjà.\n                // Dans ce cas, utilisons l'ID existant au lieu d'essayer de le mettre à jour\n                if (updateError.code === '23505') {\n                    console.log('Un autre utilisateur existe avec cet ID OAuth, utilisation de l\\'utilisateur existant');\n                    return {\n                        id: existingUserByEmail.id,\n                        email: existingUserByEmail.email,\n                        name: existingUserByEmail.name,\n                        image: existingUserByEmail.avatar\n                    };\n                }\n                throw updateError;\n            }\n            console.log('ID utilisateur mis à jour avec l\\'ID OAuth:', updatedUser);\n            return {\n                id: updatedUser.id,\n                email: updatedUser.email,\n                name: updatedUser.name,\n                image: updatedUser.avatar\n            };\n        }\n        // Si l'utilisateur n'existe pas du tout, créons-le\n        console.log('Création d\\'un nouvel utilisateur OAuth avec les données:', {\n            id: userId,\n            email: profile.email,\n            name: userName,\n            avatar: userImage,\n            provider\n        });\n        const { data: newUser, error: createError } = await supabase.from('users').insert({\n            id: userId,\n            email: profile.email,\n            name: userName || `${provider} User`,\n            avatar: userImage || null,\n            password: null,\n            is_active: true\n        }).select('id, email, name, avatar').single();\n        if (createError) {\n            console.error('Erreur lors de la création de l\\'utilisateur:', createError);\n            throw createError;\n        }\n        console.log('Nouvel utilisateur créé avec succès:', newUser);\n        return {\n            id: newUser.id,\n            email: newUser.email,\n            name: newUser.name,\n            image: newUser.avatar\n        };\n    } catch (error) {\n        console.error('Erreur dans findOrCreateOAuthUser:', error);\n        throw error;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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M0I7UUFDRjtRQUVBLG1EQUFtRDtRQUNuRGIsUUFBUUMsR0FBRyxDQUFDLDZEQUE2RDtZQUN2RVMsSUFBSVM7WUFDSnJCLE9BQU9pQixRQUFRakIsS0FBSztZQUNwQmEsTUFBTVU7WUFDTlIsUUFBUVM7WUFDUk47UUFDRjtRQUVBLE1BQU0sRUFBRWQsTUFBTWtDLE9BQU8sRUFBRWpDLE9BQU9rQyxXQUFXLEVBQUUsR0FBRyxNQUFNekMsU0FDakRRLElBQUksQ0FBQyxTQUNMa0MsTUFBTSxDQUFDO1lBQ041QixJQUFJUztZQUNKckIsT0FBT2lCLFFBQVFqQixLQUFLO1lBQ3BCYSxNQUFNVSxZQUFZLEdBQUdMLFNBQVMsS0FBSyxDQUFDO1lBQ3BDSCxRQUFRUyxhQUFhO1lBQ3JCdkIsVUFBVTtZQUNWd0MsV0FBVztRQUNiLEdBQ0NsQyxNQUFNLENBQUMsMkJBQ1A2QixNQUFNO1FBRVQsSUFBSUcsYUFBYTtZQUNmckMsUUFBUUcsS0FBSyxDQUFDLGlEQUFpRGtDO1lBQy9ELE1BQU1BO1FBQ1I7UUFFQXJDLFFBQVFDLEdBQUcsQ0FBQyx3Q0FBd0NtQztRQUNwRCxPQUFPO1lBQ0wxQixJQUFJMEIsUUFBUTFCLEVBQUU7WUFDZFosT0FBT3NDLFFBQVF0QyxLQUFLO1lBQ3BCYSxNQUFNeUIsUUFBUXpCLElBQUk7WUFDbEJDLE9BQU93QixRQUFRdkIsTUFBTTtRQUN2QjtJQUNGLEVBQUUsT0FBT1YsT0FBTztRQUNkSCxRQUFRRyxLQUFLLENBQUMsc0NBQXNDQTtRQUNwRCxNQUFNQTtJQUNSO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9jaGFybGVzLWhlbnJ5bm9haC9EZXNrdG9wL3Zpemlvbi9WaXppb24vbGliL2F1dGgvZGItcXVlcmllcy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjb21wYXJlIH0gZnJvbSAnYmNyeXB0JztcbmltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcyc7XG5cbi8vIENyw6llciBsZSBjbGllbnQgU3VwYWJhc2VcbmNvbnN0IHN1cGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIHx8ICcnO1xuY29uc3Qgc3VwYWJhc2VLZXkgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSB8fCAnJztcbmNvbnN0IHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZUtleSk7XG5cbi8qKlxuICogVsOpcmlmaWUgbGVzIGlkZW50aWZpYW50cyBkZSBsJ3V0aWxpc2F0ZXVyIHBvdXIgbCdhdXRoZW50aWZpY2F0aW9uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2ZXJpZnlVc2VyQ3JlZGVudGlhbHMoZW1haWw6IHN0cmluZywgcGFzc3dvcmQ6IHN0cmluZykge1xuICB0cnkge1xuICAgIGNvbnNvbGUubG9nKGBBdHRlbXB0aW5nIHRvIHZlcmlmeSBjcmVkZW50aWFscyBmb3IgZW1haWw6ICR7ZW1haWx9YCk7XG4gICAgXG4gICAgLy8gUmVjaGVyY2hlciBsJ3V0aWxpc2F0ZXVyIHBhciBlbWFpbFxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgndXNlcnMnKVxuICAgICAgLnNlbGVjdCgnaWQsIGVtYWlsLCBuYW1lLCBwYXNzd29yZCwgYXZhdGFyJylcbiAgICAgIC5lcSgnZW1haWwnLCBlbWFpbClcbiAgICAgIC5tYXliZVNpbmdsZSgpOyAvLyBVc2luZyBtYXliZVNpbmdsZSBpbnN0ZWFkIG9mIHNpbmdsZSB0byBhdm9pZCBlcnJvcnMgd2hlbiBubyB1c2VyIGlzIGZvdW5kXG4gICAgXG4gICAgY29uc29sZS5sb2coJ0RhdGFiYXNlIHF1ZXJ5IHJlc3VsdDonLCB7IGRhdGEsIGVycm9yIH0pO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBxdWVyeWluZyB1c2VyOicsIGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRGF0YWJhc2UgZXJyb3IgZHVyaW5nIGF1dGhlbnRpY2F0aW9uJyk7XG4gICAgfVxuXG4gICAgaWYgKCFkYXRhKSB7XG4gICAgICBjb25zb2xlLmxvZygnTm8gdXNlciBmb3VuZCB3aXRoIHRoaXMgZW1haWwnKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gdXNlciBmb3VuZCB3aXRoIHRoaXMgZW1haWwnKTtcbiAgICB9XG5cbiAgICAvLyBWw6lyaWZpZXIgbGUgbW90IGRlIHBhc3NlXG4gICAgY29uc29sZS5sb2coJ0NvbXBhcmluZyBwYXNzd29yZHMuLi4nKTtcbiAgICBjb25zdCBwYXNzd29yZE1hdGNoID0gYXdhaXQgY29tcGFyZShwYXNzd29yZCwgZGF0YS5wYXNzd29yZCk7XG4gICAgY29uc29sZS5sb2coJ1Bhc3N3b3JkIG1hdGNoIHJlc3VsdDonLCBwYXNzd29yZE1hdGNoKTtcbiAgICBcbiAgICBpZiAoIXBhc3N3b3JkTWF0Y2gpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBjcmVkZW50aWFscycpO1xuICAgIH1cblxuICAgIC8vIFJldG91cm5lciBsZXMgaW5mb3JtYXRpb25zIGRlIGwndXRpbGlzYXRldXIgc2FucyBsZSBtb3QgZGUgcGFzc2VcbiAgICBjb25zb2xlLmxvZygnQXV0aGVudGljYXRpb24gc3VjY2Vzc2Z1bCBmb3IgdXNlcjonLCBkYXRhLmVtYWlsKTtcbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IGRhdGEuaWQsXG4gICAgICBlbWFpbDogZGF0YS5lbWFpbCxcbiAgICAgIG5hbWU6IGRhdGEubmFtZSxcbiAgICAgIGltYWdlOiBkYXRhLmF2YXRhclxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignQXV0aGVudGljYXRpb24gZXJyb3I6JywgZXJyb3IpO1xuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICB0aHJvdyBlcnJvcjsgLy8gUHJvcGFnZXIgbCdlcnJldXIgYXZlYyBsZSBtZXNzYWdlIHNww6ljaWZpcXVlXG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcignQXV0aGVudGljYXRpb24gZmFpbGVkJyk7XG4gIH1cbn1cblxuLyoqXG4gKiBUcm91dmUgb3UgY3LDqWUgdW4gdXRpbGlzYXRldXIgw6AgcGFydGlyIGQndW4gcHJvZmlsIE9BdXRoIChHaXRIdWIsIEdvb2dsZSwgZXRjLilcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZpbmRPckNyZWF0ZU9BdXRoVXNlcihwcm9maWxlOiBhbnksIHByb3ZpZGVyOiBzdHJpbmcpIHtcbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZygnUHJvZmlsIE9BdXRoIHJlw6d1OicsIEpTT04uc3RyaW5naWZ5KHByb2ZpbGUsIG51bGwsIDIpKTtcbiAgICBjb25zb2xlLmxvZygnRm91cm5pc3NldXI6JywgcHJvdmlkZXIpO1xuICAgIFxuICAgIC8vIFbDqXJpZmllciBxdWUgbGUgcHJvZmlsIGNvbnRpZW50IHVuIGVtYWlsXG4gICAgaWYgKCFwcm9maWxlLmVtYWlsKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdQcm9maWwgT0F1dGggc2FucyBlbWFpbDonLCBKU09OLnN0cmluZ2lmeShwcm9maWxlLCBudWxsLCAyKSk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0xlIHByb2ZpbCBPQXV0aCBuZSBjb250aWVudCBwYXMgZFxcJ2VtYWlsJyk7XG4gICAgfVxuXG4gICAgLy8gRXh0cmFpcmUgbGVzIGluZm9ybWF0aW9ucyBkdSBwcm9maWwgZW4gZm9uY3Rpb24gZHUgZm91cm5pc3NldXJcbiAgICBsZXQgdXNlcklkID0gcHJvZmlsZS5pZCB8fCBwcm9maWxlLnN1YjtcbiAgICBsZXQgdXNlck5hbWUgPSBwcm9maWxlLm5hbWU7XG4gICAgbGV0IHVzZXJJbWFnZSA9IHByb2ZpbGUuaW1hZ2UgfHwgcHJvZmlsZS5waWN0dXJlIHx8IHByb2ZpbGUuYXZhdGFyX3VybDtcbiAgICBcbiAgICAvLyBUcmFpdGVtZW50IHNww6ljaWZpcXVlIHBvdXIgR29vZ2xlXG4gICAgaWYgKHByb3ZpZGVyID09PSAnZ29vZ2xlJykge1xuICAgICAgLy8gUG91ciBHb29nbGUsIGwnSUQgZXN0IGfDqW7DqXJhbGVtZW50IGRhbnMgcHJvZmlsZS5zdWJcbiAgICAgIHVzZXJJZCA9IHByb2ZpbGUuc3ViIHx8IHVzZXJJZDtcbiAgICAgIC8vIEdvb2dsZSBmb3Vybml0IHNvdXZlbnQgbGUgbm9tIGRhbnMgZGVzIHByb3ByacOpdMOpcyBzw6lwYXLDqWVzXG4gICAgICBpZiAocHJvZmlsZS5naXZlbl9uYW1lICYmIHByb2ZpbGUuZmFtaWx5X25hbWUpIHtcbiAgICAgICAgdXNlck5hbWUgPSBgJHtwcm9maWxlLmdpdmVuX25hbWV9ICR7cHJvZmlsZS5mYW1pbHlfbmFtZX1gO1xuICAgICAgfVxuICAgICAgLy8gR29vZ2xlIGZvdXJuaXQgbCdpbWFnZSBkYW5zIHByb2ZpbGUucGljdHVyZVxuICAgICAgdXNlckltYWdlID0gcHJvZmlsZS5waWN0dXJlIHx8IHVzZXJJbWFnZTtcbiAgICAgIGNvbnNvbGUubG9nKCdJbmZvcm1hdGlvbnMgZXh0cmFpdGVzIHBvdXIgR29vZ2xlOicsIHsgdXNlcklkLCB1c2VyTmFtZSwgdXNlckltYWdlLCBlbWFpbDogcHJvZmlsZS5lbWFpbCB9KTtcbiAgICB9XG4gICAgXG4gICAgLy8gVHJhaXRlbWVudCBzcMOpY2lmaXF1ZSBwb3VyIEdpdEh1YlxuICAgIGlmIChwcm92aWRlciA9PT0gJ2dpdGh1YicpIHtcbiAgICAgIC8vIEdpdEh1YiBmb3Vybml0IGwnSUQgZGFucyBwcm9maWxlLmlkXG4gICAgICB1c2VySWQgPSBwcm9maWxlLmlkIHx8IHVzZXJJZDtcbiAgICAgIC8vIEdpdEh1YiBmb3Vybml0IGwnaW1hZ2UgZGFucyBwcm9maWxlLmF2YXRhcl91cmxcbiAgICAgIHVzZXJJbWFnZSA9IHByb2ZpbGUuYXZhdGFyX3VybCB8fCB1c2VySW1hZ2U7XG4gICAgICBjb25zb2xlLmxvZygnSW5mb3JtYXRpb25zIGV4dHJhaXRlcyBwb3VyIEdpdEh1YjonLCB7IHVzZXJJZCwgdXNlck5hbWUsIHVzZXJJbWFnZSwgZW1haWw6IHByb2ZpbGUuZW1haWwgfSk7XG4gICAgfVxuXG4gICAgaWYgKCF1c2VySWQpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0F1Y3VuIElEIHV0aWxpc2F0ZXVyIHRyb3V2w6kgZGFucyBsZSBwcm9maWwgT0F1dGgnKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQXVjdW4gSUQgdXRpbGlzYXRldXIgdHJvdXbDqSBkYW5zIGxlIHByb2ZpbCBPQXV0aCcpO1xuICAgIH1cblxuICAgIC8vIEQnYWJvcmQsIGVzc2F5b25zIGRlIHRyb3V2ZXIgbCd1dGlsaXNhdGV1ciBwYXIgSURcbiAgICBjb25zdCB7IGRhdGE6IGV4aXN0aW5nVXNlckJ5SWQsIGVycm9yOiBpZFNlYXJjaEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3VzZXJzJylcbiAgICAgIC5zZWxlY3QoJ2lkLCBlbWFpbCwgbmFtZSwgYXZhdGFyJylcbiAgICAgIC5lcSgnaWQnLCB1c2VySWQpXG4gICAgICAubWF5YmVTaW5nbGUoKTtcblxuICAgIGlmIChpZFNlYXJjaEVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJldXIgbG9ycyBkZSBsYSByZWNoZXJjaGUgZGUgbFxcJ3V0aWxpc2F0ZXVyIHBhciBJRDonLCBpZFNlYXJjaEVycm9yKTtcbiAgICB9XG5cbiAgICAvLyBTaSBsJ3V0aWxpc2F0ZXVyIGV4aXN0ZSBwYXIgSUQsIGxlIHJldG91cm5lciBpbW3DqWRpYXRlbWVudFxuICAgIGlmIChleGlzdGluZ1VzZXJCeUlkKSB7XG4gICAgICBjb25zb2xlLmxvZygnVXRpbGlzYXRldXIgZXhpc3RhbnQgdHJvdXbDqSBwYXIgSUQ6JywgZXhpc3RpbmdVc2VyQnlJZCk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBpZDogZXhpc3RpbmdVc2VyQnlJZC5pZCxcbiAgICAgICAgZW1haWw6IGV4aXN0aW5nVXNlckJ5SWQuZW1haWwsXG4gICAgICAgIG5hbWU6IGV4aXN0aW5nVXNlckJ5SWQubmFtZSxcbiAgICAgICAgaW1hZ2U6IGV4aXN0aW5nVXNlckJ5SWQuYXZhdGFyXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIEVuc3VpdGUsIGVzc2F5b25zIGRlIHRyb3V2ZXIgbCd1dGlsaXNhdGV1ciBwYXIgZW1haWxcbiAgICBjb25zdCB7IGRhdGE6IGV4aXN0aW5nVXNlckJ5RW1haWwsIGVycm9yOiBlbWFpbFNlYXJjaEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3VzZXJzJylcbiAgICAgIC5zZWxlY3QoJ2lkLCBlbWFpbCwgbmFtZSwgYXZhdGFyJylcbiAgICAgIC5lcSgnZW1haWwnLCBwcm9maWxlLmVtYWlsKVxuICAgICAgLm1heWJlU2luZ2xlKCk7XG5cbiAgICBpZiAoZW1haWxTZWFyY2hFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyZXVyIGxvcnMgZGUgbGEgcmVjaGVyY2hlIGRlIGxcXCd1dGlsaXNhdGV1ciBwYXIgZW1haWw6JywgZW1haWxTZWFyY2hFcnJvcik7XG4gICAgfVxuXG4gICAgLy8gU2kgbCd1dGlsaXNhdGV1ciBleGlzdGUgcGFyIGVtYWlsLCBtZXR0b25zIMOgIGpvdXIgc29uIElEIHBvdXIgY29ycmVzcG9uZHJlIMOgIGwnSUQgT0F1dGhcbiAgICBpZiAoZXhpc3RpbmdVc2VyQnlFbWFpbCkge1xuICAgICAgY29uc29sZS5sb2coJ1V0aWxpc2F0ZXVyIGV4aXN0YW50IHRyb3V2w6kgcGFyIGVtYWlsOicsIGV4aXN0aW5nVXNlckJ5RW1haWwpO1xuICAgICAgY29uc29sZS5sb2coJ01pc2Ugw6Agam91ciBkZSBsXFwnSUQgdXRpbGlzYXRldXIgcG91ciBjb3JyZXNwb25kcmUgw6AgbFxcJ0lEIE9BdXRoOicsIHVzZXJJZCk7XG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGF0YTogdXBkYXRlZFVzZXIsIGVycm9yOiB1cGRhdGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3VzZXJzJylcbiAgICAgICAgLnVwZGF0ZSh7XG4gICAgICAgICAgaWQ6IHVzZXJJZCxcbiAgICAgICAgICBuYW1lOiB1c2VyTmFtZSB8fCBleGlzdGluZ1VzZXJCeUVtYWlsLm5hbWUsXG4gICAgICAgICAgYXZhdGFyOiB1c2VySW1hZ2UgfHwgZXhpc3RpbmdVc2VyQnlFbWFpbC5hdmF0YXJcbiAgICAgICAgfSlcbiAgICAgICAgLmVxKCdpZCcsIGV4aXN0aW5nVXNlckJ5RW1haWwuaWQpXG4gICAgICAgIC5zZWxlY3QoJ2lkLCBlbWFpbCwgbmFtZSwgYXZhdGFyJylcbiAgICAgICAgLnNpbmdsZSgpO1xuICAgICAgICBcbiAgICAgIGlmICh1cGRhdGVFcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJldXIgbG9ycyBkZSBsYSBtaXNlIMOgIGpvdXIgZGUgbFxcJ0lEIHV0aWxpc2F0ZXVyOicsIHVwZGF0ZUVycm9yKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFNpIGwnZXJyZXVyIGVzdCBsacOpZSDDoCB1bmUgY29udHJhaW50ZSBkZSBjbMOpIHVuaXF1ZSwgY2VsYSBzaWduaWZpZSBwcm9iYWJsZW1lbnRcbiAgICAgICAgLy8gcXUndW4gYXV0cmUgdXRpbGlzYXRldXIgYXZlYyBjZXQgSUQgZXhpc3RlIGTDqWrDoC5cbiAgICAgICAgLy8gRGFucyBjZSBjYXMsIHV0aWxpc29ucyBsJ0lEIGV4aXN0YW50IGF1IGxpZXUgZCdlc3NheWVyIGRlIGxlIG1ldHRyZSDDoCBqb3VyXG4gICAgICAgIGlmICh1cGRhdGVFcnJvci5jb2RlID09PSAnMjM1MDUnKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1VuIGF1dHJlIHV0aWxpc2F0ZXVyIGV4aXN0ZSBhdmVjIGNldCBJRCBPQXV0aCwgdXRpbGlzYXRpb24gZGUgbFxcJ3V0aWxpc2F0ZXVyIGV4aXN0YW50Jyk7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlkOiBleGlzdGluZ1VzZXJCeUVtYWlsLmlkLFxuICAgICAgICAgICAgZW1haWw6IGV4aXN0aW5nVXNlckJ5RW1haWwuZW1haWwsXG4gICAgICAgICAgICBuYW1lOiBleGlzdGluZ1VzZXJCeUVtYWlsLm5hbWUsXG4gICAgICAgICAgICBpbWFnZTogZXhpc3RpbmdVc2VyQnlFbWFpbC5hdmF0YXJcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB0aHJvdyB1cGRhdGVFcnJvcjtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coJ0lEIHV0aWxpc2F0ZXVyIG1pcyDDoCBqb3VyIGF2ZWMgbFxcJ0lEIE9BdXRoOicsIHVwZGF0ZWRVc2VyKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlkOiB1cGRhdGVkVXNlci5pZCxcbiAgICAgICAgZW1haWw6IHVwZGF0ZWRVc2VyLmVtYWlsLFxuICAgICAgICBuYW1lOiB1cGRhdGVkVXNlci5uYW1lLFxuICAgICAgICBpbWFnZTogdXBkYXRlZFVzZXIuYXZhdGFyXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIFNpIGwndXRpbGlzYXRldXIgbidleGlzdGUgcGFzIGR1IHRvdXQsIGNyw6lvbnMtbGVcbiAgICBjb25zb2xlLmxvZygnQ3LDqWF0aW9uIGRcXCd1biBub3V2ZWwgdXRpbGlzYXRldXIgT0F1dGggYXZlYyBsZXMgZG9ubsOpZXM6Jywge1xuICAgICAgaWQ6IHVzZXJJZCxcbiAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsLFxuICAgICAgbmFtZTogdXNlck5hbWUsXG4gICAgICBhdmF0YXI6IHVzZXJJbWFnZSxcbiAgICAgIHByb3ZpZGVyXG4gICAgfSk7XG5cbiAgICBjb25zdCB7IGRhdGE6IG5ld1VzZXIsIGVycm9yOiBjcmVhdGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCd1c2VycycpXG4gICAgICAuaW5zZXJ0KHtcbiAgICAgICAgaWQ6IHVzZXJJZCxcbiAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gICAgICAgIG5hbWU6IHVzZXJOYW1lIHx8IGAke3Byb3ZpZGVyfSBVc2VyYCxcbiAgICAgICAgYXZhdGFyOiB1c2VySW1hZ2UgfHwgbnVsbCxcbiAgICAgICAgcGFzc3dvcmQ6IG51bGwsXG4gICAgICAgIGlzX2FjdGl2ZTogdHJ1ZVxuICAgICAgfSlcbiAgICAgIC5zZWxlY3QoJ2lkLCBlbWFpbCwgbmFtZSwgYXZhdGFyJylcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIGlmIChjcmVhdGVFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyZXVyIGxvcnMgZGUgbGEgY3LDqWF0aW9uIGRlIGxcXCd1dGlsaXNhdGV1cjonLCBjcmVhdGVFcnJvcik7XG4gICAgICB0aHJvdyBjcmVhdGVFcnJvcjtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZygnTm91dmVsIHV0aWxpc2F0ZXVyIGNyw6nDqSBhdmVjIHN1Y2PDqHM6JywgbmV3VXNlcik7XG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiBuZXdVc2VyLmlkLFxuICAgICAgZW1haWw6IG5ld1VzZXIuZW1haWwsXG4gICAgICBuYW1lOiBuZXdVc2VyLm5hbWUsXG4gICAgICBpbWFnZTogbmV3VXNlci5hdmF0YXJcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0VycmV1ciBkYW5zIGZpbmRPckNyZWF0ZU9BdXRoVXNlcjonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn0iXSwibmFtZXMiOlsiY29tcGFyZSIsImNyZWF0ZUNsaWVudCIsInN1cGFiYXNlVXJsIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsInN1cGFiYXNlS2V5IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJzdXBhYmFzZSIsInZlcmlmeVVzZXJDcmVkZW50aWFscyIsImVtYWlsIiwicGFzc3dvcmQiLCJjb25zb2xlIiwibG9nIiwiZGF0YSIsImVycm9yIiwiZnJvbSIsInNlbGVjdCIsImVxIiwibWF5YmVTaW5nbGUiLCJFcnJvciIsInBhc3N3b3JkTWF0Y2giLCJpZCIsIm5hbWUiLCJpbWFnZSIsImF2YXRhciIsImZpbmRPckNyZWF0ZU9BdXRoVXNlciIsInByb2ZpbGUiLCJwcm92aWRlciIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1c2VySWQiLCJzdWIiLCJ1c2VyTmFtZSIsInVzZXJJbWFnZSIsInBpY3R1cmUiLCJhdmF0YXJfdXJsIiwiZ2l2ZW5fbmFtZSIsImZhbWlseV9uYW1lIiwiZXhpc3RpbmdVc2VyQnlJZCIsImlkU2VhcmNoRXJyb3IiLCJleGlzdGluZ1VzZXJCeUVtYWlsIiwiZW1haWxTZWFyY2hFcnJvciIsInVwZGF0ZWRVc2VyIiwidXBkYXRlRXJyb3IiLCJ1cGRhdGUiLCJzaW5nbGUiLCJjb2RlIiwibmV3VXNlciIsImNyZWF0ZUVycm9yIiwiaW5zZXJ0IiwiaXNfYWN0aXZlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth/db-queries.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db.ts":
/*!*******************!*\
  !*** ./lib/db.ts ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   db: () => (/* binding */ db),\n/* harmony export */   supabase: () => (/* binding */ supabase),\n/* harmony export */   supabaseAdmin: () => (/* binding */ supabaseAdmin)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n/* harmony import */ var drizzle_orm_postgres_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! drizzle-orm/postgres-js */ \"(rsc)/./node_modules/drizzle-orm/postgres-js/driver.js\");\n/* harmony import */ var postgres__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! postgres */ \"(rsc)/./node_modules/postgres/src/index.js\");\n\n\n\n// Read Supabase credentials from environment variables\nconst supabaseUrl = \"https://ffwfdogonvgzudzsdcri.supabase.co\";\nconst supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZmd2Zkb2dvbnZnenVkenNkY3JpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMzMTg1MDQsImV4cCI6MjA1ODg5NDUwNH0.dfUnoBwD56sgNINPI-tLAuaMJ7PuGPuQanAJ_YrwOGI\";\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_KEY;\n// Basic check to ensure environment variables are set\nif (!supabaseUrl) {\n    throw new Error(\"Supabase URL not found. Make sure NEXT_PUBLIC_SUPABASE_URL is set in your .env file.\");\n}\nif (!supabaseAnonKey) {\n    throw new Error(\"Supabase Anon Key not found. Make sure NEXT_PUBLIC_SUPABASE_ANON_KEY is set in your .env file.\");\n}\n// Create and export the Supabase client instance with anonymous key (for client-side)\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__.createClient)(supabaseUrl, supabaseAnonKey);\n// Create a Supabase client with service role key for server-side operations that need elevated privileges\nconst supabaseAdmin = supabaseServiceKey ? (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__.createClient)(supabaseUrl, supabaseServiceKey) : supabase;\n// Configuration pour Drizzle ORM avec PostgreSQL\nlet db;\n// Fonction pour configurer Drizzle\nfunction setupDrizzle() {\n    const databaseUrl = process.env.DATABASE_URL;\n    if (!databaseUrl) {\n        console.error(\"DATABASE_URL is not defined in environment variables\");\n        throw new Error(\"DATABASE_URL is not defined in environment variables\");\n    }\n    try {\n        // Créer un client PostgreSQL avec des options de connexion robustes\n        const client = (0,postgres__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(databaseUrl, {\n            max: 10,\n            idle_timeout: 20,\n            connect_timeout: 30,\n            prepare: false\n        });\n        // Créer une instance Drizzle\n        return (0,drizzle_orm_postgres_js__WEBPACK_IMPORTED_MODULE_2__.drizzle)(client);\n    } catch (error) {\n        console.error(\"Erreur lors de la configuration de Drizzle:\", error);\n        throw error;\n    }\n}\n// Initialiser Drizzle en environnement serveur uniquement\nif (true) {\n    try {\n        db = setupDrizzle();\n    } catch (error) {\n        console.error(\"Erreur lors de l'initialisation de Drizzle:\", error);\n        // Fournir une instance factice pour éviter les erreurs côté serveur\n        db = {};\n    }\n} else {}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQXFEO0FBQ0g7QUFDbEI7QUFFaEMsdURBQXVEO0FBQ3ZELE1BQU1HLGNBQWNDLDBDQUFvQztBQUN4RCxNQUFNRyxrQkFBa0JILGtOQUF5QztBQUNqRSxNQUFNSyxxQkFBcUJMLFFBQVFDLEdBQUcsQ0FBQ0ssb0JBQW9CO0FBRTNELHNEQUFzRDtBQUN0RCxJQUFJLENBQUNQLGFBQWE7SUFDaEIsTUFBTSxJQUFJUSxNQUFNO0FBQ2xCO0FBQ0EsSUFBSSxDQUFDSixpQkFBaUI7SUFDcEIsTUFBTSxJQUFJSSxNQUFNO0FBQ2xCO0FBRUEsc0ZBQXNGO0FBQy9FLE1BQU1DLFdBQVdaLG1FQUFZQSxDQUFDRyxhQUFhSSxpQkFBaUI7QUFFbkUsMEdBQTBHO0FBQ25HLE1BQU1NLGdCQUFnQkoscUJBQ3pCVCxtRUFBWUEsQ0FBQ0csYUFBYU0sc0JBQzFCRyxTQUFTO0FBRWIsaURBQWlEO0FBQ2pELElBQUlFO0FBRUosbUNBQW1DO0FBQ25DLFNBQVNDO0lBQ1AsTUFBTUMsY0FBY1osUUFBUUMsR0FBRyxDQUFDWSxZQUFZO0lBRTVDLElBQUksQ0FBQ0QsYUFBYTtRQUNoQkUsUUFBUUMsS0FBSyxDQUFDO1FBQ2QsTUFBTSxJQUFJUixNQUFNO0lBQ2xCO0lBRUEsSUFBSTtRQUNGLG9FQUFvRTtRQUNwRSxNQUFNUyxTQUFTbEIsb0RBQVFBLENBQUNjLGFBQWE7WUFDbkNLLEtBQUs7WUFDTEMsY0FBYztZQUNkQyxpQkFBaUI7WUFDakJDLFNBQVM7UUFDWDtRQUVBLDZCQUE2QjtRQUM3QixPQUFPdkIsZ0VBQU9BLENBQUNtQjtJQUNqQixFQUFFLE9BQU9ELE9BQU87UUFDZEQsUUFBUUMsS0FBSyxDQUFDLCtDQUErQ0E7UUFDN0QsTUFBTUE7SUFDUjtBQUNGO0FBRUEsMERBQTBEO0FBQzFELElBQUksSUFBNkIsRUFBRTtJQUNqQyxJQUFJO1FBQ0ZMLEtBQUtDO0lBQ1AsRUFBRSxPQUFPSSxPQUFPO1FBQ2RELFFBQVFDLEtBQUssQ0FBQywrQ0FBK0NBO1FBQzdELG9FQUFvRTtRQUNwRUwsS0FBSyxDQUFDO0lBQ1I7QUFDRixPQUFPLEVBR047QUFFYSIsInNvdXJjZXMiOlsiL1VzZXJzL2NoYXJsZXMtaGVucnlub2FoL0Rlc2t0b3Avdml6aW9uL1Zpemlvbi9saWIvZGIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJztcbmltcG9ydCB7IGRyaXp6bGUgfSBmcm9tICdkcml6emxlLW9ybS9wb3N0Z3Jlcy1qcyc7XG5pbXBvcnQgcG9zdGdyZXMgZnJvbSAncG9zdGdyZXMnO1xuXG4vLyBSZWFkIFN1cGFiYXNlIGNyZWRlbnRpYWxzIGZyb20gZW52aXJvbm1lbnQgdmFyaWFibGVzXG5jb25zdCBzdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTDtcbmNvbnN0IHN1cGFiYXNlQW5vbktleSA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZO1xuY29uc3Qgc3VwYWJhc2VTZXJ2aWNlS2V5ID0gcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9LRVk7XG5cbi8vIEJhc2ljIGNoZWNrIHRvIGVuc3VyZSBlbnZpcm9ubWVudCB2YXJpYWJsZXMgYXJlIHNldFxuaWYgKCFzdXBhYmFzZVVybCkge1xuICB0aHJvdyBuZXcgRXJyb3IoXCJTdXBhYmFzZSBVUkwgbm90IGZvdW5kLiBNYWtlIHN1cmUgTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIGlzIHNldCBpbiB5b3VyIC5lbnYgZmlsZS5cIik7XG59XG5pZiAoIXN1cGFiYXNlQW5vbktleSkge1xuICB0aHJvdyBuZXcgRXJyb3IoXCJTdXBhYmFzZSBBbm9uIEtleSBub3QgZm91bmQuIE1ha2Ugc3VyZSBORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSBpcyBzZXQgaW4geW91ciAuZW52IGZpbGUuXCIpO1xufVxuXG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgU3VwYWJhc2UgY2xpZW50IGluc3RhbmNlIHdpdGggYW5vbnltb3VzIGtleSAoZm9yIGNsaWVudC1zaWRlKVxuZXhwb3J0IGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZUFub25LZXkpO1xuXG4vLyBDcmVhdGUgYSBTdXBhYmFzZSBjbGllbnQgd2l0aCBzZXJ2aWNlIHJvbGUga2V5IGZvciBzZXJ2ZXItc2lkZSBvcGVyYXRpb25zIHRoYXQgbmVlZCBlbGV2YXRlZCBwcml2aWxlZ2VzXG5leHBvcnQgY29uc3Qgc3VwYWJhc2VBZG1pbiA9IHN1cGFiYXNlU2VydmljZUtleSBcbiAgPyBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlU2VydmljZUtleSlcbiAgOiBzdXBhYmFzZTtcblxuLy8gQ29uZmlndXJhdGlvbiBwb3VyIERyaXp6bGUgT1JNIGF2ZWMgUG9zdGdyZVNRTFxubGV0IGRiOiBSZXR1cm5UeXBlPHR5cGVvZiBzZXR1cERyaXp6bGU+O1xuXG4vLyBGb25jdGlvbiBwb3VyIGNvbmZpZ3VyZXIgRHJpenpsZVxuZnVuY3Rpb24gc2V0dXBEcml6emxlKCkge1xuICBjb25zdCBkYXRhYmFzZVVybCA9IHByb2Nlc3MuZW52LkRBVEFCQVNFX1VSTDtcbiAgXG4gIGlmICghZGF0YWJhc2VVcmwpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiREFUQUJBU0VfVVJMIGlzIG5vdCBkZWZpbmVkIGluIGVudmlyb25tZW50IHZhcmlhYmxlc1wiKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJEQVRBQkFTRV9VUkwgaXMgbm90IGRlZmluZWQgaW4gZW52aXJvbm1lbnQgdmFyaWFibGVzXCIpO1xuICB9XG4gIFxuICB0cnkge1xuICAgIC8vIENyw6llciB1biBjbGllbnQgUG9zdGdyZVNRTCBhdmVjIGRlcyBvcHRpb25zIGRlIGNvbm5leGlvbiByb2J1c3Rlc1xuICAgIGNvbnN0IGNsaWVudCA9IHBvc3RncmVzKGRhdGFiYXNlVXJsLCB7XG4gICAgICBtYXg6IDEwLCAvLyBub21icmUgbWF4aW11bSBkZSBjb25uZXhpb25zIGRhbnMgbGUgcG9vbFxuICAgICAgaWRsZV90aW1lb3V0OiAyMCwgLy8gdGVtcHMgZCdpbmFjdGl2aXTDqSBhdmFudCBkZSBmZXJtZXIgdW5lIGNvbm5leGlvbiAoZW4gc2Vjb25kZXMpXG4gICAgICBjb25uZWN0X3RpbWVvdXQ6IDMwLCAvLyB0ZW1wcyBtYXhpbXVtIHBvdXIgw6l0YWJsaXIgdW5lIGNvbm5leGlvbiAoZW4gc2Vjb25kZXMpXG4gICAgICBwcmVwYXJlOiBmYWxzZSwgLy8gZMOpc2FjdGl2ZXIgbGEgcHLDqXBhcmF0aW9uIGRlcyByZXF1w6p0ZXMgcG91ciBwbHVzIGRlIGNvbXBhdGliaWxpdMOpXG4gICAgfSk7XG4gICAgXG4gICAgLy8gQ3LDqWVyIHVuZSBpbnN0YW5jZSBEcml6emxlXG4gICAgcmV0dXJuIGRyaXp6bGUoY2xpZW50KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyZXVyIGxvcnMgZGUgbGEgY29uZmlndXJhdGlvbiBkZSBEcml6emxlOlwiLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuLy8gSW5pdGlhbGlzZXIgRHJpenpsZSBlbiBlbnZpcm9ubmVtZW50IHNlcnZldXIgdW5pcXVlbWVudFxuaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSB7XG4gIHRyeSB7XG4gICAgZGIgPSBzZXR1cERyaXp6bGUoKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyZXVyIGxvcnMgZGUgbCdpbml0aWFsaXNhdGlvbiBkZSBEcml6emxlOlwiLCBlcnJvcik7XG4gICAgLy8gRm91cm5pciB1bmUgaW5zdGFuY2UgZmFjdGljZSBwb3VyIMOpdml0ZXIgbGVzIGVycmV1cnMgY8O0dMOpIHNlcnZldXJcbiAgICBkYiA9IHt9IGFzIFJldHVyblR5cGU8dHlwZW9mIHNldHVwRHJpenpsZT47XG4gIH1cbn0gZWxzZSB7XG4gIC8vIEZvdXJuaXIgdW5lIGluc3RhbmNlIGZhY3RpY2UgcG91ciBsZSBjw7R0w6kgY2xpZW50XG4gIGRiID0ge30gYXMgUmV0dXJuVHlwZTx0eXBlb2Ygc2V0dXBEcml6emxlPjtcbn1cblxuZXhwb3J0IHsgZGIgfTtcbiJdLCJuYW1lcyI6WyJjcmVhdGVDbGllbnQiLCJkcml6emxlIiwicG9zdGdyZXMiLCJzdXBhYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJzdXBhYmFzZUFub25LZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsInN1cGFiYXNlU2VydmljZUtleSIsIlNVUEFCQVNFX1NFUlZJQ0VfS0VZIiwiRXJyb3IiLCJzdXBhYmFzZSIsInN1cGFiYXNlQWRtaW4iLCJkYiIsInNldHVwRHJpenpsZSIsImRhdGFiYXNlVXJsIiwiREFUQUJBU0VfVVJMIiwiY29uc29sZSIsImVycm9yIiwiY2xpZW50IiwibWF4IiwiaWRsZV90aW1lb3V0IiwiY29ubmVjdF90aW1lb3V0IiwicHJlcGFyZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/db.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/@supabase","vendor-chunks/tr46","vendor-chunks/whatwg-url","vendor-chunks/webidl-conversions","vendor-chunks/next","vendor-chunks/next-auth","vendor-chunks/jose","vendor-chunks/openid-client","vendor-chunks/@babel","vendor-chunks/oauth","vendor-chunks/preact","vendor-chunks/uuid","vendor-chunks/yallist","vendor-chunks/preact-render-to-string","vendor-chunks/cookie","vendor-chunks/oidc-token-hash","vendor-chunks/@panva","vendor-chunks/drizzle-orm","vendor-chunks/postgres","vendor-chunks/@google"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Ftickets%2Fai-subticket%2Froute&page=%2Fapi%2Ftickets%2Fai-subticket%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftickets%2Fai-subticket%2Froute.ts&appDir=%2FUsers%2Fcharles-henrynoah%2FDesktop%2Fvizion%2FVizion%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fcharles-henrynoah%2FDesktop%2Fvizion%2FVizion&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();