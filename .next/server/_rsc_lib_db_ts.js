"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_rsc_lib_db_ts";
exports.ids = ["_rsc_lib_db_ts"];
exports.modules = {

/***/ "(rsc)/./lib/db.ts":
/*!*******************!*\
  !*** ./lib/db.ts ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   db: () => (/* binding */ db),\n/* harmony export */   supabase: () => (/* binding */ supabase),\n/* harmony export */   supabaseAdmin: () => (/* binding */ supabaseAdmin)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n/* harmony import */ var drizzle_orm_postgres_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! drizzle-orm/postgres-js */ \"(rsc)/./node_modules/drizzle-orm/postgres-js/driver.js\");\n/* harmony import */ var postgres__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! postgres */ \"(rsc)/./node_modules/postgres/src/index.js\");\n\n\n\n// Read Supabase credentials from environment variables\nconst supabaseUrl = \"https://ffwfdogonvgzudzsdcri.supabase.co\";\nconst supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZmd2Zkb2dvbnZnenVkenNkY3JpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMzMTg1MDQsImV4cCI6MjA1ODg5NDUwNH0.dfUnoBwD56sgNINPI-tLAuaMJ7PuGPuQanAJ_YrwOGI\";\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_KEY;\n// Basic check to ensure environment variables are set\nif (!supabaseUrl) {\n    throw new Error(\"Supabase URL not found. Make sure NEXT_PUBLIC_SUPABASE_URL is set in your .env file.\");\n}\nif (!supabaseAnonKey) {\n    throw new Error(\"Supabase Anon Key not found. Make sure NEXT_PUBLIC_SUPABASE_ANON_KEY is set in your .env file.\");\n}\n// Create and export the Supabase client instance with anonymous key (for client-side)\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__.createClient)(supabaseUrl, supabaseAnonKey);\n// Create a Supabase client with service role key for server-side operations that need elevated privileges\nconst supabaseAdmin = supabaseServiceKey ? (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__.createClient)(supabaseUrl, supabaseServiceKey) : supabase;\n// Configuration pour Drizzle ORM avec PostgreSQL\nlet db;\n// Fonction pour configurer Drizzle\nfunction setupDrizzle() {\n    const databaseUrl = process.env.DATABASE_URL;\n    if (!databaseUrl) {\n        console.error(\"DATABASE_URL is not defined in environment variables\");\n        throw new Error(\"DATABASE_URL is not defined in environment variables\");\n    }\n    try {\n        // Créer un client PostgreSQL avec des options de connexion robustes\n        const client = (0,postgres__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(databaseUrl, {\n            max: 10,\n            idle_timeout: 20,\n            connect_timeout: 30,\n            prepare: false\n        });\n        // Créer une instance Drizzle\n        return (0,drizzle_orm_postgres_js__WEBPACK_IMPORTED_MODULE_2__.drizzle)(client);\n    } catch (error) {\n        console.error(\"Erreur lors de la configuration de Drizzle:\", error);\n        throw error;\n    }\n}\n// Initialiser Drizzle en environnement serveur uniquement\nif (true) {\n    try {\n        db = setupDrizzle();\n    } catch (error) {\n        console.error(\"Erreur lors de l'initialisation de Drizzle:\", error);\n        // Fournir une instance factice pour éviter les erreurs côté serveur\n        db = {};\n    }\n} else {}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQXFEO0FBQ0g7QUFDbEI7QUFFaEMsdURBQXVEO0FBQ3ZELE1BQU1HLGNBQWNDLDBDQUFvQztBQUN4RCxNQUFNRyxrQkFBa0JILGtOQUF5QztBQUNqRSxNQUFNSyxxQkFBcUJMLFFBQVFDLEdBQUcsQ0FBQ0ssb0JBQW9CO0FBRTNELHNEQUFzRDtBQUN0RCxJQUFJLENBQUNQLGFBQWE7SUFDaEIsTUFBTSxJQUFJUSxNQUFNO0FBQ2xCO0FBQ0EsSUFBSSxDQUFDSixpQkFBaUI7SUFDcEIsTUFBTSxJQUFJSSxNQUFNO0FBQ2xCO0FBRUEsc0ZBQXNGO0FBQy9FLE1BQU1DLFdBQVdaLG1FQUFZQSxDQUFDRyxhQUFhSSxpQkFBaUI7QUFFbkUsMEdBQTBHO0FBQ25HLE1BQU1NLGdCQUFnQkoscUJBQ3pCVCxtRUFBWUEsQ0FBQ0csYUFBYU0sc0JBQzFCRyxTQUFTO0FBRWIsaURBQWlEO0FBQ2pELElBQUlFO0FBRUosbUNBQW1DO0FBQ25DLFNBQVNDO0lBQ1AsTUFBTUMsY0FBY1osUUFBUUMsR0FBRyxDQUFDWSxZQUFZO0lBRTVDLElBQUksQ0FBQ0QsYUFBYTtRQUNoQkUsUUFBUUMsS0FBSyxDQUFDO1FBQ2QsTUFBTSxJQUFJUixNQUFNO0lBQ2xCO0lBRUEsSUFBSTtRQUNGLG9FQUFvRTtRQUNwRSxNQUFNUyxTQUFTbEIsb0RBQVFBLENBQUNjLGFBQWE7WUFDbkNLLEtBQUs7WUFDTEMsY0FBYztZQUNkQyxpQkFBaUI7WUFDakJDLFNBQVM7UUFDWDtRQUVBLDZCQUE2QjtRQUM3QixPQUFPdkIsZ0VBQU9BLENBQUNtQjtJQUNqQixFQUFFLE9BQU9ELE9BQU87UUFDZEQsUUFBUUMsS0FBSyxDQUFDLCtDQUErQ0E7UUFDN0QsTUFBTUE7SUFDUjtBQUNGO0FBRUEsMERBQTBEO0FBQzFELElBQUksSUFBNkIsRUFBRTtJQUNqQyxJQUFJO1FBQ0ZMLEtBQUtDO0lBQ1AsRUFBRSxPQUFPSSxPQUFPO1FBQ2RELFFBQVFDLEtBQUssQ0FBQywrQ0FBK0NBO1FBQzdELG9FQUFvRTtRQUNwRUwsS0FBSyxDQUFDO0lBQ1I7QUFDRixPQUFPLEVBR047QUFFYSIsInNvdXJjZXMiOlsiL1VzZXJzL2NoYXJsZXMtaGVucnlub2FoL0Rlc2t0b3Avdml6aW9uL1Zpemlvbi9saWIvZGIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJztcbmltcG9ydCB7IGRyaXp6bGUgfSBmcm9tICdkcml6emxlLW9ybS9wb3N0Z3Jlcy1qcyc7XG5pbXBvcnQgcG9zdGdyZXMgZnJvbSAncG9zdGdyZXMnO1xuXG4vLyBSZWFkIFN1cGFiYXNlIGNyZWRlbnRpYWxzIGZyb20gZW52aXJvbm1lbnQgdmFyaWFibGVzXG5jb25zdCBzdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTDtcbmNvbnN0IHN1cGFiYXNlQW5vbktleSA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZO1xuY29uc3Qgc3VwYWJhc2VTZXJ2aWNlS2V5ID0gcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9LRVk7XG5cbi8vIEJhc2ljIGNoZWNrIHRvIGVuc3VyZSBlbnZpcm9ubWVudCB2YXJpYWJsZXMgYXJlIHNldFxuaWYgKCFzdXBhYmFzZVVybCkge1xuICB0aHJvdyBuZXcgRXJyb3IoXCJTdXBhYmFzZSBVUkwgbm90IGZvdW5kLiBNYWtlIHN1cmUgTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIGlzIHNldCBpbiB5b3VyIC5lbnYgZmlsZS5cIik7XG59XG5pZiAoIXN1cGFiYXNlQW5vbktleSkge1xuICB0aHJvdyBuZXcgRXJyb3IoXCJTdXBhYmFzZSBBbm9uIEtleSBub3QgZm91bmQuIE1ha2Ugc3VyZSBORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSBpcyBzZXQgaW4geW91ciAuZW52IGZpbGUuXCIpO1xufVxuXG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgU3VwYWJhc2UgY2xpZW50IGluc3RhbmNlIHdpdGggYW5vbnltb3VzIGtleSAoZm9yIGNsaWVudC1zaWRlKVxuZXhwb3J0IGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZUFub25LZXkpO1xuXG4vLyBDcmVhdGUgYSBTdXBhYmFzZSBjbGllbnQgd2l0aCBzZXJ2aWNlIHJvbGUga2V5IGZvciBzZXJ2ZXItc2lkZSBvcGVyYXRpb25zIHRoYXQgbmVlZCBlbGV2YXRlZCBwcml2aWxlZ2VzXG5leHBvcnQgY29uc3Qgc3VwYWJhc2VBZG1pbiA9IHN1cGFiYXNlU2VydmljZUtleSBcbiAgPyBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlU2VydmljZUtleSlcbiAgOiBzdXBhYmFzZTtcblxuLy8gQ29uZmlndXJhdGlvbiBwb3VyIERyaXp6bGUgT1JNIGF2ZWMgUG9zdGdyZVNRTFxubGV0IGRiOiBSZXR1cm5UeXBlPHR5cGVvZiBzZXR1cERyaXp6bGU+O1xuXG4vLyBGb25jdGlvbiBwb3VyIGNvbmZpZ3VyZXIgRHJpenpsZVxuZnVuY3Rpb24gc2V0dXBEcml6emxlKCkge1xuICBjb25zdCBkYXRhYmFzZVVybCA9IHByb2Nlc3MuZW52LkRBVEFCQVNFX1VSTDtcbiAgXG4gIGlmICghZGF0YWJhc2VVcmwpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiREFUQUJBU0VfVVJMIGlzIG5vdCBkZWZpbmVkIGluIGVudmlyb25tZW50IHZhcmlhYmxlc1wiKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJEQVRBQkFTRV9VUkwgaXMgbm90IGRlZmluZWQgaW4gZW52aXJvbm1lbnQgdmFyaWFibGVzXCIpO1xuICB9XG4gIFxuICB0cnkge1xuICAgIC8vIENyw6llciB1biBjbGllbnQgUG9zdGdyZVNRTCBhdmVjIGRlcyBvcHRpb25zIGRlIGNvbm5leGlvbiByb2J1c3Rlc1xuICAgIGNvbnN0IGNsaWVudCA9IHBvc3RncmVzKGRhdGFiYXNlVXJsLCB7XG4gICAgICBtYXg6IDEwLCAvLyBub21icmUgbWF4aW11bSBkZSBjb25uZXhpb25zIGRhbnMgbGUgcG9vbFxuICAgICAgaWRsZV90aW1lb3V0OiAyMCwgLy8gdGVtcHMgZCdpbmFjdGl2aXTDqSBhdmFudCBkZSBmZXJtZXIgdW5lIGNvbm5leGlvbiAoZW4gc2Vjb25kZXMpXG4gICAgICBjb25uZWN0X3RpbWVvdXQ6IDMwLCAvLyB0ZW1wcyBtYXhpbXVtIHBvdXIgw6l0YWJsaXIgdW5lIGNvbm5leGlvbiAoZW4gc2Vjb25kZXMpXG4gICAgICBwcmVwYXJlOiBmYWxzZSwgLy8gZMOpc2FjdGl2ZXIgbGEgcHLDqXBhcmF0aW9uIGRlcyByZXF1w6p0ZXMgcG91ciBwbHVzIGRlIGNvbXBhdGliaWxpdMOpXG4gICAgfSk7XG4gICAgXG4gICAgLy8gQ3LDqWVyIHVuZSBpbnN0YW5jZSBEcml6emxlXG4gICAgcmV0dXJuIGRyaXp6bGUoY2xpZW50KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyZXVyIGxvcnMgZGUgbGEgY29uZmlndXJhdGlvbiBkZSBEcml6emxlOlwiLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuLy8gSW5pdGlhbGlzZXIgRHJpenpsZSBlbiBlbnZpcm9ubmVtZW50IHNlcnZldXIgdW5pcXVlbWVudFxuaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSB7XG4gIHRyeSB7XG4gICAgZGIgPSBzZXR1cERyaXp6bGUoKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyZXVyIGxvcnMgZGUgbCdpbml0aWFsaXNhdGlvbiBkZSBEcml6emxlOlwiLCBlcnJvcik7XG4gICAgLy8gRm91cm5pciB1bmUgaW5zdGFuY2UgZmFjdGljZSBwb3VyIMOpdml0ZXIgbGVzIGVycmV1cnMgY8O0dMOpIHNlcnZldXJcbiAgICBkYiA9IHt9IGFzIFJldHVyblR5cGU8dHlwZW9mIHNldHVwRHJpenpsZT47XG4gIH1cbn0gZWxzZSB7XG4gIC8vIEZvdXJuaXIgdW5lIGluc3RhbmNlIGZhY3RpY2UgcG91ciBsZSBjw7R0w6kgY2xpZW50XG4gIGRiID0ge30gYXMgUmV0dXJuVHlwZTx0eXBlb2Ygc2V0dXBEcml6emxlPjtcbn1cblxuZXhwb3J0IHsgZGIgfTtcbiJdLCJuYW1lcyI6WyJjcmVhdGVDbGllbnQiLCJkcml6emxlIiwicG9zdGdyZXMiLCJzdXBhYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJzdXBhYmFzZUFub25LZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsInN1cGFiYXNlU2VydmljZUtleSIsIlNVUEFCQVNFX1NFUlZJQ0VfS0VZIiwiRXJyb3IiLCJzdXBhYmFzZSIsInN1cGFiYXNlQWRtaW4iLCJkYiIsInNldHVwRHJpenpsZSIsImRhdGFiYXNlVXJsIiwiREFUQUJBU0VfVVJMIiwiY29uc29sZSIsImVycm9yIiwiY2xpZW50IiwibWF4IiwiaWRsZV90aW1lb3V0IiwiY29ubmVjdF90aW1lb3V0IiwicHJlcGFyZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/db.ts\n");

/***/ })

};
;